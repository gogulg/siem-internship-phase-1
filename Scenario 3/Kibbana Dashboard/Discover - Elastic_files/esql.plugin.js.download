(()=>{var e,t,r={294:(e,t,r)=>{"use strict";r.d(t,{h:()=>u}),r(286);var n=r(319),s=r(777),a=r(409),i=r(723),o=r(791);const u=e=>{var t;const{loading:u,value:l}=(0,s.A)((()=>{const e=(0,i.f0)(),t=r.e(667).then(r.bind(r,831));return Promise.all([e,t])}),[]),c=null==l||null===(t=l[1])||void 0===t?void 0:t.default,d=null==l?void 0:l[0];return!u&&d&&c?(0,o.jsx)(a.KibanaContextProvider,{services:{...d}},(0,o.jsx)(c,e)):(0,o.jsx)(n.EuiLoadingSpinner,null)}},181:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ESQLLangEditor:()=>g.h,EsqlControlType:()=>h.z,plugin:()=>f});var n=r(915),s=r(215),a=r(8);const i="UPDATE_ESQL_QUERY_TRIGGER",o={id:i,title:a.i18n.translate("esql.triggers.updateEsqlQueryTrigger",{defaultMessage:"Update ES|QL query"}),description:a.i18n.translate("esql.triggers.updateEsqlQueryTriggerDescription",{defaultMessage:"Update ES|QL query with a new one"})},u="ACTION_UPDATE_ESQL_QUERY",l=async()=>await r.e(303).then(r.bind(r,303));class UpdateESQLQueryAction{constructor(e){(0,n.default)(this,"type",u),(0,n.default)(this,"id",u),(0,n.default)(this,"order",50),this.data=e}getDisplayName(){return a.i18n.translate("esql.updateESQLQueryLabel",{defaultMessage:"Update the ES|QL query in the editor"})}getIconType(){return"filter"}async isCompatible(){const{isActionCompatible:e}=await l();return e(this.data)}async execute({queryString:e}){const{executeAction:t}=await l();return t({queryString:e,data:this.data})}}const c="ESQL_CONTROL_TRIGGER",d={id:c,title:a.i18n.translate("esql.triggers.esqlControlTigger",{defaultMessage:"Create an ES|QL control"}),description:a.i18n.translate("esql.triggers.esqlControlTiggerDescription",{defaultMessage:"Create an ES|QL control to interact with the charts"})},p="ACTION_CREATE_ESQL_CONTROL",_=async()=>await r.e(355).then(r.bind(r,355));class CreateESQLControlAction{constructor(e,t){(0,n.default)(this,"type",p),(0,n.default)(this,"id",p),(0,n.default)(this,"order",50),this.core=e,this.search=t}getDisplayName(){return a.i18n.translate("esql.createESQLControlLabel",{defaultMessage:"Creates an ES|QL control"})}getIconType(){return"pencil"}async isCompatible({queryString:e}){const{isActionCompatible:t}=await _();return t(e)}async execute({queryString:e,variableType:t,esqlVariables:r,onSaveControl:n,onCancelControl:s,cursorPosition:a,initialState:i}){const{executeAction:o}=await _();return o({queryString:e,core:this.core,search:this.search,variableType:t,esqlVariables:r,onSaveControl:n,onCancelControl:s,cursorPosition:a,initialState:i})}}var b=r(723);class EsqlVariablesService{constructor(){(0,n.default)(this,"esqlVariables",[]),(0,n.default)(this,"areSuggestionsEnabled",!1)}enableSuggestions(){this.areSuggestionsEnabled=!0}disableSuggestions(){this.areSuggestionsEnabled=!1}addVariable(e){const t=[...this.esqlVariables];t.find((t=>t.key===e.key))||(t.push({...e,value:Number.isNaN(Number(e.value))?e.value:Number(e.value)}),this.esqlVariables=t)}clearVariables(){this.esqlVariables=[]}}class EsqlPlugin{constructor(){(0,n.default)(this,"indexManagement",void 0)}setup(e,{indexManagement:t,uiActions:r}){return this.indexManagement=t,r.registerTrigger(o),r.registerTrigger(d),{}}start(e,{dataViews:t,expressions:r,data:n,uiActions:a,fieldsMetadata:o,usageCollection:u}){const l=new s.Storage(localStorage),d=new UpdateESQLQueryAction(n);a.addTriggerAction(i,d);const p=new CreateESQLControlAction(e,n.search.search);a.addTriggerAction(c,p);const _=new EsqlVariablesService,g={getJoinIndicesAutocomplete:((e,t=3e5,r=15e3,n=Date.now)=>{let s,a=0;return()=>{const i=n();return i-a>t&&(s=void 0),s?(i-a>r&&(a=i,Promise.resolve().then((()=>{s=e()}))),s):(a=i,s=e(),s)}})((async()=>await e.http.get("/internal/esql/autocomplete/join/indices")),3e5,15e3),variablesService:_};return(0,b.bE)(g,e,t,n,r,l,a,this.indexManagement,o,u),g}stop(){}}var g=r(294),h=r(248);function f(){return new EsqlPlugin}},723:(e,t,r)=>{"use strict";let n;r.d(t,{bE:()=>i,f0:()=>a});const s=new(r(190).BehaviorSubject)(void 0),a=()=>s.value?Promise.resolve(s.value):new Promise((e=>{const t=s.subscribe((r=>{r&&(t.unsubscribe(),e(r))}))})),i=(e,t,r,a,i,o,u,l,c,d)=>{n=t,s.next({core:n,dataViews:r,expressions:i,data:a,storage:o,uiActions:u,indexManagementApiService:null==l?void 0:l.apiService,fieldsMetadata:c,usageCollection:d,esql:e})}},248:(e,t,r)=>{"use strict";r.d(t,{z:()=>n});let n=function(e){return e.STATIC_VALUES="STATIC_VALUES",e.VALUES_FROM_QUERY="VALUES_FROM_QUERY",e}({})},777:(e,t,r)=>{"use strict";var n=r(941),s=r(286),a=n.__importDefault(r(53));t.A=function(e,t){void 0===t&&(t=[]);var r=a.default(e,t,{loading:!0}),n=r[0],i=r[1];return s.useEffect((function(){i()}),[i]),n}},53:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(941),s=r(286),a=n.__importDefault(r(812));t.default=function(e,t,r){void 0===t&&(t=[]),void 0===r&&(r={loading:!1});var i=s.useRef(0),o=a.default(),u=s.useState(r),l=u[0],c=u[1],d=s.useCallback((function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var s=++i.current;return c((function(e){return n.__assign(n.__assign({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return o()&&s===i.current&&c({value:e,loading:!1}),e}),(function(e){return o()&&s===i.current&&c({error:e,loading:!1}),e}))}),t);return[l,d]}},812:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(286);t.default=function(){var e=n.useRef(!1),t=n.useCallback((function(){return e.current}),[]);return n.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},121:(e,t,r)=>{r.p=window.__kbnPublicPath__.esql},195:(e,t,r)=>{r.r(t);var n=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},409:(e,t,r)=>{r.r(t);var n=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},215:(e,t,r)=>{r.r(t);var n=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},839:(e,t,r)=>{r.r(t);var n=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},915:(e,t,r)=>{e.exports=r(497)(67493)},927:e=>{"use strict";e.exports=__kbnSharedDeps__.Classnames},319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},424:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnCodeEditor},494:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnDatemath},964:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnEsQuery},991:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnEsqlAst},8:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},879:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18nReact},911:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnMonaco},482:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnReactKibanaContextRender},770:e=>{"use strict";e.exports=__kbnSharedDeps__.Lodash},783:e=>{"use strict";e.exports=__kbnSharedDeps__.Moment},488:e=>{"use strict";e.exports=__kbnSharedDeps__.MomentTimezone},286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},874:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactDom},530:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactQuery},190:e=>{"use strict";e.exports=__kbnSharedDeps__.Rxjs},941:e=>{"use strict";e.exports=__kbnSharedDeps__.TsLib},472:e=>{"use strict";e.exports=__kbnSharedDeps__.Uuid},497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},n={};function s(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={exports:{}};return r[e](a,a.exports,s),a.exports}s.m=r,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,r)=>(s.f[r](e,t),t)),[])),s.u=e=>"esql.chunk."+e+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="@kbn/esql:",s.l=(r,n,a,i)=>{if(e[r])e[r].push(n);else{var o,u;if(void 0!==a)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+a){o=d;break}}o||(u=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.setAttribute("data-webpack",t+a),o.src=r),e[r]=[n];var p=(t,n)=>{o.onerror=o.onload=null,clearTimeout(_);var s=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),s&&s.forEach((e=>e(n))),t)return t(n)},_=setTimeout(p.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=p.bind(null,o.onerror),o.onload=p.bind(null,o.onload),u&&document.head.appendChild(o)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=r[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={316:0};s.f.j=(t,r)=>{var n=s.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var a=new Promise(((r,s)=>n=e[t]=[r,s]));r.push(n[2]=a);var i=s.p+s.u(t),o=new Error;s.l(i,(r=>{if(s.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var a=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+i+")",o.name="ChunkLoadError",o.type=a,o.request=i,n[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,a,[i,o,u]=r,l=0;if(i.some((t=>0!==e[t]))){for(n in o)s.o(o,n)&&(s.m[n]=o[n]);u&&u(s)}for(t&&t(r);l<i.length;l++)a=i[l],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.esql_bundle_jsonpfunction=self.esql_bundle_jsonpfunction||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),s(121),__kbnBundles__.define("plugin/esql/public",s,181)})();