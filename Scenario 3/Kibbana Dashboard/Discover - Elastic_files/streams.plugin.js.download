/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e={910:(e,r,t)=>{"use strict";t.r(r),t.d(r,{plugin:()=>m});var n=t(915);const o=["delete","get","patch","post","put"];const s=__kbnSharedDeps__.Rxjs;var i=Object.defineProperty,a=(e,r,t)=>((e,r,t)=>r in e?i(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t)(e,"symbol"!=typeof r?r+"":r,t);class ParseError extends Error{constructor(e,r){super(e),a(this,"type"),a(this,"field"),a(this,"value"),a(this,"line"),this.name="ParseError",this.type=r.type,this.field=r.field,this.value=r.value,this.line=r.line}}function l(e){}const c=__kbnSharedDeps__.KbnI18n;let u=function(e){return e.error="error",e.data="data",e}({}),d=function(e){return e.internalError="internalError",e.requestError="requestError",e}({});class ServerSentEventError extends Error{constructor(e,r,t){super(r),this.code=e,this.meta=t}toJSON(){return{type:u.error,error:{code:this.code,message:this.message,meta:this.meta}}}}function p(e=c.i18n.translate("sse.internalError",{defaultMessage:"An internal error occurred"})){return new ServerSentEventError(d.internalError,e,{})}function h(){return(0,s.switchMap)((e=>function(e){const r=e.response,t=null==r?void 0:r.body;return t?new s.Observable((e=>{const r=function(e){const{onEvent:r=l,onError:t=l,onRetry:n=l,onComment:o}=e;let s,i="",a=!0,c="",u="";function d(e){if(""===e)return c.length>0&&r({id:s,event:u||void 0,data:c.endsWith("\n")?c.slice(0,-1):c}),s=void 0,c="",void(u="");if(e.startsWith(":"))return void(o&&o(e.slice(e.startsWith(": ")?2:1)));const t=e.indexOf(":");if(-1===t)p(e,"",e);else{const r=e.slice(0,t),n=" "===e[t+1]?2:1;p(r,e.slice(t+n),e)}}function p(e,r,o){switch(e){case"event":u=r;break;case"data":c=`${c}${r}\n`;break;case"id":s=r.includes("\0")?void 0:r;break;case"retry":/^\d+$/.test(r)?n(parseInt(r,10)):t(new ParseError(`Invalid \`retry\` value: "${r}"`,{type:"invalid-retry",value:r,line:o}));break;default:t(new ParseError(`Unknown field "${e.length>20?`${e.slice(0,20)}â€¦`:e}"`,{type:"unknown-field",field:e,value:r,line:o}))}}return{feed:function(e){const r=a?e.replace(/^\xEF\xBB\xBF/,""):e,[t,n]=function(e){const r=[];let t="";const n=e.length;for(let o=0;o<n;o++){const n=e[o];"\r"===n&&"\n"===e[o+1]?(r.push(t),t="",o++):"\r"===n||"\n"===n?(r.push(t),t=""):t+=n}return[r,t]}(`${i}${r}`);for(const e of t)d(e);i=n,a=!1},reset:function(e={}){i&&e.consume&&d(i),s=void 0,c="",u="",i=""}}}({onEvent:r=>{try{const t=JSON.parse(r.data);if("error"===r.event){const r=t;e.error(new ServerSentEventError(r.error.code,r.error.message,r.error.meta))}else e.next({type:r.event||"event",...t})}catch(r){e.error(p("Failed to parse JSON"))}}});(async()=>{const e=t.getReader(),n=new TextDecoder,o=({done:t,value:s})=>t?Promise.resolve():(r.feed(n.decode(s,{stream:!0})),e.read().then(o));return e.read().then(o)})().then((()=>{e.complete()})).catch((r=>{e.error(r)}))})):(0,s.throwError)((()=>{throw p("No readable stream found in response")}))}(e)))}const v=__kbnSharedDeps__.Lodash;class Plugin{constructor(e){(0,n.default)(this,"config",void 0),(0,n.default)(this,"logger",void 0),(0,n.default)(this,"repositoryClient",void 0),this.config=e.config.get(),this.logger=e.logger.get()}setup(e,r){return this.repositoryClient=function(e){const r=(r,t,n)=>{const{method:s,pathname:i,version:a}=function(e,r={}){var t,n,s;const{method:i,pathname:a,version:l}=function(e){var r;const t=e.split(" "),n=t[0].trim().toLowerCase(),s=t[1].trim(),i=null===(r=t[2])||void 0===r?void 0:r.trim();if(!o.includes(n))throw new Error(`Endpoint ${e} was not prefixed with a valid HTTP method`);return{method:n,pathname:s,version:i}}(e),c=/(\/\{\w+\?\})/g,u=/(\/{)((.+?))(\})/g;if(0===(null===(t=Object.keys(r))||void 0===t?void 0:t.length))return{method:i,pathname:a.replace(u,""),version:l};const d=Object.keys(r).reduce(((e,t)=>e.replace(`{${t}}`,encodeURIComponent(r[t])).replace(`{${t}?}`,encodeURIComponent(r[t]))),a);if((null===(n=null!==(s=d.match(c))&&void 0!==s?s:[])||void 0===n?void 0:n.length)>0)throw new Error(`Missing parameters: ${d.match(c)}`);return{method:i,pathname:d,version:l}}(r,null==t?void 0:t.path);return e.http[s](i,{...n,body:t&&t.body?JSON.stringify(t.body):void 0,query:null==t?void 0:t.query,version:a})};return{fetch:(e,...t)=>{var n;const o=null!==(n=t[0])&&void 0!==n?n:{},s="params"in o?o.params:{},i=(0,v.omit)(o,"params");return r(e,s,i)},stream:(e,...t)=>{var n;const o=null!==(n=t[0])&&void 0!==n?n:{},i="params"in o?o.params:{},a=(0,v.omit)(o,"params");return(0,s.from)(r(e,i,{...a,asResponse:!0,rawResponse:!0})).pipe(h())}}}(e),{status$:f(this.logger,this.repositoryClient)}}start(e,r){return{streamsRepositoryClient:this.repositoryClient,status$:f(this.logger,this.repositoryClient)}}stop(){}}const f=(0,v.once)(((e,r)=>(0,s.from)(r.fetch("GET /api/streams/_status",{signal:(new AbortController).signal}).then((e=>({status:e.enabled?"enabled":"disabled"})),(r=>(e.error(r),{status:"unknown"})))).pipe((0,s.startWith)({status:"unknown"}),(0,s.shareReplay)(1)))),m=e=>new Plugin(e)},194:(e,r,t)=>{t.p=window.__kbnPublicPath__.streams},915:(e,r,t)=>{e.exports=t(497)(67493)},497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},r={};function t(n){var o=r[n];if(void 0!==o)return o.exports;var s=r[n]={exports:{}};return e[n](s,s.exports,t),s.exports}t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var r=t.g.document;if(!e&&r&&(r.currentScript&&"SCRIPT"===r.currentScript.tagName.toUpperCase()&&(e=r.currentScript.src),!e)){var n=r.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})(),t(194),__kbnBundles__.define("plugin/streams/public",t,910)})();