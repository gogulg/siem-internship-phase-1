/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e,t,r={636:(e,t,r)=>{"use strict";r.r(t),r.d(t,{plugin:()=>_});var o=r(915),i=r(627),n=r(215),a=r(546);const s=__kbnSharedDeps__.KbnI18n;var l=r(449);__kbnSharedDeps__.Rxjs,__kbnSharedDeps__.React;const c=e=>Boolean(e&&void 0!==(null==e?void 0:e.parentApi)),u=e=>Boolean(e&&void 0!==(null==e?void 0:e.viewMode$));r(964),r(513);const p=e=>Boolean((e=>Boolean(e&&void 0!==(null==e?void 0:e.timeRange$)))(e)||(e=>Boolean(e&&void 0!==(null==e?void 0:e.filters$)))(e)||void 0!==(null==e?void 0:e.query$)),d=(e,t)=>Boolean(e&&e.type)&&e.type===t,f=e=>Boolean(e&&void 0!==(null==e?void 0:e.dataViews$)),g=e=>{var t;return f(e)?(null!==(t=e.dataViews$.getValue())&&void 0!==t?t:[]).reduce(((e,t)=>t.id?[...e,t.id]:e),[]):[]},v=e=>(e=>(e=>u(e)||c(e)&&u(e.parentApi))(e)&&(e=>Boolean(e&&e.type))(e)&&f(e))(e)&&(e=>u(e)?e.viewMode$.getValue():c(e)&&u(e.parentApi)?e.parentApi.viewMode$.getValue():void 0)(e)===a.ViewMode.VIEW&&!d(e,l.DOC_TYPE);class AbstractExploreDataAction{constructor(e){(0,o.default)(this,"getIconType",(()=>"discoverApp")),(0,o.default)(this,"getDisplayName",(()=>s.i18n.translate("xpack.discover.FlyoutCreateDrilldownAction.displayName",{defaultMessage:"Explore underlying data"}))),this.params=e}async getLocation({embeddable:e},t){var r,o,i,n,a,s;const{plugins:l}=this.params.start(),{locator:u}=l.discover;if(!u)throw new Error("Discover URL locator not available.");const d={};var f,v,b,h;c(e)&&p(e.parentApi)&&(d.filters=null!==(f=null===(v=e.parentApi.filters$)||void 0===v?void 0:v.getValue())&&void 0!==f?f:[],d.query=null===(b=e.parentApi.query$)||void 0===b?void 0:b.getValue(),d.timeRange=null===(h=e.parentApi.timeRange$)||void 0===h?void 0:h.getValue());const _={};var y,m,O,w;p(e)&&(_.filters=null!==(y=null===(m=e.filters$)||void 0===m?void 0:m.getValue())&&void 0!==y?y:[],_.query=null===(O=e.query$)||void 0===O?void 0:O.getValue(),_.timeRange=null===(w=e.timeRange$)||void 0===w?void 0:w.getValue());const A={dataViewId:g(e)[0],filters:[...null!==(r=d.filters)&&void 0!==r?r:[],...null!==(o=_.filters)&&void 0!==o?o:[],...null!==(i=null==t?void 0:t.filters)&&void 0!==i?i:[]],query:null!==(n=d.query)&&void 0!==n?n:_.query,timeRange:null!==(a=null!==(s=null==t?void 0:t.timeRange)&&void 0!==s?s:_.timeRange)&&void 0!==a?a:d.timeRange};return await u.getLocation(A)}async isCompatible({embeddable:e}){if(!v(e))return!1;const{core:t,plugins:r}=this.params.start(),{capabilities:o}=t.application;return!(o.discover_v2&&!o.discover_v2.show)&&!!r.discover.locator&&(e=>1===g(e).length)(e)}async execute(e){const{embeddable:t}=e;if(!this.isCompatible({embeddable:t}))return;const{core:r}=this.params.start(),{app:o,path:i}=await this.getLocation(e);await r.application.navigateToApp(o,{path:i})}async getHref(e){const{embeddable:t}=e;if(!this.isCompatible({embeddable:t}))throw new Error(`Embeddable not supported for "${this.getDisplayName()}" action.`);const{core:r}=this.params.start(),{app:o,path:i}=await this.getLocation(e);return r.application.getUrlForApp(o,{path:i,absolute:!1})}}const b="ACTION_EXPLORE_DATA";class ExploreDataContextMenuAction extends AbstractExploreDataAction{constructor(...e){super(...e),(0,o.default)(this,"id",b),(0,o.default)(this,"type",b),(0,o.default)(this,"order",200)}}const h="ACTION_EXPLORE_DATA_CHART";class ExploreDataChartAction extends AbstractExploreDataAction{constructor(...e){super(...e),(0,o.default)(this,"id",h),(0,o.default)(this,"type",h),(0,o.default)(this,"order",200),(0,o.default)(this,"getLocation",(async e=>{var t;const{extractTimeRange:o}=await Promise.resolve().then(r.t.bind(r,964,23)),{restOfFilters:i,timeRange:n}=o(null!==(t=e.filters)&&void 0!==t?t:[],e.timeFieldName);return super.getLocation(e,{filters:i,timeRange:n})}))}async isCompatible(e){const{embeddable:t}=e;return!d(t,"map")&&p(t)&&super.isCompatible(e)}}class DiscoverEnhancedPlugin{constructor(e){(0,o.default)(this,"config",void 0),this.context=e,this.config=e.config.get()}setup(e,{uiActions:t,share:r}){const o=(0,n.createStartServicesGetter)(e.getStartServices);if(r){const e={start:o};if(this.config.actions.exploreDataInContextMenu.enabled){const r=new ExploreDataContextMenuAction(e);t.addTriggerAction(a.CONTEXT_MENU_TRIGGER,r)}if(this.config.actions.exploreDataInChart.enabled){const r=new ExploreDataChartAction(e);t.addTriggerAction(i.APPLY_FILTER_TRIGGER,r)}}}start(e,t){}stop(){}}const _=e=>new DiscoverEnhancedPlugin(e)},513:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var o,i,n;if(Array.isArray(t)){if((o=t.length)!=r.length)return!1;for(i=o;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((o=(n=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=o;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,n[i]))return!1;for(i=o;0!=i--;){var a=n[i];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r}},742:(e,t,r)=>{r.p=window.__kbnPublicPath__.discoverEnhanced},627:(e,t,r)=>{r.r(t);var o=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(o))},546:(e,t,r)=>{r.r(t);var o=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(o))},215:(e,t,r)=>{r.r(t);var o=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(o))},449:(e,t,r)=>{r.r(t);var o=__kbnBundles__.get("plugin/lens/common/constants");Object.defineProperties(t,Object.getOwnPropertyDescriptors(o))},915:(e,t,r)=>{e.exports=r(497)(67493)},964:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnEsQuery},497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return r[e](n,n.exports,i),n.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"==typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"==typeof r.then)return r}var n=Object.create(null);i.r(n);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>r[e]));return a.default=()=>r,i.d(n,a),n},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),i(742),__kbnBundles__.define("plugin/discoverEnhanced/public",i,636)})();