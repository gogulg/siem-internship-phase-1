(()=>{var e={28:(e,t,i)=>{"use strict";i.r(t),i.d(t,{plugin:()=>V});const n=__kbnSharedDeps__.ReactDom;var s=i.n(n),a=i(286),o=i.n(a);const r=__kbnSharedDeps__.KbnReactKibanaContextRender,u="/internal/guided_onboarding";var d=i(880);const l=__kbnSharedDeps__.ElasticEui,c=__kbnSharedDeps__.KbnI18n;var p=i(915);const g=__kbnSharedDeps__.Rxjs,f=e=>{const t=e.steps.find((e=>"in_progress"===e.status));return t?t.id:void 0},h=(e,t)=>{if(!e||"in_progress"!==e.status||!e.activeGuide)return!1;if(t){const{activeGuide:i}=e;return!(!i.isActive||i.guideId!==t)}return!0},m=(e,t,i,n)=>{if(!e||!e.isActive||e.guideId!==i)return!1;const s=e.steps.find((e=>e.id===n));return!!s&&s.status===t},x=(e,t,i)=>m(e,"in_progress",t,i),b=(e,t,i)=>m(e,"ready_to_complete",t,i);class ConfigService{constructor(){(0,p.default)(this,"client",void 0),(0,p.default)(this,"configs",void 0),(0,p.default)(this,"isConfigInitialized",void 0)}setup(e){this.client=e,this.configs={},this.isConfigInitialized={}}async getGuideConfig(e){if(!this.client)throw new Error("ConfigService has not be initialized.");if(!this.isConfigInitialized||!this.isConfigInitialized[e])try{const{config:t}=await this.client.get(`${u}/configs/${e}`);this.isConfigInitialized||(this.isConfigInitialized={}),this.isConfigInitialized[e]=!0,this.configs||(this.configs={}),this.configs[e]=t}catch(t){this.isConfigInitialized||(this.isConfigInitialized={}),this.isConfigInitialized[e]=!0}return((e,t)=>{if(e&&t&&Object.keys(e).includes(t))return e[t]})(this.configs,e)}async getGuideStatusOnStepCompletion({isLastStepInGuide:e,isManualCompletion:t,isStepReadyToComplete:i}){return e&&!t||e&&t&&i?"ready_to_complete":"in_progress"}async isIntegrationInGuideStep(e,t){if(!e||!e.isActive)return!1;const i=((e,t)=>{const i=f(t);if(i&&e)return e.steps.find((e=>e.id===i))})(await this.getGuideConfig(e.guideId),e);return!!i&&i.integration===t}}const v=new class ApiService{constructor(){(0,p.default)(this,"_isEnabled",!1),(0,p.default)(this,"client",void 0),(0,p.default)(this,"pluginState$",void 0),(0,p.default)(this,"isLoading$",new g.BehaviorSubject(!1)),(0,p.default)(this,"isGuidePanelOpen$",new g.BehaviorSubject(!1)),(0,p.default)(this,"configService",new ConfigService)}setup(e,t){this._isEnabled=t,this.client=e,this.pluginState$=new g.BehaviorSubject(void 0),this.isGuidePanelOpen$=new g.BehaviorSubject(!1),this.isLoading$=new g.BehaviorSubject(!1),this.configService.setup(e)}createGetPluginStateObservable(){return new g.Observable((e=>{const t=new AbortController,i=t.signal;return this.isLoading$.next(!0),this.client.get(`${u}/state`,{signal:i}).then((({pluginState:t})=>{this.isLoading$.next(!1),e.next(t),this.pluginState$.next(t),e.complete()})).catch((t=>{this.isLoading$.next(!1),e.next({status:"error",isActivePeriod:!1}),this.pluginState$.next({status:"error",isActivePeriod:!1}),e.complete()})),()=>{this.isLoading$.next(!1),t.abort()}}))}fetchPluginState$(){if(!this._isEnabled)return(0,g.of)(void 0);if(!this.client)throw new Error("ApiService has not be initialized.");return this.pluginState$.value||this.isLoading$.value?this.pluginState$:(this.isLoading$.next(!0),(0,g.concat)(this.createGetPluginStateObservable(),this.pluginState$))}async fetchAllGuidesState(){if(this._isEnabled){if(!this.client)throw new Error("ApiService has not be initialized.");try{return await this.client.get(`${u}/guides`)}catch(e){throw e}}}async updatePluginState(e,t){if(this._isEnabled){if(!this.client)throw new Error("ApiService has not be initialized.");try{this.isLoading$.next(!0);const i=await this.client.put(`${u}/state`,{body:JSON.stringify(e)});return this.isLoading$.next(!1),this.pluginState$.next(i.pluginState),this.isGuidePanelOpen$.next(t),i}catch(e){throw this.isLoading$.next(!1),e}}}async activateGuide(e,t){if(t)return await this.updatePluginState({status:"in_progress",guide:{...t,isActive:!0}},!0);const i=await this.configService.getGuideConfig(e);if(i){const t={guideId:e,isActive:!0,status:"not_started",steps:i.steps.map(((e,t)=>{const i=0===t;return{id:e.id,status:i?"active":"inactive"}}))};return await this.updatePluginState({status:"in_progress",guide:t},!0)}}async deactivateGuide(e){return await this.updatePluginState({status:"quit",guide:{...e,isActive:!1}},!1)}async completeGuide(e){const t=await(0,g.firstValueFrom)(this.fetchPluginState$());if(!h(t,e))return;const{activeGuide:i}=t;if(Boolean(i.steps.find((e=>"complete"===e.status)))){const e={...i,isActive:!1,status:"complete"};return await this.updatePluginState({status:"complete",guide:e},!1)}}isGuideStepActive$(e,t){return this.fetchPluginState$().pipe((0,g.map)((i=>!!h(i,e)&&x(i.activeGuide,e,t))))}isGuideStepReadyToComplete$(e,t){return this.fetchPluginState$().pipe((0,g.map)((i=>!!h(i,e)&&b(i.activeGuide,e,t))))}async startGuideStep(e,t){const i=await(0,g.firstValueFrom)(this.fetchPluginState$());if(!h(i,e))return;const{activeGuide:n}=i,s={guideId:e,isActive:!0,status:"in_progress",steps:n.steps.map((e=>e.id===t?{id:e.id,status:"in_progress"}:e))};return await this.updatePluginState({guide:s},!1)}async completeGuideStep(e,t,i){const n=await(0,g.firstValueFrom)(this.fetchPluginState$());if(!h(n,e))return;const{activeGuide:s}=n,a=x(s,e,t),o=b(s,e,t),r=await this.configService.getGuideConfig(e),u=((e,t,i)=>null==e?void 0:e.steps.find((e=>e.id===i)))(r,s.guideId,t),d=!!u&&!!u.manualCompletion,l=((e,t,i)=>{const n=((e,t,i)=>e?e.steps.findIndex((e=>e.id===i)):-1)(e,0,i),s=(null==e?void 0:e.steps.length)||0;return s>0&&n===s-1})(r,0,t);if(a||o){const n=((e,t,i)=>{const n=e.steps.findIndex((e=>e.id===t)),s=e.steps[n];return e.steps.map(((e,t)=>{const a=e.id===s.id,o=t===n+1;return a?{id:e.id,status:i?"ready_to_complete":"complete"}:o?i?e:{id:e.id,status:"active"}:e}))})(s,t,d&&a),r={guideId:e,isActive:!0,status:await this.configService.getGuideStatusOnStepCompletion({isLastStepInGuide:l,isManualCompletion:d,isStepReadyToComplete:o}),steps:n,params:i};return await this.updatePluginState({guide:r},!d||o)}}isGuidedOnboardingActiveForIntegration$(e){return this.fetchPluginState$().pipe((0,g.concatMap)((t=>(0,g.from)(this.configService.isIntegrationInGuideStep(null==t?void 0:t.activeGuide,e)))))}async completeGuidedOnboardingForIntegration(e){if(!e)return;const t=await(0,g.firstValueFrom)(this.fetchPluginState$());if(!h(t))return;const{activeGuide:i}=t,n=f(i);return n&&await this.configService.isIntegrationInGuideStep(i,e)?await this.completeGuideStep(i.guideId,n):void 0}async skipGuidedOnboarding(){return await this.updatePluginState({status:"skipped"},!1)}async getGuideConfig(e){if(!this._isEnabled)return;if(!this.client)throw new Error("ApiService has not be initialized.");this.isLoading$.next(!0);const t=await this.configService.getGuideConfig(e);return this.isLoading$.next(!1),t}get isEnabled(){return this._isEnabled}},y=__kbnSharedDeps__.EmotionReact,S=({closeModal:e,currentGuide:t,telemetryGuideId:i,notifications:n})=>{const[s,o]=(0,a.useState)(!1);return(0,y.jsx)(l.EuiModal,{"aria-label":"quitGuideModal","data-test-subj":"onboarding--quitGuideModal",maxWidth:448,onClose:e},(0,y.jsx)(l.EuiModalHeader,null,(0,y.jsx)(l.EuiModalHeaderTitle,null,c.i18n.translate("guidedOnboarding.quitGuideModal.modalTitle",{defaultMessage:"Quit this guide?"}))),(0,y.jsx)(l.EuiModalBody,null,(0,y.jsx)(l.EuiText,null,(0,y.jsx)("p",null,c.i18n.translate("guidedOnboarding.quitGuideModal.modalDescription",{defaultMessage:"You can restart the setup guide any time from the Help menu."})))),(0,y.jsx)(l.EuiModalFooter,null,(0,y.jsx)(l.EuiButtonEmpty,{"data-test-subj":`onboarding--cancelQuitGuideButton--${i}`,onClick:e},c.i18n.translate("guidedOnboarding.quitGuideModal.cancelButtonLabel",{defaultMessage:"Cancel"})),(0,y.jsx)(l.EuiButton,{"data-test-subj":`onboarding--quitGuideButton--${i}`,onClick:async()=>{try{o(!0),await v.deactivateGuide(t),e()}catch(e){o(!1),n.toasts.addDanger({title:c.i18n.translate("guidedOnboarding.quitGuideModal.deactivateGuideError",{defaultMessage:"Unable to update the guide. Wait a moment and try again."}),text:e.message})}},isLoading:s,fill:!0,color:"primary"},c.i18n.translate("guidedOnboarding.quitGuideModal.quitButtonLabel",{defaultMessage:"Quit guide"}))))},j=i.p+"c5f1b9fcca4c3cb8.svg",E=i.p+"26b403c36de687e2.svg",G=i.p+"81fb78ec54b9777b.svg",w=i.p+"8ca43ce08de0da20.svg";var C={name:"3ifei",styles:">li{list-style-type:none;}margin-inline-start:0!important"},_={name:"fwdmq1",styles:"height:600px"},k={name:"eep2zz",styles:"display:flex;block-size:100%;justify-content:space-between;flex-direction:column"},P={name:"1aot8k0",styles:"flex-grow:0;padding:8px 0 0"},O={name:"3vaow",styles:"flex-grow:0;padding:16px 16px 0"},T={name:"1flj9lk",styles:"text-align:left"},I={name:"18ji2p4",styles:"width:300px"};const B=({button:e,isGuidePanelOpen:t,title:i,description:n})=>{const s=(0,a.useRef)(!0);(0,a.useEffect)((()=>{s.current=!1}),[]);const[o,r]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{t&&!s.current&&r(!1)}),[t]),(0,y.jsx)(l.EuiPopover,{"data-test-subj":"manualCompletionPopover",button:e,isOpen:o,repositionOnScroll:!0,closePopover:()=>{}},i&&(0,y.jsx)(l.EuiTitle,{size:"xxs"},(0,y.jsx)("h3",null,i)),(0,y.jsx)(l.EuiSpacer,null),(0,y.jsx)(l.EuiText,{size:"s",css:I},n&&(0,y.jsx)("p",null,n)))},L=({pluginState:e,guideConfig:t,toggleGuidePanel:i,isGuidePanelOpen:n,navigateToLandingPage:s,isLoading:a})=>{var o;const r=(e=>{let t;return null==e||e.steps.forEach(((e,i)=>{"in_progress"!==e.status&&"ready_to_complete"!==e.status||(t=i+1),"active"===e.status&&(t=i)})),t})(null==e?void 0:e.activeGuide),u=null==e||null===(o=e.activeGuide)||void 0===o?void 0:o.steps.find((e=>"ready_to_complete"===e.status)),d=(0,y.jsx)(l.EuiButton,{isLoading:a,onClick:i,color:"accent",fill:!0,size:"s","data-test-subj":"guideButton"},Boolean(r)?c.i18n.translate("guidedOnboarding.guidedSetupStepButtonLabel",{defaultMessage:"Setup guide: step {stepNumber}",values:{stepNumber:r}}):c.i18n.translate("guidedOnboarding.guidedSetupButtonLabel",{defaultMessage:"Setup guide"}));if(!e||!e.activeGuide||!e.activeGuide.isActive||"not_started"===e.activeGuide.status)return null==e||!e.isActivePeriod||"not_started"!==(null==e?void 0:e.status)&&"skipped"!==(null==e?void 0:e.status)&&"in_progress"!==e.status?"error"===(null==e?void 0:e.status)?d:null:(0,y.jsx)(l.EuiButton,{onClick:s,color:"accent",fill:!0,size:"s","data-test-subj":"guideButtonRedirect"},c.i18n.translate("guidedOnboarding.guidedSetupRedirectButtonLabel",{defaultMessage:"Setup guides"}));if(u){const e=null==t?void 0:t.steps.find((e=>e.id===u.id));if(e&&e.manualCompletion)return(0,y.jsx)(B,{button:d,isGuidePanelOpen:n,title:e.manualCompletion.title,description:e.manualCompletion.description})}return d},$=({styles:e,titleId:t,toggleGuide:i,hasError:n,isGuideReadyToComplete:s,guideConfig:a,backButton:o})=>{const r=(0,y.jsx)(l.EuiButtonIcon,{iconType:"cross","aria-label":c.i18n.translate("guidedOnboarding.dropdownPanel.closeButton.ariaLabel",{defaultMessage:"Close modal"}),onClick:i,onKeyDown:e=>{e.key===l.keys.ESCAPE&&(e.preventDefault(),e.stopPropagation(),i())},color:"text",css:e.flyoutOverrides.flyoutCloseButtonIcon});return n?(0,y.jsx)("div",{css:e.flyoutOverrides.flyoutHeaderError},o,r):(0,y.jsx)("div",{css:e.flyoutOverrides.flyoutHeader},(0,y.jsx)(l.EuiSpacer,{size:"s"}),o,(0,y.jsx)(l.EuiSpacer,{size:"s"}),(0,y.jsx)(l.EuiTitle,{size:"m"},(0,y.jsx)("h2",{id:t,"data-test-subj":"guideTitle"},s?c.i18n.translate("guidedOnboarding.dropdownPanel.completeGuideFlyoutTitle",{defaultMessage:"Well done!"}):a?a.title:"")),r,(0,y.jsx)(l.EuiHorizontalRule,null))},M=i.p+"eddb0986a740fc28.gif";var z={name:"1se9e8c",styles:"p{margin-left:32px;margin-block-end:0;}ul{padding-left:28px;}"};const F=e=>{if("string"==typeof e)return e;const{descriptionText:t,linkText:i,linkUrl:n,isLinkExternal:s}=e;return(0,y.jsx)(o().Fragment,null,t,(0,y.jsx)("br",null),(0,y.jsx)(l.EuiLink,{"data-test-subj":"guidePanelStepDescriptionLink",href:n,target:s?"_blank":""},i))},D=({accordionId:e,stepStatus:t,stepNumber:i,stepConfig:n,handleButtonClick:s,telemetryGuideId:a,isLoading:r})=>{const{euiTheme:u}=(0,l.useEuiTheme)(),d=((e,t)=>({stepNumber:(0,y.css)("width:24px;height:24px;border-radius:50%;border:2px solid ","inactive"===t?e.colors.borderBasePlain:e.colors.success,";font-weight:",e.font.weight.medium,";text-align:center;line-height:1.4;color:","inactive"===t?e.colors.textSubdued:e.colors.textParagraph,";",""),stepTitle:(0,y.css)("font-weight:",e.font.weight.semiBold,";color:","inactive"===t?e.colors.textSubdued:e.colors.textParagraph,";.euiAccordion-isOpen &{color:",e.colors.textHeading,";}",""),description:z}))(u,t),p=(0,y.jsx)(l.EuiFlexGroup,{gutterSize:"s",responsive:!1},(0,y.jsx)(l.EuiFlexItem,{grow:!1},"complete"===t?(0,y.jsx)(l.EuiIcon,{type:"checkInCircleFilled",size:"l",color:u.colors.success}):(0,y.jsx)("span",{css:d.stepNumber},i)),(0,y.jsx)(l.EuiFlexItem,{grow:!1},(0,y.jsx)(l.EuiText,{size:"m",css:d.stepTitle},n.title))),g="in_progress"===t||"active"===t||"ready_to_complete"===t;return(0,y.jsx)("div",{"data-test-subj":"guidePanelStep"},"complete"===t?(0,y.jsx)(o().Fragment,null,p):(0,y.jsx)(l.EuiAccordion,{id:e,buttonContent:p,arrowDisplay:"right",initialIsOpen:g},(0,y.jsx)(o().Fragment,null,(0,y.jsx)(l.EuiSpacer,{size:"s"}),(0,y.jsx)(l.EuiText,{size:"s","data-test-subj":"guidePanelStepDescription",css:d.description},n.description&&(0,y.jsx)("p",null,F(n.description)),n.descriptionList&&(0,y.jsx)("ul",null,n.descriptionList.map(((e,t)=>(0,y.jsx)("li",{key:`description-${t}`},F(e)))))),(0,y.jsx)(l.EuiSpacer,null),g&&(0,y.jsx)(l.EuiFlexGroup,{justifyContent:"flexEnd"},(0,y.jsx)(l.EuiFlexItem,{grow:!1},(0,y.jsx)(l.EuiButton,{isLoading:r,onClick:s,fill:!0,"data-test-subj":`onboarding--stepButton--${a}--step${i}`},(()=>{switch(t){case"active":return c.i18n.translate("guidedOnboarding.dropdownPanel.startStepButtonLabel",{defaultMessage:"Start"});case"in_progress":return c.i18n.translate("guidedOnboarding.dropdownPanel.continueStepButtonLabel",{defaultMessage:"Continue"});case"ready_to_complete":return c.i18n.translate("guidedOnboarding.dropdownPanel.markDoneStepButtonLabel",{defaultMessage:"Mark done"})}return""})()))))),(0,y.jsx)(l.EuiHorizontalRule,{margin:"l"}))},A=({guideConfig:e,styles:t,pluginState:i,isLoading:n,stepsCompleted:s,isGuideReadyToComplete:a,handleStepButtonClick:r})=>{const{flyoutStepsWrapper:u}=t.flyoutOverrides;return(0,y.jsx)(o().Fragment,null,s>0&&(0,y.jsx)(o().Fragment,null,(0,y.jsx)(l.EuiSpacer,{size:"xl"}),(0,y.jsx)(l.EuiProgress,{"data-test-subj":"guideProgress",label:a?c.i18n.translate("guidedOnboarding.dropdownPanel.completedLabel",{defaultMessage:"Completed"}):c.i18n.translate("guidedOnboarding.dropdownPanel.progressLabel",{defaultMessage:"Progress"}),value:s,valueText:c.i18n.translate("guidedOnboarding.dropdownPanel.progressValueLabel",{defaultMessage:"{stepCount} steps",values:{stepCount:`${s} / ${e.steps.length}`}}),max:e.steps.length,size:"l"}),(0,y.jsx)(l.EuiSpacer,{size:"s"})),(0,y.jsx)(l.EuiHorizontalRule,null),(0,y.jsx)("ol",{css:u},null==e?void 0:e.steps.map(((t,s)=>{var a;const o=(0,l.htmlIdGenerator)(`accordion${s}`)(),u=null==i||null===(a=i.activeGuide)||void 0===a?void 0:a.steps[s];if(u)return(0,y.jsx)("li",{key:o},(0,y.jsx)(D,{isLoading:n,accordionId:o,stepStatus:u.status,stepConfig:t,stepNumber:s+1,handleButtonClick:()=>r(u,t),telemetryGuideId:e.telemetryId}))}))))},R=i.p+"bcf349dc043296a9.gif",N=({styles:e,guideConfig:t,isDarkTheme:i,stepsCompleted:n,isGuideReadyToComplete:s,pluginState:a,handleStepButtonClick:r,isLoading:u,completeGuide:d})=>{const p=()=>t&&t.docs?(0,y.jsx)(o().Fragment,null,(0,y.jsx)(l.EuiSpacer,{size:"m"}),(0,y.jsx)(l.EuiText,{size:"m"},(0,y.jsx)(l.EuiLink,{external:!0,target:"_blank",href:t.docs.url},t.docs.text))):null;return!t||!a||a&&"error"===a.status?(0,y.jsx)(l.EuiEmptyPrompt,{"data-test-subj":"guideErrorSection",iconType:"alert",color:"danger",title:(0,y.jsx)("h2",null,c.i18n.translate("guidedOnboarding.dropdownPanel.errorSectionTitle",{defaultMessage:"Unable to load the guide"})),body:(0,y.jsx)(o().Fragment,null,(0,y.jsx)(l.EuiText,{color:"subdued"},c.i18n.translate("guidedOnboarding.dropdownPanel.errorSectionDescription",{defaultMessage:"Wait a moment and try again. If the problem persists, contact your administrator."})),(0,y.jsx)(l.EuiSpacer,null),(0,y.jsx)(l.EuiButton,{iconSide:"right",onClick:()=>window.location.reload(),iconType:"refresh",color:"danger"},c.i18n.translate("guidedOnboarding.dropdownPanel.errorSectionReloadButton",{defaultMessage:"Reload"})))}):s?(0,y.jsx)(o().Fragment,null,(0,y.jsx)(l.EuiImage,{size:"l",src:i?M:R,alt:c.i18n.translate("guidedOnboarding.dropdownPanel.wellDoneAnimatedGif",{defaultMessage:"Guide completed animated gif"})}),(0,y.jsx)(l.EuiSpacer,null),(0,y.jsx)(l.EuiText,{size:"m"},(0,y.jsx)("p",{"data-test-subj":"guideDescription"},c.i18n.translate("guidedOnboarding.dropdownPanel.completeGuideFlyoutDescription",{defaultMessage:"You've completed the Elastic {guideName} guide. Feel free to come back to the Guides for more onboarding help or a refresher.",values:{guideName:t.guideName}}))),p(),(0,y.jsx)(l.EuiSpacer,null),(0,y.jsx)(l.EuiFlexGroup,{justifyContent:"flexStart"},(0,y.jsx)(l.EuiFlexItem,{grow:!1},(0,y.jsx)(l.EuiButton,{isLoading:u,onClick:()=>d(t.completedGuideRedirectLocation),fill:!0,"data-test-subj":`onboarding--completeGuideButton--${t.telemetryId}`},c.i18n.translate("guidedOnboarding.dropdownPanel.elasticButtonLabel",{defaultMessage:"Continue using Elastic"})))),(0,y.jsx)(l.EuiSpacer,null)):(0,y.jsx)(o().Fragment,null,(0,y.jsx)("div",null,(0,y.jsx)(l.EuiText,{size:"m"},(0,y.jsx)("p",{"data-test-subj":"guideDescription"},t.description)),p(),(0,y.jsx)(A,{guideConfig:t,styles:e,pluginState:a,isLoading:u,handleStepButtonClick:r,isGuideReadyToComplete:s,stepsCompleted:n})))},q=({styles:e,euiTheme:t,openQuitGuideModal:i})=>(0,y.jsx)("div",{css:e.flyoutOverrides.flyoutFooter},(0,y.jsx)(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"xs",responsive:!1,wrap:!0},(0,y.jsx)(l.EuiFlexItem,{grow:!1},(0,y.jsx)(l.EuiButtonEmpty,{iconType:"questionInCircle",iconSide:"right",href:"https://cloud.elastic.co/support ",target:"_blank",css:e.flyoutOverrides.flyoutFooterLink,iconSize:"m"},c.i18n.translate("guidedOnboarding.dropdownPanel.footer.support",{defaultMessage:"Need help?"}))),(0,y.jsx)(l.EuiFlexItem,{grow:!1},(0,y.jsx)(l.EuiText,{size:"xs",color:t.colors.disabled},"|")),(0,y.jsx)(l.EuiFlexItem,{grow:!1},(0,y.jsx)(l.EuiButtonEmpty,{iconType:"faceHappy",iconSide:"right",href:"https://www.elastic.co/kibana/feedback",target:"_blank",css:e.flyoutOverrides.flyoutFooterLink,iconSize:"s"},c.i18n.translate("guidedOnboarding.dropdownPanel.footer.feedback",{defaultMessage:"Give feedback"}))),(0,y.jsx)(l.EuiFlexItem,{grow:!1},(0,y.jsx)(l.EuiText,{size:"xs",color:t.colors.disabled},"|")),(0,y.jsx)(l.EuiFlexItem,{grow:!1},(0,y.jsx)(l.EuiButtonEmpty,{iconType:"exit",iconSide:"right",onClick:i,"data-test-subj":"quitGuideButton",css:e.flyoutOverrides.flyoutFooterLink,iconSize:"s"},c.i18n.translate("guidedOnboarding.dropdownPanel.footer.exitGuideButtonLabel",{defaultMessage:"Quit guide"}))))),H=({isOpen:e,isDarkTheme:t,toggleGuide:i,isGuideReadyToComplete:n,guideConfig:s,styles:a,navigateToLandingPage:o,stepsCompleted:r,pluginState:u,handleStepButtonClick:d,isLoading:p,euiTheme:g,openQuitGuideModal:f,completeGuide:h})=>{if(!e)return null;const m="onboarding-guide",x=(0,y.jsx)(l.EuiButtonEmpty,{onClick:o,iconSide:"left",iconType:"arrowLeft",flush:"left",color:"text"},c.i18n.translate("guidedOnboarding.dropdownPanel.backToGuidesLink",{defaultMessage:"Back to guides"})),b=!s||!u||u&&"error"===u.status,{flyoutContentWrapper:v,flyoutBody:S,flyoutBodyWrapper:j,flyoutContainerError:E,flyoutContainer:G}=a.flyoutOverrides;return(0,y.jsx)(l.EuiPortal,null,(0,y.jsx)(l.EuiOverlayMask,null,(0,y.jsx)(l.EuiFocusTrap,{onClickOutside:i},(0,y.jsx)(l.EuiPanel,{"data-test-subj":"guidePanel","aria-labelledby":m,role:"dialog",css:b?E:G},(0,y.jsx)("div",{css:v},(0,y.jsx)($,{styles:a,titleId:m,toggleGuide:i,guideConfig:s,isGuideReadyToComplete:n,backButton:x,hasError:b}),(0,y.jsx)("div",{css:j},(0,y.jsx)("div",{css:S},(0,y.jsx)(N,{styles:a,guideConfig:s,pluginState:u,handleStepButtonClick:d,isLoading:p,isDarkTheme:t,stepsCompleted:r,isGuideReadyToComplete:n,completeGuide:h}))),!b&&(0,y.jsx)(q,{styles:a,euiTheme:g,openQuitGuideModal:f}))))))},W=/\{(.*?)\}/g,Q=/[\{\}]/g,U=(e,t)=>{var i;if(null!==(i=t.activeGuide)&&void 0!==i&&i.params){let i=e;const s=e.match(W);if(s){for(const e of s){var n;const s=e.replace(Q,"");i=i.replace(`${e}`,null===(n=t.activeGuide)||void 0===n?void 0:n.params[s])}return i}}return e},K=({api:e,application:t,notifications:i,theme$:n})=>{var s;const r=(0,l.useEuiTheme)(),u=r.euiTheme,[p,g]=(0,a.useState)(!1),[f,h]=(0,a.useState)(!1),[m,x]=(0,a.useState)(void 0),[b,v]=(0,a.useState)(void 0),[I,B]=(0,a.useState)(!1),{darkMode:$}=(0,d.A)(n,{darkMode:!1,name:"amsterdam"}),M=(({euiThemeContext:e,isDarkTheme:t})=>{const i=e.euiTheme,n=(0,y.css)("position:fixed;height:100%;max-height:76vh;max-inline-size:480px;max-block-size:auto;inset-inline-end:0;inset-block-start:",i.size.xxxl,";",l.euiCanAnimate,"{animation:",l.euiFlyoutSlideInRight," ",i.animation.normal," ",i.animation.resistance,";}@media (max-width: ",i.breakpoint.m,"px){max-height:85vh;})@media (min-width: ",i.breakpoint.m,"px){right:calc(",i.size.s," + 128px);}","");return{setupButton:(0,y.css)("margin-right:",i.size.m,";",""),wellDoneAnimatedPrompt:T,flyoutOverrides:{flyoutContainer:(0,y.css)(n,";background:",i.colors.emptyShade," url(",t?E:j,") top right no-repeat;padding:0;",""),flyoutContainerError:(0,y.css)(n,";padding:24px;",""),flyoutHeader:O,flyoutHeaderError:P,flyoutContentWrapper:k,flyoutCloseButtonIcon:(0,y.css)("position:absolute;inset-block-start:",i.size.base,";inset-inline-end:",i.size.base,";",""),flyoutBodyWrapper:(0,y.css)((0,l.logicalCSS)("height","100%")," ",(0,l.logicalCSSWithFallback)("overflow-y","hidden")," flex-grow:1;",""),flyoutBody:(0,y.css)((0,l.euiYScroll)(e)," padding:16px 10px 0 16px;",""),flyoutBodyError:_,flyoutStepsWrapper:C,flyoutFooter:(0,y.css)("border-radius:0 0 6px 6px;background:url(",t?w:G,") 0 36px no-repeat;padding:24px 30px;height:125px;flex-grow:0;",""),flyoutFooterLink:(0,y.css)("color:",i.colors.darkShade,";font-weight:400;","")}}})({euiThemeContext:r,isDarkTheme:$}),z=()=>{g((e=>!e))},F=(0,a.useCallback)((async(n,s)=>{if(m){const{id:o,status:r}=n,u=m.activeGuide.guideId;try{if("ready_to_complete"===r)return await e.completeGuideStep(u,o);var a;"active"!==r&&"in_progress"!==r||(await e.startGuideStep(u,o),s.location&&(await t.navigateToApp(s.location.appID,{path:U(s.location.path,m)}),null!==(a=s.manualCompletion)&&void 0!==a&&a.readyToCompleteOnNavigation&&await e.completeGuideStep(u,o)))}catch(e){i.toasts.addDanger({title:c.i18n.translate("guidedOnboarding.dropdownPanel.stepHandlerError",{defaultMessage:"Unable to update the guide. Wait a moment and try again."}),text:e.message})}}}),[e,t,i.toasts,m]),D=()=>{g(!1),t.navigateToApp("home",{path:"#getting_started"})};(0,a.useEffect)((()=>{const t=e.fetchPluginState$().subscribe((e=>{x(e)}));return()=>t.unsubscribe()}),[e]),(0,a.useEffect)((()=>{const t=e.isLoading$.subscribe((e=>{B(e)}));return()=>t.unsubscribe()}),[e]),(0,a.useEffect)((()=>{const t=e.isGuidePanelOpen$.subscribe((e=>{g(e)}));return()=>t.unsubscribe()}),[e]);const A=(0,a.useCallback)((async()=>{var t;if(null!=m&&null!==(t=m.activeGuide)&&void 0!==t&&t.guideId){const t=await e.getGuideConfig(m.activeGuide.guideId);t&&v(t)}}),[e,m]);(0,a.useEffect)((()=>{A()}),[A]);const R=(N=null==m?void 0:m.activeGuide)?N.steps.reduce(((e,t)=>("complete"===t.status&&(e+=1),e)),0):0;var N;const q="ready_to_complete"===(null==m||null===(s=m.activeGuide)||void 0===s?void 0:s.status);return(0,y.jsx)(o().Fragment,null,(0,y.jsx)("div",{css:M.setupButton},(0,y.jsx)(L,{isLoading:I,pluginState:m,guideConfig:b,toggleGuidePanel:z,isGuidePanelOpen:p,navigateToLandingPage:D})),(0,y.jsx)(H,{isOpen:p,isLoading:I,styles:M,toggleGuide:z,isDarkTheme:$,stepsCompleted:R,isGuideReadyToComplete:q,guideConfig:b,navigateToLandingPage:D,pluginState:m,handleStepButtonClick:F,openQuitGuideModal:()=>{g(!1),h(!0)},euiTheme:u,completeGuide:async n=>{try{if(await e.completeGuide(m.activeGuide.guideId),n){const{appID:e,path:i}=n;t.navigateToApp(e,{path:i})}}catch(e){i.toasts.addDanger({title:c.i18n.translate("guidedOnboarding.dropdownPanel.completeGuideError",{defaultMessage:"Unable to update the guide. Wait a moment and try again."}),text:e.message})}}}),f&&(0,y.jsx)(S,{closeModal:()=>{h(!1)},currentGuide:m.activeGuide,telemetryGuideId:b.telemetryId,notifications:i}))};class GuidedOnboardingPlugin{constructor(){}setup(e,{cloud:t}){return{cloud:t}}start(e,{cloud:t}){const{chrome:i,http:n,application:s,notifications:a}=e,o=!(null==t||!t.isCloudEnabled||!s.capabilities.guidedOnboardingFeature.enabled);return v.setup(n,o),o&&i.navControls.registerExtension({order:1e3,mount:t=>this.mount({startServices:e,targetDomElement:t,api:v,application:s,notifications:a})}),{guidedOnboardingApi:v}}stop(){}mount({startServices:e,targetDomElement:t,api:i,application:n,notifications:a}){const{theme:o}=e;return s().render((0,y.jsx)(r.KibanaRenderContextProvider,e,(0,y.jsx)(K,{api:i,application:n,notifications:a,theme$:o.theme$})),t),()=>s().unmountComponentAtNode(t)}}function V(){return new GuidedOnboardingPlugin}},943:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(286),s="undefined"!=typeof window?n.useLayoutEffect:n.useEffect;t.default=s},880:(e,t,i)=>{"use strict";var n=i(941),s=i(286),a=n.__importDefault(i(943));t.A=function(e,t){var i=s.useState(t),n=i[0],o=i[1];return a.default((function(){var t=e.subscribe(o);return function(){return t.unsubscribe()}}),[e]),n}},277:(e,t,i)=>{i.p=window.__kbnPublicPath__.guidedOnboarding},915:(e,t,i)=>{e.exports=i(497)(67493)},286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},941:e=>{"use strict";e.exports=__kbnSharedDeps__.TsLib},497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},t={};function i(n){var s=t[n];if(void 0!==s)return s.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,i),a.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var s=n.length-1;s>-1&&(!e||!/^http(s?):/.test(e));)e=n[s--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),i(277),__kbnBundles__.define("plugin/guidedOnboarding/public",i,28)})();