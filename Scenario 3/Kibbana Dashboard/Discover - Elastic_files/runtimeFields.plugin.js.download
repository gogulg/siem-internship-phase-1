/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e={493:(e,t,i)=>{"use strict";i.d(t,{Y:()=>_,RuntimeFieldEditorFlyoutContent:()=>v});var a=i(286),l=i.n(a),s=i(8);const n=__kbnSharedDeps__.KbnI18nReact,r=__kbnSharedDeps__.KbnMonaco,o=__kbnSharedDeps__.ElasticEui;var u=i(289),d=i(23);const{emptyField:c}=u.c5,p={name:{label:s.i18n.translate("xpack.runtimeFields.form.nameLabel",{defaultMessage:"Name"}),validations:[{validator:c(s.i18n.translate("xpack.runtimeFields.form.validations.nameIsRequiredErrorMessage",{defaultMessage:"Give a name to the field."}))}]},type:{label:s.i18n.translate("xpack.runtimeFields.form.runtimeTypeLabel",{defaultMessage:"Type"}),defaultValue:"keyword",deserializer:e=>{var t;if(!e)return[];const i=null===(t=d.x.find((({value:t})=>t===e)))||void 0===t?void 0:t.label;return[{label:null!=i?i:e,value:e}]},serializer:e=>e[0].value},script:{source:{label:s.i18n.translate("xpack.runtimeFields.form.defineFieldLabel",{defaultMessage:"Define script (optional)"})}}};var m=i(172);const f=e=>({value:t})=>{if(e.includes(t))return{message:s.i18n.translate("xpack.runtimeFields.runtimeFieldsEditor.existRuntimeFieldNamesValidationErrorMessage",{defaultMessage:"There is already a field with this name."})}},b=e=>{switch(e){case"keyword":default:return"string_script_field_script_field";case"long":return"long_script_field_script_field";case"double":return"double_script_field_script_field";case"date":return"date_script_field";case"ip":return"ip_script_field_script_field";case"boolean":return"boolean_script_field_script_field"}},g=({defaultValue:e,onChange:t,links:i,ctx:{namesNotAllowed:c,existingConcreteFields:g=[]}={}})=>{const x=p.type,[_,v]=(0,a.useState)(b(x.defaultValue)),{form:h}=(0,u.mN)({defaultValue:e,schema:p}),{submit:F,isValid:y,isSubmitted:j}=h,[{name:k}]=(0,u.O1)({form:h,watch:"name"}),E=((e,t)=>{var i;const a=p.name;return e?{...a,validations:[...null!==(i=a.validations)&&void 0!==i?i:[],{validator:f(e.filter((e=>e!==(null==t?void 0:t.name))))}]}:a})(c,e),S=(0,a.useCallback)((e=>{v(b(e[0].value))}),[]),w=r.PainlessLang.getSuggestionProvider(_,g);return(0,a.useEffect)((()=>{t&&t({isValid:y,isSubmitted:j,submit:F})}),[t,y,j,F]),(0,m.jsx)(u.lV,{form:h,className:"runtimeFieldEditor_form"},(0,m.jsx)(o.EuiFlexGroup,null,(0,m.jsx)(o.EuiFlexItem,null,(0,m.jsx)(u.kT,{path:"name",config:E,component:u.A_,"data-test-subj":"nameField",componentProps:{euiFieldProps:{"aria-label":s.i18n.translate("xpack.runtimeFields.form.nameAriaLabel",{defaultMessage:"Name field"})}}})),(0,m.jsx)(o.EuiFlexItem,null,(0,m.jsx)(u.kT,{path:"type",onChange:S},(({label:e,value:t,setValue:i})=>void 0===t?null:(0,m.jsx)(l().Fragment,null,(0,m.jsx)(o.EuiFormRow,{label:e,fullWidth:!0},(0,m.jsx)(o.EuiComboBox,{placeholder:s.i18n.translate("xpack.runtimeFields.form.runtimeType.placeholderLabel",{defaultMessage:"Select a type"}),singleSelection:{asPlainText:!0},options:d.x,selectedOptions:t,onChange:e=>{0!==e.length&&i(e)},isClearable:!1,"data-test-subj":"typeField","aria-label":s.i18n.translate("xpack.runtimeFields.form.typeSelectAriaLabel",{defaultMessage:"Type select"}),fullWidth:!0}))))))),g.find((e=>e.name===k))&&(0,m.jsx)(l().Fragment,null,(0,m.jsx)(o.EuiSpacer,null),(0,m.jsx)(o.EuiCallOut,{title:s.i18n.translate("xpack.runtimeFields.form.fieldShadowingCalloutTitle",{defaultMessage:"Field shadowing"}),color:"warning",iconType:"pin",size:"s","data-test-subj":"shadowingFieldCallout"},(0,m.jsx)("div",null,s.i18n.translate("xpack.runtimeFields.form.fieldShadowingCalloutDescription",{defaultMessage:"This field shares the name of a mapped field. Values for this field will be returned in search results."})))),(0,m.jsx)(o.EuiSpacer,{size:"l"}),(0,m.jsx)(u.kT,{path:"script.source"},(({value:e,setValue:t,label:a,isValid:l,getErrorsMessages:d})=>(0,m.jsx)(o.EuiFormRow,{label:a,error:d(),isInvalid:!l,helpText:(0,m.jsx)(n.FormattedMessage,{id:"xpack.runtimeFields.form.source.scriptFieldHelpText",defaultMessage:"Runtime fields without a script retrieve values from a field with the same name in {source}. If a field with the same name doesnâ€™t exist, no values return when a search request includes the runtime field. {learnMoreLink}",values:{learnMoreLink:(0,m.jsx)(o.EuiLink,{href:i.runtimePainless,target:"_blank",external:!0,"data-test-subj":"painlessSyntaxLearnMoreLink"},s.i18n.translate("xpack.runtimeFields.form.script.learnMoreLinkText",{defaultMessage:"Learn about script syntax."})),source:(0,m.jsx)(o.EuiCode,null,"_source")}}),fullWidth:!0},(0,m.jsx)(u.BY,{languageId:r.PainlessLang.ID,suggestionProvider:w,width:"100%",height:"300px",value:e,onChange:t,options:{fontSize:12,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0,suggest:{snippetsPreventQuickSuggestions:!1}},"data-test-subj":"scriptField","aria-label":s.i18n.translate("xpack.runtimeFields.form.scriptEditorAriaLabel",{defaultMessage:"Script editor"})})))))},x=l().memo(g),_=({defaultValue:e,onChange:t,docLinks:i,ctx:a})=>{const l=(({links:e})=>({runtimePainless:`${e.runtimeFields.mapping}`,painlessSyntax:`${e.scriptedFields.painlessLangSpec}`}))(i);return(0,m.jsx)(x,{links:l,defaultValue:e,onChange:t,ctx:a})},v=({onSave:e,onCancel:t,docLinks:i,defaultValue:n,ctx:r})=>{const u=(e=>({flyoutTitle:e?s.i18n.translate("xpack.runtimeFields.editor.flyoutEditFieldTitle",{defaultMessage:"Edit {fieldName} field",values:{fieldName:e.name}}):s.i18n.translate("xpack.runtimeFields.editor.flyoutDefaultTitle",{defaultMessage:"Create new field"}),closeButtonLabel:s.i18n.translate("xpack.runtimeFields.editor.flyoutCloseButtonLabel",{defaultMessage:"Close"}),saveButtonLabel:s.i18n.translate("xpack.runtimeFields.editor.flyoutSaveButtonLabel",{defaultMessage:"Save"}),formErrorsCalloutTitle:s.i18n.translate("xpack.runtimeFields.editor.validationErrorTitle",{defaultMessage:"Fix errors in form before continuing."})}))(n),[d,c]=(0,a.useState)({isSubmitted:!1,isValid:!!n||void 0,submit:n?async()=>({isValid:!0,data:n}):async()=>({isValid:!1,data:{}})}),{submit:p,isValid:f,isSubmitted:b}=d,g=(0,a.useCallback)((async()=>{const{isValid:t,data:i}=await p();t&&e(i)}),[p,e]);return(0,m.jsx)(l().Fragment,null,(0,m.jsx)(o.EuiFlyoutHeader,null,(0,m.jsx)(o.EuiTitle,{size:"m","data-test-subj":"flyoutTitle"},(0,m.jsx)("h2",{id:"runtimeFieldEditorEditTitle"},u.flyoutTitle))),(0,m.jsx)(o.EuiFlyoutBody,null,(0,m.jsx)(_,{docLinks:i,defaultValue:n,onChange:c,ctx:r})),(0,m.jsx)(o.EuiFlyoutFooter,null,b&&!f&&(0,m.jsx)(l().Fragment,null,(0,m.jsx)(o.EuiCallOut,{title:u.formErrorsCalloutTitle,color:"danger",iconType:"cross","data-test-subj":"formError"}),(0,m.jsx)(o.EuiSpacer,{size:"m"})),(0,m.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},(0,m.jsx)(o.EuiFlexItem,{grow:!1},(0,m.jsx)(o.EuiButtonEmpty,{iconType:"cross",flush:"left",onClick:()=>t(),"data-test-subj":"closeFlyoutButton"},u.closeButtonLabel)),(0,m.jsx)(o.EuiFlexItem,{grow:!1},(0,m.jsx)(o.EuiButton,{color:"primary",onClick:()=>g(),"data-test-subj":"saveFieldButton",disabled:b&&!f,fill:!0},u.saveButtonLabel)))))}},23:(e,t,i)=>{"use strict";i.d(t,{x:()=>a});const a=[{label:"Keyword",value:"keyword"},{label:"Long",value:"long"},{label:"Double",value:"double"},{label:"Date",value:"date"},{label:"IP",value:"ip"},{label:"Boolean",value:"boolean"}]},930:(e,t,i)=>{"use strict";i.r(t),i.d(t,{RUNTIME_FIELD_OPTIONS:()=>n.x,RuntimeFieldEditor:()=>s.Y,RuntimeFieldEditorFlyoutContent:()=>s.RuntimeFieldEditorFlyoutContent,plugin:()=>r}),i(286);var a=i(289),l=i(172);class RuntimeFieldsPlugin{setup(e,t){return{loadEditor:(s=e,async()=>{const{RuntimeFieldEditorFlyoutContent:e}=await Promise.resolve().then(i.bind(i,493)),[t]=await s.getStartServices(),{uiSettings:n,theme:r,overlays:o,docLinks:u,settings:d}=t,{Provider:c}=(0,a.fI)({uiSettings:n,settings:d,theme:r});let p=null;return{openEditor:({onSave:i,defaultValue:s,ctx:n})=>{const r=()=>{p&&(p.close(),p=null)};return p=o.openFlyout((0,a.Pv)((0,l.jsx)(c,null,(0,l.jsx)(e,{onSave:e=>{r(),i(e)},onCancel:()=>{var e;return null===(e=p)||void 0===e?void 0:e.close()},docLinks:u,defaultValue:s,ctx:n})),t)),r}}})};var s}start(e,t){return{}}}var s=i(493),n=i(23);function r(){return new RuntimeFieldsPlugin}},289:(e,t,i)=>{"use strict";i.d(t,{BY:()=>m.CodeEditor,lV:()=>a.Form,A_:()=>s.TextField,kT:()=>a.UseField,fI:()=>n.createKibanaReactContext,c5:()=>l.fieldValidators,Pv:()=>p,mN:()=>a.useForm,O1:()=>a.useFormData});var a=i(602),l=i(791),s=i(296),n=i(409),r=i(286);const o=__kbnSharedDeps__.ReactDom;var u=i.n(o);const d=__kbnSharedDeps__.KbnReactKibanaContextRender;var c=i(172);const p=(e,t)=>i=>(u().render((0,c.jsx)(d.KibanaRenderContextProvider,t,e),i),()=>u().unmountComponentAtNode(i));i(915),i(8),r.Component;const m=__kbnSharedDeps__.KbnCodeEditor},674:(e,t,i)=>{i.p=window.__kbnPublicPath__.runtimeFields},296:(e,t,i)=>{i.r(t);var a=__kbnBundles__.get("plugin/esUiShared/static/forms/components");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},791:(e,t,i)=>{i.r(t);var a=__kbnBundles__.get("plugin/esUiShared/static/forms/helpers");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},602:(e,t,i)=>{i.r(t);var a=__kbnBundles__.get("plugin/esUiShared/static/forms/hook_form_lib");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},409:(e,t,i)=>{i.r(t);var a=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},915:(e,t,i)=>{e.exports=i(497)(67493)},172:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},8:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},t={};function i(a){var l=t[a];if(void 0!==l)return l.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,i),s.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var l=a.length-1;l>-1&&(!e||!/^http(s?):/.test(e));)e=a[l--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),i(674),__kbnBundles__.define("plugin/runtimeFields/public",i,930)})();