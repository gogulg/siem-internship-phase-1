/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e,t,a={2787:(e,t,a)=>{"use strict";a.d(t,{P4:()=>i,aS:()=>s,db:()=>n,kd:()=>r});const r="threatIntelligenceSearchStrategy",i="barchartAggregation";let n=function(e){return e.IndicatorGrid="indicatorGrid",e.Barchart="barchart",e}({});const s="indicator"},4421:(e,t,a)=>{"use strict";a.d(t,{N3:()=>i,zS:()=>r});let r=function(e){return e.Type="threat.indicator.type",e.Confidence="threat.indicator.confidence",e.FirstSeen="threat.indicator.first_seen",e.LastSeen="threat.indicator.last_seen",e.MarkingTLP="threat.indicator.marking.tlp",e.Feed="threat.feed.name",e.Ip="threat.indicator.ip",e.EmailAddress="threat.indicator.email.address",e.UrlFull="threat.indicator.url.full",e.UrlOriginal="threat.indicator.url.original",e.UrlDomain="threat.indicator.url.domain",e.FileSha256="threat.indicator.file.hash.sha256",e.FileMd5="threat.indicator.file.hash.md5",e.FileSha1="threat.indicator.file.hash.sha1",e.FileSha224="threat.indicator.file.hash.sha224",e.FileSha3224="threat.indicator.file.hash.sha3-224",e.FileSha3256="threat.indicator.file.hash.sha3-256",e.FileSha384="threat.indicator.file.hash.sha384",e.FileSha3384="threat.indicator.file.hash.sha3-384",e.FileSha512="threat.indicator.file.hash.sha512",e.FileSha3512="threat.indicator.file.hash.sha3-512",e.FileSha512224="threat.indicator.file.hash.sha512/224",e.FileSha512256="threat.indicator.file.hash.sha512/256",e.FileSSDeep="threat.indicator.file.hash.ssdeep",e.FileTlsh="threat.indicator.file.hash.tlsh",e.FileImpfuzzy="threat.indicator.file.hash.impfuzzy",e.FileImphash="threat.indicator.file.hash.imphash",e.FilePehash="threat.indicator.file.hash.pehash",e.FileVhash="threat.indicator.file.hash.vhash",e.X509Serial="threat.indicator.x509.serial_number",e.WindowsRegistryKey="threat.indicator.registry.key",e.WindowsRegistryPath="threat.indicator.registry.path",e.AutonomousSystemNumber="threat.indicator.as.number",e.MacAddress="threat.indicator.mac",e.TimeStamp="@timestamp",e.Id="_id",e.Name="threat.indicator.name",e.Description="threat.indicator.description",e.NameOrigin="threat.indicator.name_origin",e}({});const i={[r.FileSha256]:["file.hash.sha256"],[r.FileMd5]:["file.hash.md5"],[r.FileSha1]:["file.hash.sha1"],[r.FileSha224]:["file.hash.sha224"],[r.FileSha3224]:["file.hash.sha3-224"],[r.FileSha3256]:["file.hash.sha3-256"],[r.FileSha384]:["file.hash.sha384"],[r.FileSha3384]:["file.hash.sha3-384"],[r.FileSha512]:["file.hash.sha512"],[r.FileSha3512]:["file.hash.sha3-512"],[r.FileSha512224]:["file.hash.sha512/224"],[r.FileSha512256]:["file.hash.sha512/256"],[r.FileSSDeep]:["file.hash.ssdeep"],[r.FileTlsh]:["file.hash.tlsh"],[r.FileImpfuzzy]:["file.hash.impfuzzy"],[r.FileImphash]:["file.hash.imphash"],[r.FilePehash]:["file.hash.pehash"],[r.FileVhash]:["file.hash.vhash"],[r.Ip]:["source.ip","destination.ip"],[r.UrlFull]:["url.full"],[r.WindowsRegistryPath]:["registry.path"]}},1467:(e,t,a)=>{"use strict";a.d(t,{D2:()=>i,KT:()=>s,Oh:()=>n,_6:()=>r});const r="-",i="dateFormat",n="dateFormat:tz",s="event.type: indicator and event.category : threat"},6905:(e,t,a)=>{"use strict";a.d(t,{z:()=>r});const r=(0,a(4286).createContext)(void 0)},8802:(e,t,a)=>{"use strict";a.d(t,{q:()=>o});var r=a(4286),i=a.n(r),n=a(7541),s=a(6791);const o=i().memo((({children:e,...t})=>{const{services:{securityLayout:{getPluginWrapper:a}}}=(0,n.o1)(),i=(0,r.useMemo)((()=>a()),[a]);return(0,s.jsx)(i,t,e)}));o.displayName="SecuritySolutionPluginTemplateWrapper"},7541:(e,t,a)=>{"use strict";a.d(t,{Xf:()=>r.KibanaContextProvider,o1:()=>i});var r=a(409);const i=()=>(0,r.useKibana)()},919:(e,t,a)=>{"use strict";a.d(t,{J:()=>n});var r=a(4286),i=a(6905);const n=()=>{const e=(0,r.useContext)(i.z);if(!e)throw new Error("SecuritySolutionContext can only be used within SecuritySolutionContext provider");return e}},1691:(e,t,a)=>{"use strict";a.r(t),a.d(t,{THREAT_INTELLIGENCE_BASE_PATH:()=>j,getSecuritySolutionLink:()=>F,plugin:()=>w});var r=a(1215);const i=__kbnSharedDeps__.ReactRedux;var n=a(4286),s=a.n(n),o=a(5879),l=a(8126),c=a(7541),h=a(6905),d=a(1319),u=a(6791);const p=()=>{const{services:{application:e}}=(0,c.o1)();return(0,u.jsx)(d.EuiEmptyPrompt,{icon:(0,u.jsx)(d.EuiIcon,{type:"logoSecurity",size:"xl"}),color:"subdued","data-test-subj":"tiPaywall",title:(0,u.jsx)("h2",null,(0,u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.paywall.title",defaultMessage:"Do more with Security!"})),body:(0,u.jsx)("p",null,(0,u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.paywall.body",defaultMessage:"Start a free trial or upgrade your license to Enterprise to use threat intelligence."})),actions:(0,u.jsx)(d.EuiFlexGroup,{direction:"column"},(0,u.jsx)(d.EuiFlexItem,null,(0,u.jsx)("div",null,(0,u.jsx)(d.EuiButton,{color:"primary",fill:!0,href:"https://www.elastic.co/subscriptions"},(0,u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.paywall.upgrade",defaultMessage:"Upgrade"})))),(0,u.jsx)(d.EuiFlexItem,null,(0,u.jsx)("div",null,(0,u.jsx)(d.EuiButtonEmpty,{onClick:()=>e.navigateToApp("management",{path:"stack/license_management/home"})},(0,u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.paywall.trial",defaultMessage:"Start a free trial"})))))})};var g=a(919),f=a(8802);const m=(0,n.memo)((({children:e})=>{const{licenseService:t}=(0,g.J)();return t.isEnterprise()?(0,u.jsx)(s().Fragment,null,e):(0,u.jsx)(f.q,{isEmptyState:!0,emptyPageBody:(0,u.jsx)(p,null)})})),_=s().lazy((()=>Promise.all([a.e(213),a.e(498)]).then(a.bind(a,7539)))),b=e=>()=>({securitySolutionContext:t})=>(0,u.jsx)(o.__IntlProvider,null,(0,u.jsx)(i.Provider,{store:t.securitySolutionStore},(0,u.jsx)(h.z.Provider,{value:t},(0,u.jsx)(c.Xf,{services:e},(0,u.jsx)(m,null,(0,u.jsx)(n.Suspense,{fallback:(0,u.jsx)("div",null)},(0,u.jsx)(_,null)))))));class ThreatIntelligencePlugin{async setup(e,t){const a=(0,l.Te)();return t.cases.attachmentFramework.registerExternalReference(a),{}}start(e,t){const a={storage:new r.Storage(localStorage),...e,...t};return{getComponent:b(a)}}stop(){}}var y=a(5008);const S=y.i18n.translate("xpack.threatIntelligence.navigation.indicatorsNavItemLabel",{defaultMessage:"Indicators"}),v=y.i18n.translate("xpack.threatIntelligence.navigation.intelligenceNavItemLabel",{defaultMessage:"Intelligence"}),x=y.i18n.translate("xpack.threatIntelligence.navigation.indicatorsNavItemDescription",{defaultMessage:"Elastic threat intelligence helps you see if you are open to or have been subject to current or historical known threats."}),j=(y.i18n.translate("xpack.threatIntelligence.navigation.indicatorsNavItemKeywords",{defaultMessage:"Indicators"}),"/threat_intelligence"),k={indicators:{oldNavigationName:S,newNavigationName:v,path:`${j}/indicators`,id:"threat_intelligence",description:x,globalSearchKeywords:[v],keywords:[v],disabled:!1}},F=e=>({id:k[e].id,title:k[e].newNavigationName,path:k[e].path,description:k[e].description,globalSearchKeywords:k[e].globalSearchKeywords});function w(){return new ThreatIntelligencePlugin}},8126:(e,t,a)=>{"use strict";a.d(t,{Te:()=>g,d:()=>m,vO:()=>f});var r=a(450),i=a(4286),n=a.n(i),s=a(1319),o=a(5879),l=a(2787),c=a(1467),h=a(4421),d=a(2167),u=a(6791);const p=n().lazy((()=>Promise.all([a.e(213),a.e(949)]).then(a.bind(a,2949)))),g=()=>({id:l.aS,displayName:"indicator",getAttachmentViewObject:()=>({event:(0,u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.cases.eventDescription",defaultMessage:"added an indicator of compromise"}),timelineAvatar:(0,u.jsx)(s.EuiAvatar,{name:"indicator",color:"subdued",iconType:"crosshairs"}),children:p}),icon:"crosshairs"}),f=(e,t)=>e?[{type:r.AttachmentType.externalReference,externalReferenceId:e,externalReferenceStorage:{type:r.ExternalReferenceStorageType.elasticSearchDoc},externalReferenceAttachmentTypeId:l.aS,externalReferenceMetadata:t}]:[],m=e=>{const t=(0,d.e)(e,h.zS.Name).value,a=(0,d.e)(e,h.zS.Type).value,r=(0,d.e)(e,h.zS.Feed).value;return{indicatorName:t||c._6,indicatorType:a||c._6,indicatorFeedName:r||c._6}}},2167:(e,t,a)=>{"use strict";a.d(t,{X:()=>o,e:()=>s});var r=a(1467),i=a(5708),n=a(4421);const s=(e,t)=>{const a=(0,i.Z)(e,t);return{key:t===n.zS.Name?(0,i.Z)(e,n.zS.NameOrigin):t,value:a}},o=(e,t)=>!!t&&t!==r._6&&!!e},5708:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});const r=(e,t)=>{var a;if(!e)return null;const r=null===(a=e.fields)||void 0===a?void 0:a[t];if(!Array.isArray(r))return null;const i=r[0];return"object"==typeof i?null:i}},3024:(e,t,a)=>{a.p=window.__kbnPublicPath__.threatIntelligence},450:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/cases/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},7195:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},4627:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},8370:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/inspector/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},2137:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/kibanaReact/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},409:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},1215:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},3059:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticCharts},1319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},6791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},5964:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnEsQuery},5008:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},5879:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18nReact},3803:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnUiTheme},1783:e=>{"use strict";e.exports=__kbnSharedDeps__.Moment},2488:e=>{"use strict";e.exports=__kbnSharedDeps__.MomentTimezone},4286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},3530:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactQuery},2497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return a[e](n,n.exports,i),n.exports}i.m=a,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,a)=>(i.f[a](e,t),t)),[])),i.u=e=>"threatIntelligence.chunk."+e+".js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="@kbn/threat-intelligence-plugin:",i.l=(a,r,n,s)=>{if(e[a])e[a].push(r);else{var o,l;if(void 0!==n)for(var c=document.getElementsByTagName("script"),h=0;h<c.length;h++){var d=c[h];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==t+n){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,i.nc&&o.setAttribute("nonce",i.nc),o.setAttribute("data-webpack",t+n),o.src=a),e[a]=[r];var u=(t,r)=>{o.onerror=o.onload=null,clearTimeout(p);var i=e[a];if(delete e[a],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(r))),t)return t(r)},p=setTimeout(u.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=u.bind(null,o.onerror),o.onload=u.bind(null,o.onload),l&&document.head.appendChild(o)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var r=a.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=a[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={786:0};i.f.j=(t,a)=>{var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else{var n=new Promise(((a,i)=>r=e[t]=[a,i]));a.push(r[2]=n);var s=i.p+i.u(t),o=new Error;i.l(s,(a=>{if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var n=a&&("load"===a.type?"missing":a.type),s=a&&a.target&&a.target.src;o.message="Loading chunk "+t+" failed.\n("+n+": "+s+")",o.name="ChunkLoadError",o.type=n,o.request=s,r[1](o)}}),"chunk-"+t,t)}};var t=(t,a)=>{var r,n,[s,o,l]=a,c=0;if(s.some((t=>0!==e[t]))){for(r in o)i.o(o,r)&&(i.m[r]=o[r]);l&&l(i)}for(t&&t(a);c<s.length;c++)n=s[c],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0},a=self.threatIntelligence_bundle_jsonpfunction=self.threatIntelligence_bundle_jsonpfunction||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),i(3024),__kbnBundles__.define("plugin/threatIntelligence/public",i,1691)})();