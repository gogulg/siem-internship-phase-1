/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e,t,r,a={2708:(e,t,r)=>{"use strict";r.d(t,{Ov:()=>a});const a={APM:"apm",LOGS:"logs",INFRASTRUCTURE:"infrastructure",OBSERVABILITY:"observability",SLO:"slo",SIEM:"siem",UPTIME:"uptime",ML:"ml",STACK_ALERTS:"stackAlerts",EXAMPLE:"AlertingExample",MONITORING:"monitoring",ALERTS:"alerts",DISCOVER:"discover"};Object.values(a).map((e=>e))},9219:(e,t,r)=>{"use strict";r.d(t,{BI:()=>O,Cl:()=>S,DW:()=>u,Ez:()=>y,Kp:()=>f,Rn:()=>M,Ry:()=>b,S2:()=>o,SL:()=>v,Wp:()=>p,ZQ:()=>k,_9:()=>L,at:()=>m,fJ:()=>D,gH:()=>n,h:()=>T,h9:()=>d,ht:()=>a,i2:()=>c,lj:()=>_,pR:()=>g,qT:()=>x,sR:()=>R,tU:()=>E,tV:()=>w,tg:()=>h,vT:()=>i,xv:()=>l,z1:()=>A,zt:()=>s});const a="@timestamp",i="kibana",s=`${i}.alert`,n=`${s}.rule`,o=`${i}.space_ids`,l=`${i}.version`,c=`${s}.action_group`,d=`${s}.case_ids`,p=`${s}.duration.us`,u=`${s}.end`,h=`${s}.flapping`,_=`${s}.maintenance_window_ids`,g=`${s}.instance.id`,m=`${s}.reason`,f=`${s}.start`,y=`${s}.status`,b=`${s}.time_range`,T=`${s}.uuid`,v=`${s}.workflow_status`,E=`${s}.workflow_tags`,S=`${s}.workflow_assignee_ids`,O=`${n}.category`,D=`${n}.consumer`,A=`${n}.execution.uuid`,x=`${n}.name`,k=`${n}.parameters`,M=`${n}.producer`,R=`${n}.tags`,w=`${n}.rule_type_id`,L=`${n}.uuid`},9397:(e,t,r)=>{"use strict";r.d(t,{Yj:()=>o,lN:()=>l,lV:()=>u,n8:()=>c,wE:()=>a});const a="observability.rules.custom_threshold";let i=function(e){return e.ErrorCount="apm.error_rate",e.TransactionErrorRate="apm.transaction_error_rate",e.TransactionDuration="apm.transaction_duration",e.Anomaly="apm.anomaly",e}({});const s=Object.values(i),n=["xpack.synthetics.alerts.monitorStatus","xpack.synthetics.alerts.tls"],o="metrics.alert.inventory.threshold",l="metrics.alert.threshold",c="logs.alert.document.count",d=[c];let p=function(e){return e.MetricThreshold="metrics.alert.threshold",e.InventoryThreshold="metrics.alert.inventory.threshold",e}({});const u=[...s,...n,...Object.values(p),"xpack.uptime.alerts.tls","xpack.uptime.alerts.tlsCertificate","xpack.uptime.alerts.monitorStatus","xpack.uptime.alerts.durationAnomaly",...d,"slo.rules.burnRate",a]},8786:(e,t,r)=>{"use strict";r.d(t,{o:()=>a});let a=function(e){return e.GREATER_THAN=">",e.GREATER_THAN_OR_EQUALS=">=",e.BETWEEN="between",e.LESS_THAN="<",e.LESS_THAN_OR_EQUALS="<=",e.NOT_BETWEEN="notBetween",e}({})},2584:(e,t,r)=>{"use strict";r.d(t,{O5:()=>a.O5,PZ:()=>a.PZ,Xc:()=>a.Xc,_2:()=>a._2,cw:()=>a.cw,fH:()=>a.fH,jL:()=>a.jL});var a=r(8169)},8169:(e,t,r)=>{"use strict";r.d(t,{fH:()=>l,cw:()=>d,jL:()=>p,PZ:()=>o.n8,kq:()=>u,Nn:()=>g,fF:()=>L,Gj:()=>w,tx:()=>v,er:()=>q,O5:()=>M,_2:()=>R,Xc:()=>k,lX:()=>T,mq:()=>b});var a=r(5008),i=r(3782),s=r(6764);const n=i.type({_shards:i.type({total:i.number,successful:i.number,skipped:i.number,failed:i.number}),timed_out:i.boolean,took:i.number});var o=r(9397);i.keyof({count:null,ratio:null});let l=function(e){return e.GT="more than",e.GT_OR_EQ="more than or equals",e.LT="less than",e.LT_OR_EQ="less than or equals",e.EQ="equals",e.NOT_EQ="does not equal",e.MATCH="matches",e.NOT_MATCH="does not match",e.MATCH_PHRASE="matches phrase",e.NOT_MATCH_PHRASE="does not match phrase",e}({});const c=i.keyof({[l.GT]:null,[l.GT_OR_EQ]:null,[l.LT]:null,[l.LT_OR_EQ]:null,[l.EQ]:null,[l.NOT_EQ]:null,[l.MATCH]:null,[l.NOT_MATCH]:null,[l.MATCH_PHRASE]:null,[l.NOT_MATCH_PHRASE]:null}),d={[l.GT]:a.i18n.translate("xpack.infra.logs.alerting.comparator.gt",{defaultMessage:"more than"}),[l.GT_OR_EQ]:a.i18n.translate("xpack.infra.logs.alerting.comparator.gtOrEq",{defaultMessage:"more than or equals"}),[l.LT]:a.i18n.translate("xpack.infra.logs.alerting.comparator.lt",{defaultMessage:"less than"}),[l.LT_OR_EQ]:a.i18n.translate("xpack.infra.logs.alerting.comparator.ltOrEq",{defaultMessage:"less than or equals"}),[l.EQ]:a.i18n.translate("xpack.infra.logs.alerting.comparator.eq",{defaultMessage:"is"}),[l.NOT_EQ]:a.i18n.translate("xpack.infra.logs.alerting.comparator.notEq",{defaultMessage:"is not"}),[`${l.EQ}:number`]:a.i18n.translate("xpack.infra.logs.alerting.comparator.eqNumber",{defaultMessage:"equals"}),[`${l.NOT_EQ}:number`]:a.i18n.translate("xpack.infra.logs.alerting.comparator.notEqNumber",{defaultMessage:"does not equal"}),[l.MATCH]:a.i18n.translate("xpack.infra.logs.alerting.comparator.match",{defaultMessage:"matches"}),[l.NOT_MATCH]:a.i18n.translate("xpack.infra.logs.alerting.comparator.notMatch",{defaultMessage:"does not match"}),[l.MATCH_PHRASE]:a.i18n.translate("xpack.infra.logs.alerting.comparator.matchPhrase",{defaultMessage:"matches phrase"}),[l.NOT_MATCH_PHRASE]:a.i18n.translate("xpack.infra.logs.alerting.comparator.notMatchPhrase",{defaultMessage:"does not match phrase"})},p={[l.GT]:">",[l.GT_OR_EQ]:"≥",[l.LT]:"<",[l.LT_OR_EQ]:"≤",[l.EQ]:"=",[l.NOT_EQ]:"≠",[`${l.EQ}:number`]:"=",[`${l.NOT_EQ}:number`]:"≠",[l.MATCH]:a.i18n.translate("xpack.infra.logs.alerting.comparator.symbol.match",{defaultMessage:"matches"}),[l.NOT_MATCH]:a.i18n.translate("xpack.infra.logs.alerting.comparator.symbol.notMatch",{defaultMessage:"does not match"}),[l.MATCH_PHRASE]:a.i18n.translate("xpack.infra.logs.alerting.comparator.symbol.matchPhrase",{defaultMessage:"matches phrase"}),[l.NOT_MATCH_PHRASE]:a.i18n.translate("xpack.infra.logs.alerting.comparator.symbol.notMatchPhrase",{defaultMessage:"does not match phrase"})},u=i.type({comparator:c,value:i.number}),h=i.type({field:i.string,comparator:c,value:i.union([i.string,i.number])}),_=i.partial(h.props),g=i.array(h),m=i.array(_),f=i.tuple([g,g]),y=i.tuple([m,m]),b=(i.union([m,y]),i.union([i.literal("s"),i.literal("m"),i.literal("h"),i.literal("d")])),T=i.number,v=i.array(i.string),E=i.type({count:u,timeUnit:b,timeSize:T,logView:s.persistedLogViewReferenceRT}),S=(i.partial(E.props),i.partial({groupBy:v})),O=i.intersection([i.type({criteria:g,...E.props}),i.partial({...S.props})]),D=i.intersection([i.type({criteria:m,...E.props}),i.partial({...S.props})]),A=i.intersection([i.type({criteria:f,...E.props}),i.partial({...S.props})]),x=i.intersection([i.type({criteria:y,...E.props}),i.partial({...S.props})]),k=i.union([O,A]),M=(i.union([D,x]),e=>!!(e.length>0&&Array.isArray(e[0]))),R=e=>M(e.criteria),w=e=>e[0],L=e=>e[1],C=i.type({key:i.number,doc_count:i.number}),I=i.type({hits:i.type({hits:i.array(i.type({fields:i.record(i.string,i.array(i.unknown))}))})}),P=i.partial({histogramBuckets:i.type({buckets:i.array(C)})}),F=i.partial({additionalContext:I}),j=i.type({total:i.type({value:i.number})}),N=i.type({key:i.record(i.string,i.string),doc_count:i.number}),U=i.partial({after_key:i.record(i.string,i.string)}),H=(i.intersection([n,i.intersection([i.type({hits:j}),i.partial({aggregations:i.intersection([P,F])})])]),i.intersection([n,i.type({aggregations:i.type({groups:i.intersection([i.type({buckets:i.array(i.type({...N.props,filtered_results:i.intersection([i.type({doc_count:i.number}),P,F])}))}),U])}),hits:j})])),V=i.intersection([n,i.type({aggregations:i.type({groups:i.intersection([i.type({buckets:i.array(i.intersection([N,P,F]))}),U])}),hits:j})]),q=(i.union([H,V]),(e,t)=>e===l.GT||"number"==typeof t&&e===l.GT_OR_EQ&&t>0)},4332:(e,t,r)=>{"use strict";r.d(t,{J2:()=>s,Yj:()=>i,lN:()=>a,H2:()=>n});const a="metrics.alert.threshold",i="metrics.alert.inventory.threshold";let s=function(e){return e.COUNT="count",e.AVERAGE="avg",e.SUM="sum",e.MIN="min",e.MAX="max",e.RATE="rate",e.CARDINALITY="cardinality",e.P95="p95",e.P99="p99",e.CUSTOM="custom",e}({});const n=Symbol("QUERY_INVALID")},2787:(e,t,r)=>{"use strict";r.d(t,{CE:()=>g,KN:()=>_,W3:()=>n,WK:()=>l,ah:()=>s,ko:()=>o,l0:()=>h,mc:()=>c,nx:()=>u,p:()=>m,pD:()=>p,rc:()=>d,w3:()=>i});var a=r(2708);const i="metrics-*,metricbeat-*",s="metrics",n="logs",o=(a.Ov.INFRASTRUCTURE,a.Ov.INFRASTRUCTURE,a.Ov.LOGS,[a.Ov.INFRASTRUCTURE,a.Ov.OBSERVABILITY,a.Ov.LOGS,a.Ov.SLO,a.Ov.APM,a.Ov.ALERTS]),l="@timestamp",c="host.name",d="container.id",p="kubernetes.pod.uid",u="process.command_line",h="system",_=9e5,g={name:"Metrics View",timeFieldName:l},m=20},2105:(e,t,r)=>{"use strict";r.d(t,{F:()=>y,Y:()=>h});var a=r(5008),i=r(6764),s=r(2584),n=r(2503),o=r(9219);const l=e=>({fields:t})=>{var r;const a=null!==(r=t[o.at])&&void 0!==r?r:"",i=t[o.Kp],s=null!=i?new Date(i).valueOf():void 0,n=e.getRedirectUrl({time:s});return{reason:a,link:c(n)}},c=e=>{const t=e.indexOf("/app/");return e.substring(t)};var d=r(53);const p=a.i18n.translate("xpack.infra.logs.alerting.threshold.defaultActionMessage",{defaultMessage:"'{{context.reason}}'\n\n'{{rule.name}}' is active.\n\n'{{^context.isRatio}}{{#context.group}}{{context.group}}' - '{{/context.group}}{{context.matchingDocuments}}' log entries have matched the following conditions: '{{context.conditions}}{{/context.isRatio}}'\n'{{#context.isRatio}}{{#context.group}}{{context.group}}' - '{{/context.group}}' Ratio of the count of log entries matching '{{context.numeratorConditions}}' to the count of log entries matching '{{context.denominatorConditions}}' was '{{context.ratio}}{{/context.isRatio}}'\n\n[View alert details]('{{context.alertDetailsUrl}}')\n"}),u=a.i18n.translate("xpack.infra.logs.alerting.threshold.defaultRecoveryMessage",{defaultMessage:"Recovered: '{{context.reason}}'\n    \n    '{{rule.name}}' has recovered.\n\n[View alert details]('{{context.alertDetailsUrl}}')\n"});function h(e,t){const o=(0,n.bj)(e,(()=>Promise.all([r.e(94),r.e(133),r.e(602),r.e(64)]).then(r.bind(r,1683)))),c=(0,n.bj)(e,(()=>Promise.all([r.e(94),r.e(310),r.e(860)]).then(r.bind(r,6213)))),h=(0,i.getLogsLocatorFromUrlService)(t);return{id:s.PZ,description:a.i18n.translate("xpack.infra.logs.alertFlyout.alertDescription",{defaultMessage:"Alert when the log aggregation exceeds the threshold."}),iconClass:"bell",documentationUrl:e=>`${e.links.observability.logsThreshold}`,alertDetailsAppSection:c,ruleParamsExpression:o,validate:d.P1,defaultActionMessage:p,defaultRecoveryMessage:u,requiresAppContext:!1,format:l(h),priority:30}}var _=r(4286),g=r.n(_),m=r(6791);const f=g().lazy((()=>r.e(434).then(r.bind(r,8434)))),y=()=>(0,m.jsx)(g().Suspense,{fallback:(0,m.jsx)("div",null)},(0,m.jsx)(f,null))},53:(e,t,r)=>{"use strict";r.d(t,{CA:()=>d,P1:()=>p});var a=r(5008),i=r(3782),s=r(770),n=r(8169);const o=i.type({field:i.array(i.string),comparator:i.array(i.string),value:i.array(i.string)}),l=i.record(i.string,o),c=i.recursion("AlertingError",(()=>i.record(i.string,i.union([i.string,i.array(i.string),c])))),d=i.type({threshold:i.type({value:i.array(i.string)}),criteria:i.record(i.string,l),timeWindowSize:i.array(i.string),timeSizeUnit:i.array(i.string)});function p({count:e,criteria:t,timeSize:r}){const i={errors:{}},o={threshold:{value:[]},criteria:{},timeSizeUnit:[],timeWindowSize:[]};if(i.errors=o,(0,s.isNumber)(null==e?void 0:e.value)||(0,s.isFinite)(null==e?void 0:e.value)||o.threshold.value.push(a.i18n.translate("xpack.infra.logs.alertFlyout.error.thresholdRequired",{defaultMessage:"Numeric threshold value is Required."})),r||o.timeWindowSize.push(a.i18n.translate("xpack.infra.logs.alertFlyout.error.timeSizeRequired",{defaultMessage:"Time size is Required."})),t&&t.length>0){const e=e=>{const t={};return e.forEach(((e,r)=>{t[r]={field:[],comparator:[],value:[]},e.field||t[r].field.push(a.i18n.translate("xpack.infra.logs.alertFlyout.error.criterionFieldRequired",{defaultMessage:"Field is required."})),e.comparator||t[r].comparator.push(a.i18n.translate("xpack.infra.logs.alertFlyout.error.criterionComparatorRequired",{defaultMessage:"Comparator is required."})),void 0!==e.value&&null!==e.value||t[r].value.push(a.i18n.translate("xpack.infra.logs.alertFlyout.error.criterionValueRequired",{defaultMessage:"Value is required."}))})),t};if((0,n.O5)(t)){const r=e((0,n.Gj)(t));o.criteria[0]=r;const a=e((0,n.fF)(t));o.criteria[1]=a}else{const r=e(t);o.criteria[0]=r}}return i}},5266:(e,t,r)=>{"use strict";r.d(t,{i:()=>a});const a="LOG_STREAM_EMBEDDABLE"},2503:(e,t,r)=>{"use strict";r.d(t,{Q7:()=>d,bZ:()=>l,bj:()=>h,ei:()=>u,fJ:()=>c,vH:()=>p});var a=r(4286),i=r.n(a),s=r(409),n=r(6791);const o=(e,t,r)=>(0,s.createKibanaReactContext)({...e,...t,...r}),l=(0,a.createContext)({}),c=s.useKibana,d=(e,t,r)=>{const{Provider:i}=(0,a.useMemo)((()=>o(e,t,r)),[e,r,t]);return i},p=e=>{const t=(0,a.useMemo)((()=>({kibanaVersion:null==e?void 0:e.kibanaVersion,isCloudEnv:null==e?void 0:e.isCloudEnv,isServerlessEnv:null==e?void 0:e.isServerlessEnv})),[e]);return({kibanaEnv:e={},children:r})=>(0,a.createElement)(l.Provider,{value:{...e,...t},children:r})};function u(){return(0,a.useContext)(l)}const h=(e,t)=>i().lazy((()=>Promise.all([t(),e.getStartServices()]).then((([{default:e},[t,r,a]])=>{const{Provider:i}=o(t,r,a);return{default:t=>(0,n.jsx)(i,null,(0,n.jsx)(e,t))}}))))},2739:(e,t,r)=>{"use strict";r.r(t),r.d(t,{plugin:()=>se});var a=r(8915),i=r(4390),s=r(5008),n=r(3780),o=r(190),l=r(4286),c=r.n(l),d=r(4332),p=r(8786);function u({criteria:e,filterQuery:t}){const r={errors:{}},a={};return r.errors=a,t===d.H2&&(a.filterQuery=[s.i18n.translate("xpack.infra.metrics.alertFlyout.error.invalidFilterQuery",{defaultMessage:"Filter query is invalid."})]),e&&e.length?(e.forEach(((e,t)=>{var r;const i=t.toString();a[i]=a[i]||{timeSizeUnit:[],timeWindowSize:[],critical:{threshold0:[],threshold1:[]},warning:{threshold0:[],threshold1:[]},metric:[]},e.threshold&&e.threshold.length||a[i].critical.threshold0.push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.thresholdRequired",{defaultMessage:"Threshold is required."})),e.warningThreshold&&!e.warningThreshold.length&&a[i].warning.threshold0.push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.thresholdRequired",{defaultMessage:"Threshold is required."}));for(const t of[{comparator:e.comparator,threshold:e.threshold,type:"critical"},{comparator:e.warningComparator,threshold:e.warningThreshold,type:"warning"}]){const{comparator:e,threshold:r,type:n}=t;r&&r.length&&![...r].every(h)&&[...r].forEach(((e,t)=>{if(!h(e)){const e=0===t?"threshold0":"threshold1";a[i][n][e].push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.thresholdTypeRequired",{defaultMessage:"Thresholds must contain a valid number."}))}})),e===p.o.BETWEEN&&(!r||r.length<2)&&a[i][n].threshold1.push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.thresholdRequired",{defaultMessage:"Threshold is required."}))}e.timeSize||a[i].timeWindowSize.push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.timeRequred",{defaultMessage:"Time size is Required."})),e.metric||a[i].metric.push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.metricRequired",{defaultMessage:"Metric is required."})),"custom"!==e.metric||null!==(r=e.customMetric)&&void 0!==r&&r.field||a[i].metric.push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.customMetricFieldRequired",{defaultMessage:"Field is required."}))})),r):r}const h=e=>"number"==typeof e;var _=r(9219),g=r(1783),m=r.n(g),f=r(5995),y=r(1474),b=r(770),T=r(2787);const v=`${_.ZQ}.criteria.metric`,E=`${_.ZQ}.nodeType`,S="custom",O=(e,t="")=>Object.entries(e).reduce(((e,[r,a])=>{const i=t.length?`${t}.${r}`:r;return"object"==typeof a&&null!=a?Array.isArray(a)&&a.length>0?Object.assign(e,O(a[0],i)):Object.assign(e,O(a,i)):(e[i]=Array.isArray(a)?a:[a],e)}),{}),D=({fields:e,assetDetailsLocator:t,inventoryLocator:r})=>{if(!t||!r)throw new Error("Locators for Asset Details and Inventory are required");const a=e[_.ZQ]?{...e,...O(e[_.ZQ],_.ZQ)}:e,i=(0,b.castArray)(a[E])[0];if(!i)return"";const s=a[(0,y.findInventoryModel)(i).fields.id],o=Object.values(n.SupportedAssetTypes).includes(i),l=a[v][0];if(s&&o)return A({assetId:s,assetType:i,timestamp:a[_.ht],alertMetric:l,assetDetailsLocator:t});const c={nodeType:i,timestamp:Date.parse(a[_.ht]),customMetric:"",metric:""};if(l===S){const e=a[`${_.ZQ}.criteria.customMetric.id`][0],t=a[`${_.ZQ}.criteria.customMetric.aggregation`][0],r=a[`${_.ZQ}.criteria.customMetric.field`][0],i=(0,f.encode)({id:e,type:S,field:r,aggregation:t});c.customMetric=i,c.metric=i}else c.metric=(0,f.encode)({type:l});return r.getRedirectUrl({...c})};function A({assetId:e,assetType:t,timestamp:r,alertMetric:a,assetDetailsLocator:i}){return i.getRedirectUrl({assetId:e,assetType:t,assetDetails:{dateRange:{from:r,to:m()(r).add(T.KN,"ms").toISOString()},...a&&a!==S?{alertMetric:a}:void 0}})}const x=s.i18n.translate("xpack.infra.metrics.alerting.inventory.threshold.defaultActionMessage",{defaultMessage:"'{{context.reason}}'\n\n'{{rule.name}}' is active with the following conditions:\n\n- Affected: '{{context.group}}'\n- Metric: '{{context.metric}}'\n- Observed value: '{{context.value}}'\n- Threshold: '{{context.threshold}}'\n\n[View alert details]('{{context.alertDetailsUrl}}')\n"}),k=s.i18n.translate("xpack.infra.metrics.alerting.inventory.threshold.defaultRecoveryMessage",{defaultMessage:"Recovered '{{context.reason}}'\n\n    '{{rule.name}}' has recovered.\n\n- Affected: '{{context.group}}'\n- Metric: '{{context.metric}}'\n- Threshold: '{{context.threshold}}'\n\n[View alert details]('{{context.alertDetailsUrl}}')\n"});var M=r(2105),R=r(5964);const w=/[^A-Z|+|\-|\s|\d+|\.|\(|\)|\/|\*|>|<|=|\?|\:|&|\!|\|]+/g;function L({criteria:e,filterQuery:t}){const r={errors:{}},a={};return r.errors=a,t===d.H2&&(a.filterQuery=[s.i18n.translate("xpack.infra.metrics.alertFlyout.error.invalidFilterQuery",{defaultMessage:"Filter query is invalid."})]),e&&e.length?(e.forEach(((e,t)=>{const r=t.toString();a[r]=a[r]||{aggField:[],timeSizeUnit:[],timeWindowSize:[],critical:{threshold0:[],threshold1:[]},warning:{threshold0:[],threshold1:[]},metric:[],filterQuery:[],customMetrics:{}},e.aggType||a[r].aggField.push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.aggregationRequired",{defaultMessage:"Aggregation is required."})),e.threshold&&e.threshold.length||a[r].critical.threshold0.push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.thresholdRequired",{defaultMessage:"Threshold is required."})),e.warningThreshold&&!e.warningThreshold.length&&a[r].warning.threshold0.push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.thresholdRequired",{defaultMessage:"Threshold is required."}));for(const t of[{comparator:e.comparator,threshold:e.threshold,type:"critical"},{comparator:e.warningComparator,threshold:e.warningThreshold,type:"warning"}]){const{comparator:e,threshold:i,type:n}=t;i&&i.length&&![...i].every(C)&&[...i].forEach(((e,t)=>{if(!C(e)){const e=0===t?"threshold0":"threshold1";a[r][n][e].push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.thresholdTypeRequired",{defaultMessage:"Thresholds must contain a valid number."}))}})),e===p.o.BETWEEN&&(!i||i.length<2)&&a[r][n].threshold1.push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.thresholdRequired",{defaultMessage:"Threshold is required."}))}e.timeSize||a[r].timeWindowSize.push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.timeRequred",{defaultMessage:"Time size is Required."})),"count"===e.aggType||"custom"===e.aggType||e.metric||a[r].metric.push(s.i18n.translate("xpack.infra.metrics.alertFlyout.error.metricRequired",{defaultMessage:"Metric is required."})),e.aggType===d.J2.CUSTOM&&(!e.customMetrics||e.customMetrics&&e.customMetrics.length<1?a[r].customMetricsError=s.i18n.translate("xpack.infra.metrics.alertFlyout.error.customMetricsError",{defaultMessage:"You must define at least 1 custom metric"}):e.customMetrics.forEach((e=>{const t={};if(e.aggType||(t.aggType=s.i18n.translate("xpack.infra.metrics.alertFlyout.error.customMetrics.aggTypeRequired",{defaultMessage:"Aggregation is required"})),"count"===e.aggType||e.field||(t.field=s.i18n.translate("xpack.infra.metrics.alertFlyout.error.customMetrics.fieldRequired",{defaultMessage:"Field is required"})),"count"===e.aggType&&e.filter)try{(0,R.fromKueryExpression)(e.filter)}catch(e){t.filter=e.message}(0,b.isEmpty)(t)||(a[r].customMetrics[e.name]=t)})),e.equation&&e.equation.match(w)&&(a[r].equation=s.i18n.translate("xpack.infra.metrics.alertFlyout.error.equation.invalidCharacters",{defaultMessage:"The equation field only supports the following characters: A-Z, +, -, /, *, (, ), ?, !, &, :, |, >, <, ="})))})),r):r}const C=e=>"number"==typeof e,I=({assetDetailsLocator:e,metricsExplorerLocator:t})=>({fields:r})=>{var a;const i=null!==(a=r[_.at])&&void 0!==a?a:"-",s=r[_.ZQ],o=(({fields:e,groupBy:t,assetDetailsLocator:r,metricsExplorerLocator:a})=>{if(!r||!a)throw new Error("Locators for Asset Details and Metrics Explorer are required");if(!t)return a.getRedirectUrl({});const i=Object.values(n.SupportedAssetTypes).reduce(((e,t)=>(e[(0,y.findInventoryModel)(t).fields.id]=t,e)),{}),s=t.find((e=>!!i[e])),o=s?i[s]:void 0;if(o){const t=e[(0,y.findInventoryModel)(o).fields.id];return t?A({assetId:t,assetType:o,timestamp:e[_.ht],assetDetailsLocator:r}):a.getRedirectUrl({})}return a.getRedirectUrl({})})({fields:r,groupBy:(0,b.castArray)(null==s?void 0:s.groupBy),assetDetailsLocator:e,metricsExplorerLocator:t});return{reason:i,link:o,hasBasePath:!0}},P=s.i18n.translate("xpack.infra.metrics.alerting.metric.threshold.defaultActionMessage",{defaultMessage:"'{{context.reason}}'\n\n'{{rule.name}}' is active with the following conditions:\n\n- Affected: '{{context.group}}'\n- Metric: '{{context.metric}}'\n- Observed value: '{{context.value}}'\n- Threshold: '{{context.threshold}}'\n\n[View alert details]('{{context.alertDetailsUrl}}')\n"}),F=s.i18n.translate("xpack.infra.metrics.alerting.metric.threshold.defaultRecoveryMessage",{defaultMessage:"Recovered: '{{context.reason}}'\n    \n  '{{rule.name}}' has recovered.\n\n- Affected: '{{context.group}}'\n- Metric: '{{context.metric}}'\n- Threshold: '{{context.threshold}}'\n\n[View alert details]('{{context.alertDetailsUrl}}')\n"});var j=r(5266);const N=e=>async()=>{const[t]=await e(),{http:r}=t,a=await r.get("/api/metrics/source/default/hasData");return{hasData:a.hasData,indices:a.configuration.metricAlias}},U=e=>async({absoluteTime:t,intervalString:r})=>{const[a]=await e(),{http:i}=a,s=async(e={})=>{const{start:a,end:n}=t,o={sourceId:"default",bucketSize:r,size:5,timerange:{from:a,to:n},...e};return{appLink:`/app/metrics/inventory?waffleTime=(currentTime:${n},isAutoReloading:!f)`,series:(await i.post("/api/metrics/overview/top",{body:JSON.stringify(o)})).series,sort:async(e,t)=>s({sort:e,sortDirection:t})}};return await s()};class InventoryViewsService{constructor(){(0,a.default)(this,"client",void 0)}setup(){return{}}start({http:e}){return{getClient:()=>this.getClient({http:e})}}async getClient({http:e}){if(!this.client){const{InventoryViewsClient:t}=await Promise.all([r.e(94),r.e(133),r.e(108)]).then(r.bind(r,5108)),a=new t(e);this.client=a}return this.client}}class MetricsExplorerViewsService{constructor(){(0,a.default)(this,"client",void 0)}setup(){return{}}start({http:e}){return{getClient:()=>this.getClient({http:e})}}async getClient({http:e}){if(!this.client){const{MetricsExplorerViewsClient:t}=await Promise.all([r.e(94),r.e(133),r.e(502)]).then(r.bind(r,5502)),a=new t(e);this.client=a}return this.client}}var H=r(1192);let V=function(e){return e.HOSTS_VIEW_QUERY_SUBMITTED="Hosts View Query Submitted",e.HOSTS_ENTRY_CLICKED="Host Entry Clicked",e.HOST_FLYOUT_FILTER_REMOVED="Host Flyout Filter Removed",e.HOST_FLYOUT_FILTER_ADDED="Host Flyout Filter Added",e.HOST_VIEW_TOTAL_HOST_COUNT_RETRIEVED="Host View Total Host Count Retrieved",e.ASSET_DETAILS_FLYOUT_VIEWED="Asset Details Flyout Viewed",e.ASSET_DETAILS_PAGE_VIEWED="Asset Details Page Viewed",e.ASSET_DASHBOARD_LOADED="Asset Dashboard Loaded",e.ADD_METRICS_CALLOUT_ADD_METRICS_CLICKED="Add Metrics Callout Add Metrics Clicked",e.ADD_METRICS_CALLOUT_TRY_IT_CLICKED="Add Metrics Callout Try It Clicked",e.ADD_METRICS_CALLOUT_LEARN_MORE_CLICKED="Add Metrics Callout Learn More Clicked",e.ADD_METRICS_CALLOUT_DISMISSED="Add Metrics Callout Dismissed",e.ANOMALY_DETECTION_SETUP="Infra Anomaly Detection Job Setup",e.ANOMALY_DETECTION_DATE_FIELD_CHANGE="Infra Anomaly Detection Job Date Field Change",e.ANOMALY_DETECTION_PARTITION_FIELD_CHANGE="Infra Anomaly Detection Job Partition Field Change",e.ANOMALY_DETECTION_FILTER_FIELD_CHANGE="Infra Anomaly Detection Job Filter Field Change",e}({});class TelemetryClient{constructor(e){(0,a.default)(this,"reportHostEntryClicked",(({hostname:e,cloud_provider:t})=>{this.analytics.reportEvent(V.HOSTS_ENTRY_CLICKED,{hostname:e,cloud_provider:null!=t?t:"unknown"})})),(0,a.default)(this,"reportHostFlyoutFilterRemoved",(({field_name:e})=>{this.analytics.reportEvent(V.HOST_FLYOUT_FILTER_REMOVED,{field_name:e})})),(0,a.default)(this,"reportHostFlyoutFilterAdded",(({field_name:e})=>{this.analytics.reportEvent(V.HOST_FLYOUT_FILTER_ADDED,{field_name:e})})),(0,a.default)(this,"reportHostsViewQuerySubmitted",(e=>{this.analytics.reportEvent(V.HOSTS_VIEW_QUERY_SUBMITTED,e)})),(0,a.default)(this,"reportAssetDetailsFlyoutViewed",(e=>{this.analytics.reportEvent(V.ASSET_DETAILS_FLYOUT_VIEWED,e)})),(0,a.default)(this,"reportAssetDetailsPageViewed",(e=>{this.analytics.reportEvent(V.ASSET_DETAILS_PAGE_VIEWED,e)})),(0,a.default)(this,"reportAssetDashboardLoaded",(e=>{this.analytics.reportEvent(V.ASSET_DASHBOARD_LOADED,e)})),(0,a.default)(this,"reportPerformanceMetricEvent",((e,t,r={},a={})=>{(0,H.reportPerformanceMetricEvent)(this.analytics,{eventName:e,duration:t,meta:a,...r})})),(0,a.default)(this,"reportAddMetricsCalloutAddMetricsClicked",(e=>{this.analytics.reportEvent(V.ADD_METRICS_CALLOUT_ADD_METRICS_CLICKED,e)})),(0,a.default)(this,"reportAddMetricsCalloutTryItClicked",(e=>{this.analytics.reportEvent(V.ADD_METRICS_CALLOUT_TRY_IT_CLICKED,e)})),(0,a.default)(this,"reportAddMetricsCalloutLearnMoreClicked",(e=>{this.analytics.reportEvent(V.ADD_METRICS_CALLOUT_LEARN_MORE_CLICKED,e)})),(0,a.default)(this,"reportAddMetricsCalloutDismissed",(e=>{this.analytics.reportEvent(V.ADD_METRICS_CALLOUT_DISMISSED,e)})),(0,a.default)(this,"reportAnomalyDetectionSetup",(e=>{this.analytics.reportEvent(V.ANOMALY_DETECTION_SETUP,e)})),(0,a.default)(this,"reportAnomalyDetectionDateFieldChange",(e=>{this.analytics.reportEvent(V.ANOMALY_DETECTION_DATE_FIELD_CHANGE,e)})),(0,a.default)(this,"reportAnomalyDetectionPartitionFieldChange",(e=>{this.analytics.reportEvent(V.ANOMALY_DETECTION_PARTITION_FIELD_CHANGE,e)})),(0,a.default)(this,"reportAnomalyDetectionFilterFieldChange",(e=>{this.analytics.reportEvent(V.ANOMALY_DETECTION_FILTER_FIELD_CHANGE,e)})),this.analytics=e}reportHostsViewTotalHostCountRetrieved(e){this.analytics.reportEvent(V.HOST_VIEW_TOTAL_HOST_COUNT_RETRIEVED,e)}}const q={eventType:V.HOSTS_VIEW_QUERY_SUBMITTED,schema:{control_filter_fields:{type:"array",items:{type:"text",_meta:{description:"Selected host control filter.",optional:!1}}},filter_fields:{type:"array",items:{type:"text",_meta:{description:"Applied host search filter.",optional:!1}}},interval:{type:"text",_meta:{description:"Time interval for the performed search.",optional:!1}},with_query:{type:"boolean",_meta:{description:"KQL query search for hosts",optional:!1}},limit:{type:"integer",_meta:{description:"Selected host limit",optional:!1}}}},B={eventType:V.HOSTS_ENTRY_CLICKED,schema:{hostname:{type:"keyword",_meta:{description:"Hostname for the clicked host.",optional:!1}},cloud_provider:{type:"keyword",_meta:{description:"Cloud provider for the clicked host.",optional:!0}}}},$={eventType:V.HOST_FLYOUT_FILTER_REMOVED,schema:{field_name:{type:"keyword",_meta:{description:"Removed filter field name for the selected host.",optional:!1}}}},Q={eventType:V.HOST_FLYOUT_FILTER_ADDED,schema:{field_name:{type:"keyword",_meta:{description:"Added filter field name for the selected host.",optional:!1}}}},K={eventType:V.HOST_VIEW_TOTAL_HOST_COUNT_RETRIEVED,schema:{total:{type:"integer",_meta:{description:"Total number of hosts retrieved.",optional:!1}},with_query:{type:"boolean",_meta:{description:"Has KQL query",optional:!1}},with_filters:{type:"boolean",_meta:{description:"Has filters",optional:!1}}}},Y=[{eventType:V.ASSET_DETAILS_FLYOUT_VIEWED,schema:{componentName:{type:"keyword",_meta:{description:"Name of the parent react component for the clicked asset.",optional:!1}},assetType:{type:"keyword",_meta:{description:"Asset type for the clicked asset.",optional:!1}},tabId:{type:"keyword",_meta:{description:"Tab id for the clicked asset.",optional:!0}}}},{eventType:V.ASSET_DETAILS_PAGE_VIEWED,schema:{componentName:{type:"keyword",_meta:{description:"Name of the parent react component for the clicked asset.",optional:!1}},assetType:{type:"keyword",_meta:{description:"Asset type for the clicked asset.",optional:!1}},tabId:{type:"keyword",_meta:{description:"Tab id for the clicked asset.",optional:!0}},integrations:{type:"pass_through",_meta:{description:"Integrations enabled for the displayed asset.",optional:!0}}}},q,B,$,Q,K,{eventType:V.ASSET_DASHBOARD_LOADED,schema:{assetType:{type:"keyword",_meta:{description:"Asset type for the selected asset.",optional:!1}},state:{type:"boolean",_meta:{description:"If the dashboard is filtered or now",optional:!1}},filtered_by:{type:"array",items:{type:"text",_meta:{description:"Filters enabled for the dashboard added for an asset"}}}}},{eventType:V.ADD_METRICS_CALLOUT_ADD_METRICS_CLICKED,schema:{view:{type:"keyword",_meta:{description:"Where the action was initiated (add_metrics_cta)"}}}},{eventType:V.ADD_METRICS_CALLOUT_TRY_IT_CLICKED,schema:{view:{type:"keyword",_meta:{description:"Where the action was initiated (add_metrics_cta)"}}}},{eventType:V.ADD_METRICS_CALLOUT_LEARN_MORE_CLICKED,schema:{view:{type:"keyword",_meta:{description:"Where the action was initiated (add_metrics_cta)"}}}},{eventType:V.ADD_METRICS_CALLOUT_DISMISSED,schema:{view:{type:"keyword",_meta:{description:"Where the action was initiated (add_metrics_cta)"}}}},{eventType:V.ANOMALY_DETECTION_SETUP,schema:{job_type:{type:"text",_meta:{description:"Type of job for the anomaly detection"}},configured_fields:{properties:{start_date:{type:"text",_meta:{description:"Start date for the anomaly detection job"}},partition_field:{type:"text",_meta:{description:"Partition field for the anomaly detection job",optional:!0}},filter_field:{type:"text",_meta:{description:"Filter field for the anomaly detection job",optional:!0}}}}}},{eventType:V.ANOMALY_DETECTION_DATE_FIELD_CHANGE,schema:{job_type:{type:"text",_meta:{description:"Type of job for the anomaly detection"}},start_date:{type:"text",_meta:{description:"Start date for the anomaly detection job"}}}},{eventType:V.ANOMALY_DETECTION_PARTITION_FIELD_CHANGE,schema:{job_type:{type:"text",_meta:{description:"Type of job for the anomaly detection"}},partition_field:{type:"text",_meta:{description:"Partition field for the anomaly detection job",optional:!0}}}},{eventType:V.ANOMALY_DETECTION_FILTER_FIELD_CHANGE,schema:{job_type:{type:"text",_meta:{description:"Type of job for the anomaly detection"}},filter_field:{type:"text",_meta:{description:"Filter field for the anomaly detection job",optional:!0}}}}];class TelemetryService{constructor(e=null){this.analytics=e}setup({analytics:e}){this.analytics=e,Y.forEach((t=>e.registerEventType(t)))}start(){if(!this.analytics)throw new Error("The TelemetryService.setup() method has not been invoked, be sure to call it during the plugin setup.");return new TelemetryClient(this.analytics)}}var G=r(6764);function W(e){return async t=>{const[,{data:r,logsShared:a,share:i}]=await e(),s=await a.logViews.client.getResolvedLogView(G.DEFAULT_LOG_VIEW),{stats:n,series:o}=await async function(e,t,r){return new Promise(((a,i)=>{let s;r.search.search({params:{index:e.index,body:{size:0,query:z(0,t),aggs:Z(0,t)}}}).subscribe((e=>s=e.rawResponse),(e=>i(e)),(()=>{var e;null!==(e=s)&&void 0!==e&&e.aggregations?a(function(e){const t={},r={};return e.stats.buckets.forEach((e=>{const a=e.key;t[e.key]={type:"number",label:a,value:e.doc_count},e.series.buckets.forEach((e=>{r[a]=r[a]||{label:a,coordinates:[]},r[a].coordinates.push({x:e.key,y:e.doc_count})}))})),{stats:t,series:r}}(s.aggregations)):a({stats:{},series:{}})}))}))}({index:s.indices},t,r),l=(0,G.getLogsLocatorFromUrlService)(i.url),c=(t.absoluteTime.end-t.absoluteTime.start)/6e4;return{appLink:l.getRedirectUrl({timeRange:{from:m()(t.absoluteTime.start).toISOString(),to:m()(t.absoluteTime.end).toISOString()}}),stats:J(n,c),series:X(o)}}}function z(e,t){return{range:{[T.WK]:{gt:new Date(t.absoluteTime.start).toISOString(),lte:new Date(t.absoluteTime.end).toISOString(),format:"strict_date_optional_time"}}}}function Z(e,t){return{stats:{terms:{field:"event.dataset",size:4,missing:"unknown"},aggs:{series:{date_histogram:{field:T.WK,fixed_interval:t.intervalString}}}}}}function J(e,t){return Object.keys(e).reduce(((r,a)=>(r[a]={...e[a],value:e[a].value/t},r)),{})}function X(e){const t=Object.keys(e),r=t.flatMap((t=>e[t].coordinates.map((e=>e.x)))),[a,i]=[...new Set(r)].sort(),s=(i-a)/6e4;return t.reduce(((t,r)=>(t[r]={...e[r],coordinates:e[r].coordinates.map((e=>e.y?{...e,y:e.y/s}:e))},t)),{})}var ee=r(7808),te=r(6899);class Plugin{constructor(e){(0,a.default)(this,"config",void 0),(0,a.default)(this,"inventoryViews",void 0),(0,a.default)(this,"metricsExplorerViews",void 0),(0,a.default)(this,"telemetry",void 0),(0,a.default)(this,"kibanaVersion",void 0),(0,a.default)(this,"isServerlessEnv",void 0),(0,a.default)(this,"appUpdater$",new o.BehaviorSubject((()=>({})))),this.config=e.config.get(),this.inventoryViews=new InventoryViewsService,this.metricsExplorerViews=this.config.featureFlags.metricsExplorerEnabled?new MetricsExplorerViewsService:void 0,this.telemetry=new TelemetryService,this.kibanaVersion=e.env.packageInfo.version,this.isServerlessEnv="serverless"===e.env.packageInfo.buildFlavor}setup(e,t){var a,p,h;t.home&&t.home.featureCatalogue.register({id:"metrics",title:s.i18n.translate("xpack.infra.registerFeatures.infraOpsTitle",{defaultMessage:"Metrics"}),description:s.i18n.translate("xpack.infra.registerFeatures.infraOpsDescription",{defaultMessage:"Explore infrastructure metrics and logs for common servers, containers, and services."}),icon:"metricsApp",path:"/app/metrics",showOnHomePage:!1,category:"data"});const g=t.share.url.locators.get(n.ASSET_DETAILS_LOCATOR_ID),m=t.share.url.locators.get(n.INVENTORY_LOCATOR_ID),f=t.share.url.locators.get(n.METRICS_EXPLORER_LOCATOR_ID);var y;t.observability.observabilityRuleTypeRegistry.register(function({assetDetailsLocator:e,inventoryLocator:t}){const a=(({assetDetailsLocator:e,inventoryLocator:t})=>({fields:r})=>{var a;return{reason:null!==(a=r[_.at])&&void 0!==a?a:"-",link:D({fields:r,assetDetailsLocator:e,inventoryLocator:t}),hasBasePath:!0}})({assetDetailsLocator:e,inventoryLocator:t});return{id:d.Yj,description:s.i18n.translate("xpack.infra.metrics.inventory.alertFlyout.alertDescription",{defaultMessage:"Alert when the inventory exceeds a defined threshold."}),iconClass:"bell",documentationUrl:e=>`${e.links.observability.infrastructureThreshold}`,ruleParamsExpression:c().lazy((()=>Promise.all([r.e(94),r.e(133),r.e(505),r.e(602),r.e(729)]).then(r.bind(r,1729)))),validate:u,defaultActionMessage:x,defaultRecoveryMessage:k,requiresAppContext:!1,format:a,priority:20}}({assetDetailsLocator:g,inventoryLocator:m})),t.observability.observabilityRuleTypeRegistry.register(function({assetDetailsLocator:e,metricsExplorerLocator:t}){return{id:d.lN,description:s.i18n.translate("xpack.infra.metrics.alertFlyout.alertDescription",{defaultMessage:"Alert when the metrics aggregation exceeds the threshold."}),iconClass:"bell",documentationUrl:e=>`${e.links.observability.metricsThreshold}`,ruleParamsExpression:(0,l.lazy)((()=>Promise.all([r.e(94),r.e(133),r.e(505),r.e(974)]).then(r.bind(r,974)))),validate:L,defaultActionMessage:P,defaultRecoveryMessage:F,requiresAppContext:!1,format:I({assetDetailsLocator:e,metricsExplorerLocator:t}),alertDetailsAppSection:(0,l.lazy)((()=>Promise.all([r.e(505),r.e(249)]).then(r.bind(r,6249)))),priority:10}}({assetDetailsLocator:g,metricsExplorerLocator:f})),this.config.featureFlags.logsUIEnabled&&t.observability.dashboard.register({appName:"infra_logs",hasData:(y=e.getStartServices,async()=>{const[,{logsShared:e}]=await y(),t=await e.logViews.client.getResolvedLogView(G.DEFAULT_LOG_VIEW);return{hasData:"available"===(await e.logViews.client.getResolvedLogViewStatus(t)).index,indices:t.indices}}),fetchData:W(e.getStartServices)}),t.observability.dashboard.register({appName:"infra_metrics",hasData:N(e.getStartServices),fetchData:U(e.getStartServices)}),t.logsShared.logViews.setLogViewsStaticConfig({messageFields:null===(a=this.config.sources)||void 0===a||null===(p=a.default)||void 0===p||null===(h=p.fields)||void 0===h?void 0:h.message});const b=(0,o.from)(e.getStartServices()).pipe((0,o.switchMap)((([{application:e}])=>(0,o.combineLatest)([(0,o.of)(e),ae(e)])))),T=(0,te.V)();t.observabilityShared.navigation.registerSections(b.pipe((0,o.map)((([e,t])=>{const{infrastructure:r,logs:a}=e.capabilities;return[...a.show?[{label:ee.U7,sortKey:200,entries:re({isLogsExplorerAccessible:t,config:this.config,routes:T})}]:[],...r.show?[{label:ee.c1,sortKey:300,entries:[{label:ee.dd,app:"metrics",path:"/inventory"},...this.config.featureFlags.metricsExplorerEnabled?[{label:ee.jv,app:"metrics",path:"/explorer"}]:[],{label:ee.S$,app:"metrics",path:"/hosts"}]}]:[]]})))),t.embeddable.registerReactEmbeddableFactory(j.i,(async()=>{const{getLogStreamEmbeddableFactory:t}=await Promise.all([r.e(94),r.e(144)]).then(r.bind(r,144)),[a,i,s]=await e.getStartServices();return t({coreStart:a,pluginDeps:i,pluginStart:s})})),t.observability.observabilityRuleTypeRegistry.register((0,M.Y)(e,t.share.url)),this.config.featureFlags.logsUIEnabled&&e.application.register({id:"logs",title:s.i18n.translate("xpack.infra.logs.pluginTitle",{defaultMessage:"Logs"}),euiIconType:"logoObservability",order:8100,appRoute:"/app/logs",deepLinks:Object.values(T),category:i.DEFAULT_APP_CATEGORIES.observability,mount:async t=>{const[a,i,s]=await e.getStartServices(),n=await(0,o.firstValueFrom)(ae(a.application)),{renderApp:l}=await Promise.all([r.e(94),r.e(133),r.e(440),r.e(429)]).then(r.bind(r,4409));return l(a,i,s,n,t)}});const v=({metricsExplorerEnabled:e})=>{const t=["globalSearch"];return[{id:"inventory",title:ee.dd,path:"/inventory",visibleIn:t},{id:"hosts",title:s.i18n.translate("xpack.infra.homePage.metricsHostsTabTitle",{defaultMessage:"Hosts"}),path:"/hosts",visibleIn:t},...e?[{id:"metrics-explorer",title:s.i18n.translate("xpack.infra.homePage.metricsExplorerTabTitle",{defaultMessage:"Metrics Explorer"}),path:"/explorer"}]:[],{id:"settings",title:s.i18n.translate("xpack.infra.homePage.settingsTabTitle",{defaultMessage:"Settings"}),path:"/settings"},{id:"assetDetails",title:"",path:"/detail",visibleIn:[]}]};return e.application.register({id:"metrics",title:s.i18n.translate("xpack.infra.metrics.pluginTitle",{defaultMessage:"Infrastructure"}),euiIconType:"logoObservability",order:8200,appRoute:"/app/metrics",category:i.DEFAULT_APP_CATEGORIES.observability,updater$:this.appUpdater$,deepLinks:v({metricsExplorerEnabled:this.config.featureFlags.metricsExplorerEnabled}),mount:async a=>{var i,s;const[n,o,l]=await e.getStartServices(),{renderApp:c}=await Promise.all([r.e(94),r.e(133),r.e(310),r.e(505),r.e(238),r.e(440),r.e(599)]).then(r.bind(r,3599)),d=!(null===(i=t.cloud)||void 0===i||!i.isCloudEnabled),p=(null===(s=t.cloud)||void 0===s?void 0:s.isServerlessEnabled)||this.isServerlessEnv;return c(n,{...o,licenseManagement:t.licenseManagement},l,this.config,a,{kibanaVersion:this.kibanaVersion,isCloudEnv:d,isServerlessEnv:p})}}),b.subscribe((([e,t])=>{this.appUpdater$.next((()=>({deepLinks:v({metricsExplorerEnabled:this.config.featureFlags.metricsExplorerEnabled})})))})),this.telemetry.setup({analytics:e.analytics}),{}}start(e,t){var r;const{http:a}=e;return{inventoryViews:this.inventoryViews.start({http:a}),metricsExplorerViews:null===(r=this.metricsExplorerViews)||void 0===r?void 0:r.start({http:a}),telemetry:this.telemetry.start()}}stop(){}}const re=({isLogsExplorerAccessible:e,config:t,routes:r})=>{const a=[];return t.featureFlags.logsUIEnabled?(e&&a.push({label:"Discover",app:"observability-logs-explorer",path:"/"}),a.push(ie(r.logsAnomalies)),a.push(ie(r.logsCategories)),a):a},ae=e=>{const{applications$:t}=e;return t.pipe((0,o.map)((e=>{var t,r;return(null!==(t=null===(r=e.get("observability-logs-explorer"))||void 0===r?void 0:r.status)&&void 0!==t?t:i.AppStatus.inaccessible)===i.AppStatus.accessible})),(0,o.distinctUntilChanged)())},ie=({path:e,title:t})=>({app:"logs",label:t,path:e}),se=e=>new Plugin(e)},6899:(e,t,r)=>{"use strict";r.d(t,{V:()=>i});var a=r(7808);const i=()=>({logsAnomalies:{id:"anomalies",title:a.$s,path:"/anomalies"},logsCategories:{id:"log-categories",title:a.LJ,path:"/log-categories"}})},7808:(e,t,r)=>{"use strict";r.d(t,{$s:()=>n,JU:()=>h,LJ:()=>o,S$:()=>u,U7:()=>s,c1:()=>c,dd:()=>d,jv:()=>p,m_:()=>i,uj:()=>l});var a=r(5008);const i=a.i18n.translate("xpack.infra.header.observabilityTitle",{defaultMessage:"Observability"}),s=a.i18n.translate("xpack.infra.header.logsTitle",{defaultMessage:"Logs"}),n=a.i18n.translate("xpack.infra.logs.index.anomaliesTabTitle",{defaultMessage:"Logs Anomalies"}),o=a.i18n.translate("xpack.infra.logs.index.logCategoriesBetaBadgeTitle",{defaultMessage:"Logs Categories"}),l=a.i18n.translate("xpack.infra.logs.index.settingsTabTitle",{defaultMessage:"Settings"}),c=a.i18n.translate("xpack.infra.header.infrastructureTitle",{defaultMessage:"Infrastructure"}),d=a.i18n.translate("xpack.infra.metrics.infrastructureInventoryTitle",{defaultMessage:"Infrastructure Inventory"}),p=a.i18n.translate("xpack.infra.metrics.metricsExplorerTitle",{defaultMessage:"Metrics Explorer"}),u=a.i18n.translate("xpack.infra.metrics.hostsTitle",{defaultMessage:"Hosts"}),h=a.i18n.translate("xpack.infra.metricDetailPage.documentTitleError",{defaultMessage:"Uh oh"})},9209:(e,t,r)=>{r.p=window.__kbnPublicPath__.infra},511:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/aiops/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},5240:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/charts/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},2677:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/controls/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},4390:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("entry/core/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},3961:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/dashboard/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},7195:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},4627:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},7546:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},2137:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/kibanaReact/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},409:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},1359:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/kibanaUtils/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},1215:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},2298:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/licenseManagement/common/constants");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},9414:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/logsDataAccess/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},6764:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/logsShared/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},1952:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/logsShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},1474:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/metricsDataAccess/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},5902:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/metricsDataAccess/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},636:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/ml/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},5170:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/observability/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},3838:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/observability/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},3780:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/observabilityShared/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},6808:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/observabilityShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},3073:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/triggersActionsUi/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},1684:(e,t,r)=>{r.r(t);var a=__kbnBundles__.get("plugin/unifiedSearch/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},8915:(e,t,r)=>{e.exports=r(2497)(67493)},5927:e=>{"use strict";e.exports=__kbnSharedDeps__.Classnames},3059:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticCharts},1319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},6752:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticNumeral},6791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},3782:e=>{"use strict";e.exports=__kbnSharedDeps__.IoTs},9424:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnCodeEditor},6494:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnDatemath},1192:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnEbtTools},5964:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnEsQuery},1991:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnEsqlAst},5008:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},5879:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18nReact},911:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnMonaco},482:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnReactKibanaContextRender},5995:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnRison},1728:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnSharedUxErrorBoundary},193:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnSharedUxRouter},3803:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnUiTheme},770:e=>{"use strict";e.exports=__kbnSharedDeps__.Lodash},1060:e=>{"use strict";e.exports=__kbnSharedDeps__.LodashFp},1783:e=>{"use strict";e.exports=__kbnSharedDeps__.Moment},2488:e=>{"use strict";e.exports=__kbnSharedDeps__.MomentTimezone},4286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},2874:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactDom},3530:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactQuery},5692:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactQueryDevtools},1493:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactRouterDom},190:e=>{"use strict";e.exports=__kbnSharedDeps__.Rxjs},5079:e=>{"use strict";e.exports=__kbnSharedDeps__.SaferLodashSet},1941:e=>{"use strict";e.exports=__kbnSharedDeps__.TsLib},9472:e=>{"use strict";e.exports=__kbnSharedDeps__.Uuid},2497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={id:e,loaded:!1,exports:{}};return a[e].call(r.exports,r,r.exports,s),r.loaded=!0,r.exports}s.m=a,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"==typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"==typeof r.then)return r}var i=Object.create(null);s.r(i);var n={};e=e||[null,t({}),t([]),t(t)];for(var o=2&a&&r;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>n[e]=()=>r[e]));return n.default=()=>r,s.d(i,n),i},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,r)=>(s.f[r](e,t),t)),[])),s.u=e=>"infra.chunk."+e+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},s.l=(e,t,a,i)=>{if(r[e])r[e].push(t);else{var n,o;if(void 0!==a)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==e){n=d;break}}n||(o=!0,(n=document.createElement("script")).charset="utf-8",n.timeout=120,s.nc&&n.setAttribute("nonce",s.nc),n.src=e),r[e]=[t];var p=(t,a)=>{n.onerror=n.onload=null,clearTimeout(u);var i=r[e];if(delete r[e],n.parentNode&&n.parentNode.removeChild(n),i&&i.forEach((e=>e(a))),t)return t(a)},u=setTimeout(p.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=p.bind(null,n.onerror),n.onload=p.bind(null,n.onload),o&&document.head.appendChild(n)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={895:0};s.f.j=(t,r)=>{var a=s.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise(((r,i)=>a=e[t]=[r,i]));r.push(a[2]=i);var n=s.p+s.u(t),o=new Error;s.l(n,(r=>{if(s.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),n=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+n+")",o.name="ChunkLoadError",o.type=i,o.request=n,a[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var a,i,[n,o,l]=r,c=0;if(n.some((t=>0!==e[t]))){for(a in o)s.o(o,a)&&(s.m[a]=o[a]);l&&l(s)}for(t&&t(r);c<n.length;c++)i=n[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.infra_bundle_jsonpfunction=self.infra_bundle_jsonpfunction||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),s(9209),__kbnBundles__.define("plugin/infra/public",s,2739)})();