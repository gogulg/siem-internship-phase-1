(()=>{var e,t={909:(e,t,r)=>{"use strict";r.r(t),r.d(t,{plugin:()=>_});var n=r(215),o=r(8),s=r(634),i=r(212);const a="legacyMetricVis",l="bottom",c=()=>({name:a,type:"render",inputTypes:["datatable"],help:o.i18n.translate("expressionLegacyMetricVis.function.help",{defaultMessage:"Metric visualization"}),args:{autoScaleMetricAlignment:{types:["string"],help:o.i18n.translate("expressionLegacyMetricVis.function.autoScaleMetricAlignment.help",{defaultMessage:"Metric alignment after scaled"}),required:!1},percentageMode:{types:["boolean"],default:!1,help:o.i18n.translate("expressionLegacyMetricVis.function.percentageMode.help",{defaultMessage:"Shows metric in percentage mode. Requires colorRange to be set."})},colorMode:{types:["string"],default:`"${i.ColorMode.None}"`,options:[i.ColorMode.None,i.ColorMode.Labels,i.ColorMode.Background],help:o.i18n.translate("expressionLegacyMetricVis.function.colorMode.help",{defaultMessage:"Which part of metric to color"}),strict:!0},colorFullBackground:{types:["boolean"],default:!1,help:o.i18n.translate("expressionLegacyMetricVis.function.colorFullBackground.help",{defaultMessage:"Applies the selected background color to the full visualization container"})},palette:{types:["palette"],help:o.i18n.translate("expressionLegacyMetricVis.function.palette.help",{defaultMessage:"Provides colors for the values, based on the bounds."})},showLabels:{types:["boolean"],default:!0,help:o.i18n.translate("expressionLegacyMetricVis.function.showLabels.help",{defaultMessage:"Shows labels under the metric values."})},font:{types:["style"],help:o.i18n.translate("expressionLegacyMetricVis.function.font.help",{defaultMessage:"Font settings."}),default:'{font size=60 align="center"}'},labelFont:{types:["style"],help:o.i18n.translate("expressionLegacyMetricVis.function.labelFont.help",{defaultMessage:"Label font settings."}),default:'{font size=24 align="center"}'},labelPosition:{types:["string"],options:[l,"top"],help:o.i18n.translate("expressionLegacyMetricVis.function.labelPosition.help",{defaultMessage:"Label position"}),default:l,strict:!0},metric:{types:["string","vis_dimension"],help:o.i18n.translate("expressionLegacyMetricVis.function.metric.help",{defaultMessage:"metric dimension configuration"}),required:!0,multi:!0},bucket:{types:["string","vis_dimension"],help:o.i18n.translate("expressionLegacyMetricVis.function.bucket.help",{defaultMessage:"bucket dimension configuration"})},autoScale:{types:["boolean"],help:o.i18n.translate("expressionLegacyMetricVis.function.autoScale.help",{defaultMessage:"Enable auto scale"}),required:!1}},fn(e,t,r){var n,l,c,u;if(t.percentageMode&&(null===(n=t.palette)||void 0===n||!n.params))throw new Error("Palette must be provided when using percentageMode");if(t.colorFullBackground&&t.bucket)throw new Error(o.i18n.translate("expressionLegacyMetricVis.function.errors.splitByBucketAndColorFullBackgroundSpecified",{defaultMessage:"Full background coloring cannot be applied to visualizations that have a bucket specified."}));if(t.metric.forEach((t=>(0,s.validateAccessor)(t,e.columns))),(0,s.validateAccessor)(t.bucket,e.columns),null!=r&&null!==(l=r.inspectorAdapters)&&void 0!==l&&l.tables){r.inspectorAdapters.tables.reset(),r.inspectorAdapters.tables.allowCsvExport=!0;const n=[[t.metric,o.i18n.translate("expressionLegacyMetricVis.function.dimension.metric",{defaultMessage:"Metric"})]];t.bucket&&n.push([[t.bucket],o.i18n.translate("expressionLegacyMetricVis.function.dimension.splitGroup",{defaultMessage:"Split group"})]);const i=(0,s.prepareLogTable)(e,n,!0);r.inspectorAdapters.tables.logDatatable("default",i)}return{type:"render",as:a,value:{visData:e,visType:"metric",visConfig:{metric:{...t.autoScaleMetricAlignment?{autoScaleMetricAlignment:t.autoScaleMetricAlignment}:{},palette:null===(c=t.palette)||void 0===c?void 0:c.params,percentageMode:t.percentageMode,metricColorMode:t.colorMode,labels:{show:t.showLabels,position:t.labelPosition,style:{...t.labelFont}},colorFullBackground:!(t.metric.length>1||e.rows.length>1)&&t.colorFullBackground,style:{bgColor:t.colorMode===i.ColorMode.Background,labelColor:t.colorMode===i.ColorMode.Labels,...t.font},autoScale:t.autoScale},dimensions:{metrics:t.metric,...t.bucket?{bucket:t.bucket}:{}}},canNavigateToLens:Boolean(null==r||null===(u=r.variables)||void 0===u?void 0:u.canNavigateToLens)}}}});var u=r(209),p=r(286);const d=__kbnSharedDeps__.ReactDom,g=__kbnSharedDeps__.KbnAnalytics,f=__kbnSharedDeps__.KbnReactKibanaContextRender;var b=r(500);r(195);var h=r(791);const m=(0,p.lazy)((()=>r.e(59).then(r.bind(r,59)))),v={name:"17ub53d",styles:"height:100%;width:100%;display:flex;flex-direction:row;justify-content:center;align-items:center;flex-wrap:wrap;overflow:auto"};class ExpressionLegacyMetricPlugin{setup(e,{expressions:t,charts:r}){const o=(0,n.createStartServicesGetter)(e.getStartServices);r.palettes.getPalettes().then((e=>{(0,u.zx)(e)})),t.registerFunction(c),t.registerRenderer((({getStartDeps:e})=>({name:a,displayName:"metric visualization",reuseDomNode:!0,render:async(t,{visData:r,visConfig:n,canNavigateToLens:o},i)=>{var a;const{core:l,plugins:c}=e();i.onDestroy((()=>{(0,d.unmountComponentAtNode)(t)}));const u=await async function(e,t,r){return Promise.all(e.metrics.map((async e=>{var n;const o=(0,s.getColumnByAccessor)(e,t.columns),i=t.columns.indexOf(o);return Boolean(await(null===(n=r.hasCompatibleActions)||void 0===n?void 0:n.call(r,{name:"filter",data:{data:[{table:t,column:i,row:0}]}})))})))}(n.dimensions,r,i),p=()=>{const e=i.getExecutionContext(),t=(e=>{if(e){var t;const r=e=>e.type?e:e.child?r(e.child):void 0;return null===(t=r(e))||void 0===t?void 0:t.type}})(e),r=(e=>{if(e){var t;const r=e=>e.child?r(e.child):e;return null===(t=r(e))||void 0===t?void 0:t.type}})(e);if(t&&r){var n;const e=[`render_${r}_legacy_metric`,o?`render_${r}_legacy_metric_convertable`:void 0].filter((e=>Boolean(e)));null===(n=c.usageCollection)||void 0===n||n.reportUiCounter(t,g.METRIC_TYPE.COUNT,e)}i.done()};i.event({name:"chartSize",data:{maxDimensions:{x:{value:100,unit:"percentage"},y:{value:100,unit:"percentage"}}}}),(0,d.render)((0,h.jsx)(f.KibanaRenderContextProvider,l,(0,h.jsx)(b.VisualizationContainer,{"data-test-subj":"legacyMtrVis",className:"eui-scrollBar legacyMtrVis",showNoResult:!(null!==(a=r.rows)&&void 0!==a&&a.length),renderComplete:p,handlers:i,css:v},(0,h.jsx)(m,{visData:r,visParams:n,renderComplete:p,fireEvent:i.event,filterable:u}))),t)}}))({getStartDeps:o}))}start(e,{fieldFormats:t}){(0,u.hX)(t)}}function _(){return new ExpressionLegacyMetricPlugin}},209:(e,t,r)=>{"use strict";r.d(t,{tz:()=>o,hS:()=>i,hX:()=>s,zx:()=>a});var n=r(215);const[o,s]=(0,n.createGetterSetter)("fieldFormats"),[i,a]=(0,n.createGetterSetter)("palette")},782:(e,t,r)=>{r.p=window.__kbnPublicPath__.expressionLegacyMetricVis},212:(e,t,r)=>{r.r(t);var n=__kbnBundles__.get("plugin/charts/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},195:(e,t,r)=>{r.r(t);var n=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},215:(e,t,r)=>{r.r(t);var n=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},634:(e,t,r)=>{r.r(t);var n=__kbnBundles__.get("plugin/visualizations/common/utils");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},500:(e,t,r)=>{r.r(t);var n=__kbnBundles__.get("plugin/visualizations/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},927:e=>{"use strict";e.exports=__kbnSharedDeps__.Classnames},319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},8:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},803:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnUiTheme},770:e=>{"use strict";e.exports=__kbnSharedDeps__.Lodash},286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var s=r[e]={exports:{}};return t[e](s,s.exports,n),s.exports}n.m=t,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"expressionLegacyMetricVis.chunk."+e+".js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},n.l=(t,r,o,s)=>{if(e[t])e[t].push(r);else{var i,a;if(void 0!==o)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var u=l[c];if(u.getAttribute("src")==t){i=u;break}}i||(a=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,n.nc&&i.setAttribute("nonce",n.nc),i.src=t),e[t]=[r];var p=(r,n)=>{i.onerror=i.onload=null,clearTimeout(d);var o=e[t];if(delete e[t],i.parentNode&&i.parentNode.removeChild(i),o&&o.forEach((e=>e(n))),r)return r(n)},d=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),a&&document.head.appendChild(i)}},n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={330:0};n.f.j=(t,r)=>{var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var s=new Promise(((r,n)=>o=e[t]=[r,n]));r.push(o[2]=s);var i=n.p+n.u(t),a=new Error;n.l(i,(r=>{if(n.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var s=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",a.name="ChunkLoadError",a.type=s,a.request=i,o[1](a)}}),"chunk-"+t,t)}};var t=(t,r)=>{var o,s,[i,a,l]=r,c=0;if(i.some((t=>0!==e[t]))){for(o in a)n.o(a,o)&&(n.m[o]=a[o]);l&&l(n)}for(t&&t(r);c<i.length;c++)s=i[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.expressionLegacyMetricVis_bundle_jsonpfunction=self.expressionLegacyMetricVis_bundle_jsonpfunction||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),n(782),__kbnBundles__.define("plugin/expressionLegacyMetricVis/public",n,909)})();