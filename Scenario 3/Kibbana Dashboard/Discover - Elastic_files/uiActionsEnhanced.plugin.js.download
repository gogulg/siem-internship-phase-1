(()=>{var e,t={4294:(e,t,i)=>{"use strict";i.d(t,{H:()=>a,O:()=>c});var n=i(4286),s=i(6791);const r=n.lazy((()=>i.e(928).then(i.bind(i,7928)).then((({UrlDrilldownCollectConfig:e})=>({default:e}))))),a=e=>(0,s.jsx)(n.Suspense,{fallback:null},(0,s.jsx)(r,e)),o=n.lazy((()=>i.e(104).then(i.bind(i,5104)).then((({UrlDrilldownOptionsComponent:e})=>({default:e}))))),c=e=>(0,s.jsx)(n.Suspense,{fallback:null},(0,s.jsx)(o,e))},4712:(e,t,i)=>{"use strict";i.d(t,{h:()=>n});const n={encodeUrl:!0,openInNewTab:!0}},1713:(e,t,i)=>{"use strict";async function n(e,t,n=!0){const{handlebars:s}=await Promise.all([i.e(334),i.e(361)]).then(i.bind(i,1361)),{compileFnName:r}=await i.e(334).then(i.bind(i,3334));let a=s[r](e,{strict:!0,noEscape:!0})(t);return n&&(a=encodeURI(a)),a}i.d(t,{w:()=>n})},1876:(e,t,i)=>{"use strict";i.d(t,{s:()=>l,w:()=>c});var n=i(5008),s=i(1713);const r=n.i18n.translate("uiActionsEnhanced.drilldowns.urlDrilldownValidation.urlFormatGeneralErrorMessage",{defaultMessage:"Invalid URL format."}),a=e=>n.i18n.translate("uiActionsEnhanced.drilldowns.urlDrilldownValidation.urlCompileErrorMessage",{defaultMessage:"The URL template is not valid in the given context. {message}.",values:{message:e.replaceAll("[object Object]","context")}}),o=/^(?:(?:https?|mailto):|[^&:/?#]*(?:[/?#]|$))/gi;function c(e){if(!e)return{isValid:!1,error:r};try{if(new URL(e),!e.match(o))throw new Error;return{isValid:!0}}catch(t){return{isValid:!1,error:r,invalidUrl:e}}}async function l(e,t){if(!e.template)return{isValid:!1,error:r};let i;try{i=await(0,s.w)(e.template,t)}catch(t){return{isValid:!1,error:a(t.message),invalidUrl:e.template}}try{return c(i)}catch(e){return{isValid:!1,error:r+` ${e.message}.`,invalidUrl:i}}}},7374:(e,t,i)=>{"use strict";i.r(t),i.d(t,{DEFAULT_URL_DRILLDOWN_OPTIONS:()=>b.h,Plugin:()=>AdvancedUiActionsPublicPlugin,UiActionsEnhancedAbstractActionStorage:()=>AbstractActionStorage,UiActionsEnhancedActionFactory:()=>ActionFactory,UiActionsEnhancedDynamicActionManager:()=>DynamicActionManager,UiActionsEnhancedMemoryActionStorage:()=>MemoryActionStorage,UrlDrilldownCollectConfig:()=>w.H,UrlDrilldownOptionsComponent:()=>w.O,plugin:()=>F,urlDrilldownCompileUrl:()=>_.w,urlDrilldownGlobalScopeProvider:()=>E,urlDrilldownValidateUrl:()=>A.w,urlDrilldownValidateUrlTemplate:()=>A.s});var n=i(8915),s=i(190),r=i(1215),a=i(4286),o=i(3721);class ActionFactory{constructor(e,t){var i;if((0,n.default)(this,"id",void 0),(0,n.default)(this,"isBeta",void 0),(0,n.default)(this,"minimalLicense",void 0),(0,n.default)(this,"licenseFeatureName",void 0),(0,n.default)(this,"order",void 0),(0,n.default)(this,"MenuItem",void 0),(0,n.default)(this,"CollectConfig",void 0),(0,n.default)(this,"createConfig",void 0),(0,n.default)(this,"isConfigValid",void 0),(0,n.default)(this,"migrations",void 0),this.def=e,this.deps=t,e.minimalLicense&&!e.licenseFeatureName)throw new Error(`ActionFactory [actionFactory.id = ${e.id}] "licenseFeatureName" is required, if "minimalLicense" is provided`);this.id=this.def.id,this.isBeta=null!==(i=this.def.isBeta)&&void 0!==i&&i,this.minimalLicense=this.def.minimalLicense,this.licenseFeatureName=this.def.licenseFeatureName,this.order=this.def.order||0,this.MenuItem=this.def.MenuItem,this.CollectConfig=this.def.CollectConfig,this.createConfig=this.def.createConfig,this.isConfigValid=this.def.isConfigValid,this.migrations=this.def.migrations||{}}getIconType(e){if(this.def.getIconType)return this.def.getIconType(e)}getDisplayName(e){return this.def.getDisplayName?this.def.getDisplayName(e):""}getDisplayNameTooltip(e){return""}async isCompatible(e){return!this.def.isCompatible||await this.def.isCompatible(e)}isCompatibleLicense(){if(!this.minimalLicense||!this.deps.getLicense)return!0;const e=this.deps.getLicense();return e.isAvailable&&e.isActive&&e.hasAtLeast(this.minimalLicense)}create(e){const t=this.def.create(e);return{...t,isCompatible:async e=>!!this.isCompatibleLicense()&&(!t.isCompatible||t.isCompatible(e)),execute:async e=>(this.notifyFeatureUsage(),t.execute(e))}}supportedTriggers(){return this.def.supportedTriggers()}notifyFeatureUsage(){if(!this.minimalLicense||!this.licenseFeatureName||!this.deps.getFeatureUsageStart)return;const e=this.deps.getFeatureUsageStart();e&&e.notifyUsage(this.licenseFeatureName).catch((()=>{o.warn(`ActionFactory [actionFactory.id = ${this.def.id}] fail notify feature usage.`)}))}telemetry(e,t){return this.def.telemetry?this.def.telemetry(e,t):t}extract(e){return this.def.extract?this.def.extract(e):{state:e,references:[]}}inject(e,t){return this.def.inject?this.def.inject(e,t):e}}class AbstractActionStorage{constructor(){(0,n.default)(this,"reload$",new s.Subject)}async count(){return(await this.list()).length}async read(e){const t=(await this.list()).find((t=>t.eventId===e));if(!t)throw new Error(`Event [eventId = ${e}] not found.`);return t}}class MemoryActionStorage extends AbstractActionStorage{constructor(e=[]){super(),this.events=e}async list(){return this.events.map((e=>({...e})))}async create(e){this.events=[...this.events,{...e}]}async update(e){const t=this.events.findIndex((({eventId:t})=>t===e.eventId));if(t<0)throw new Error(`Event [eventId = ${e.eventId}] not found`);this.events=[...this.events.slice(0,t),{...e},...this.events.slice(t+1)]}async remove(e){const t=this.events.findIndex((t=>e===t.eventId));if(t<0)throw new Error(`Event [eventId = ${e}] not found`);this.events=[...this.events.slice(0,t),...this.events.slice(t+1)]}}const c={isFetchingEvents:!1,fetchCount:0,events:[]},l={startFetching:e=>()=>({...e,isFetchingEvents:!0}),finishFetching:e=>t=>({...e,isFetchingEvents:!1,fetchCount:e.fetchCount+1,fetchError:void 0,events:t}),failFetching:e=>({message:t})=>({...e,isFetchingEvents:!1,fetchCount:e.fetchCount+1,fetchError:{message:t}}),addEvent:e=>t=>({...e,events:[...e.events,t]}),removeEvent:e=>t=>({...e,events:e.events?e.events.filter((e=>e.eventId!==t)):e.events}),replaceEvent:e=>t=>{const i=e.events.findIndex((({eventId:e})=>e===t.eventId));return-1===i?e:{...e,events:[...e.events.slice(0,i),t,...e.events.slice(i+1)]}}},d={getEvent:e=>t=>e.events.find((e=>e.eventId===t))||null};var u=i(1359);const h=__kbnSharedDeps__.Uuid;var f=i(5008);const g=[{id:"dynamicActions",getDisplayName:()=>f.i18n.translate("uiActionsEnhanced.CustomActions",{defaultMessage:"Custom actions"}),getIconType:()=>"symlink",order:0}];var p=i(3721);class DynamicActionManager{constructor(e){(0,n.default)(this,"idPrefix",`D_ACTION_${DynamicActionManager.idPrefixCounter++}_`),(0,n.default)(this,"stopped",!1),(0,n.default)(this,"reloadSubscription",void 0),(0,n.default)(this,"ui",(0,u.createStateContainer)(c,l,d)),(0,n.default)(this,"syncId",0),(0,n.default)(this,"onSync",(()=>{this.stopped||(async()=>{const e=++this.syncId,t=await this.params.storage.list();if(!this.stopped&&e===this.syncId&&!((e,t)=>{if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i].eventId!==t[i].eventId)return!1;return!0})(t,this.ui.get().events)){for(const e of this.ui.get().events)this.killAction(e);for(const e of t)this.reviveAction(e);this.ui.transitions.finishFetching(t)}})().catch((e=>{p.log("Dynamic action manager storage reload failed."),p.error(e)}))})),(0,n.default)(this,"state",this.ui),this.params=e}getEvent(e){const t=this.ui.selectors.getEvent(e);if(!t)throw new Error(`Could not find event [eventId = ${e}].`);return t}generateActionId(e){return this.idPrefix+e}reviveAction(e){const{eventId:t,triggers:i,action:n}=e,{uiActions:s,isCompatible:r}=this.params,a=this.generateActionId(t);if(!s.hasActionFactory(n.factoryId))return void p.warn(`Action factory for action [action.factoryId = ${n.factoryId}] doesn't exist. Skipping action [action.name = ${n.name}] revive.`);const o=s.getActionFactory(e.action.factoryId),c=o.create(n);s.registerAction({...c,id:a,grouping:g,isCompatible:async e=>!!await r(e)&&(!c.isCompatible||c.isCompatible(e))});const l=o.supportedTriggers();for(const e of i){if(!l.includes(e))throw new Error(`Can't attach [action=${a}] to [trigger=${e}]. Supported triggers for this action: ${l.join(",")}`);s.attachAction(e,a)}}killAction({eventId:e,triggers:t}){const{uiActions:i}=this.params,n=this.generateActionId(e);if(i.hasAction(n)){for(const e of t)i.detachAction(e,n);i.unregisterAction(n)}}async start(){if(!this.stopped&&!this.ui.get().isFetchingEvents){this.ui.transitions.startFetching();try{const e=await this.params.storage.list();for(const t of e)this.reviveAction(t);this.ui.transitions.finishFetching(e)}catch(e){throw this.ui.transitions.failFetching(e instanceof Error?e:{message:String(e)}),e}this.params.storage.reload$&&(this.reloadSubscription=this.params.storage.reload$.subscribe(this.onSync))}}async stop(){this.stopped=!0;const e=await this.params.storage.list();for(const t of e)this.killAction(t);this.reloadSubscription&&this.reloadSubscription.unsubscribe()}async createEvent(e,t){if(!t.length)throw new Error("No triggers selected for event.");const i={eventId:(0,h.v4)(),triggers:t,action:e};this.ui.transitions.addEvent(i);try{await this.params.storage.create(i),this.reviveAction(i)}catch(e){throw this.ui.transitions.removeEvent(i.eventId),e}}async updateEvent(e,t,i){const n={eventId:e,triggers:i,action:t},s=this.getEvent(e);this.killAction(s),this.reviveAction(n),this.ui.transitions.replaceEvent(n);try{await this.params.storage.update(n)}catch(e){throw this.killAction(n),this.reviveAction(s),this.ui.transitions.replaceEvent(s),e}}async deleteEvent(e){const t=this.getEvent(e);this.killAction(t),this.ui.transitions.removeEvent(e);try{await this.params.storage.remove(e)}catch(e){throw this.reviveAction(t),this.ui.transitions.addEvent(t),e}}async deleteEvents(e){await Promise.all(e.map(this.deleteEvent.bind(this)))}}(0,n.default)(DynamicActionManager,"idPrefixCounter",0);class UiActionsServiceEnhancements{constructor({actionFactories:e=new Map,...t}){(0,n.default)(this,"actionFactories",void 0),(0,n.default)(this,"deps",void 0),(0,n.default)(this,"registerActionFactory",(e=>{if(this.actionFactories.has(e.id))throw new Error(`ActionFactory [actionFactory.id = ${e.id}] already registered.`);const t=new ActionFactory(e,this.deps);this.actionFactories.set(t.id,t),this.registerFeatureUsage(e)})),(0,n.default)(this,"getActionFactory",(e=>{const t=this.actionFactories.get(e);if(!t)throw new Error(`Action factory [actionFactoryId = ${e}] does not exist.`);return t})),(0,n.default)(this,"hasActionFactory",(e=>this.actionFactories.has(e))),(0,n.default)(this,"getActionFactories",(()=>[...this.actionFactories.values()])),(0,n.default)(this,"registerDrilldown",(({id:e,isBeta:t,order:i,CollectConfig:n,createConfig:s,isConfigValid:r,getDisplayName:o,actionMenuItem:c,euiIcon:l,execute:d,getHref:u,minimalLicense:h,licenseFeatureName:f,supportedTriggers:g,isCompatible:p,isConfigurable:v,telemetry:m,extract:y,inject:b})=>{const w={id:e,isBeta:t,minimalLicense:h,licenseFeatureName:f,order:i,CollectConfig:n,createConfig:s,isConfigValid:r,getDisplayName:o,supportedTriggers:g,telemetry:m,extract:y,inject:b,getIconType:()=>l,isCompatible:async e=>!v||v(e),create:t=>({id:"",type:e,getIconType:()=>l,getDisplayName:()=>t.name,MenuItem:c?({context:e})=>(0,a.createElement)(c,{context:e,config:t}):void 0,execute:async e=>await d(t.config,e),getHref:u?async e=>u(t.config,e):void 0,isCompatible:p?async e=>p(t.config,e):void 0})};this.registerActionFactory(w)})),(0,n.default)(this,"registerFeatureUsage",(e=>{e.minimalLicense&&e.licenseFeatureName&&this.deps.featureUsageSetup&&this.deps.featureUsageSetup.register(e.licenseFeatureName,e.minimalLicense)})),(0,n.default)(this,"telemetry",((e,t={})=>{let i=t;return e.events.forEach((e=>{this.actionFactories.has(e.action.factoryId)&&(i=this.actionFactories.get(e.action.factoryId).telemetry(e,i))})),i})),(0,n.default)(this,"extract",(e=>{const t=[];return{state:{events:e.events.map((e=>{const i=this.actionFactories.has(e.action.factoryId)?this.actionFactories.get(e.action.factoryId).extract(e):{state:e,references:[]};return t.push(...i.references),i.state}))},references:t}})),(0,n.default)(this,"inject",((e,t)=>({events:e.events.map((e=>this.actionFactories.has(e.action.factoryId)?this.actionFactories.get(e.action.factoryId).inject(e,t):e))}))),this.actionFactories=e,this.deps=t}}var v=i(3185),m=i(6791);const y=a.lazy((()=>i.e(527).then(i.bind(i,5527)).then((e=>({default:e.DrilldownManagerWithProvider})))));class AdvancedUiActionsPublicPlugin{getLicenseInfo(){if(!this.licenseInfo.getValue())throw new Error("AdvancedUiActionsPublicPlugin: License is not ready! License becomes available only after setup.");return this.licenseInfo.getValue()}constructor(e){(0,n.default)(this,"licenseInfo",new s.BehaviorSubject(void 0)),(0,n.default)(this,"enhancements",void 0),(0,n.default)(this,"subs",[])}setup(e,{embeddable:t,uiActions:i,licensing:n}){const s=(0,r.createStartServicesGetter)(e.getStartServices);var a;return this.enhancements=new UiActionsServiceEnhancements({getLicense:()=>this.getLicenseInfo(),featureUsageSetup:null==n?void 0:n.featureUsage,getFeatureUsageStart:()=>{var e;return null===(e=s().plugins.licensing)||void 0===e?void 0:e.featureUsage}}),t.registerEnhancement((a=this.enhancements,{id:"dynamicActions",telemetry:(e,t)=>a.telemetry(e,t),extract:e=>a.extract(e),inject:(e,t)=>a.inject(e,t)})),{...i,...this.enhancements}}start(e,{uiActions:t,licensing:i}){var n,s;return i&&this.subs.push(i.license$.subscribe(this.licenseInfo)),{...t,...this.enhancements,DrilldownManager:(s={actionFactories:this.enhancements.getActionFactories(),getTrigger:e=>t.getTrigger(e),storage:new r.Storage(null===(n=window)||void 0===n?void 0:n.localStorage),toastService:e.notifications.toasts,docsLink:e.docLinks.links.dashboard.drilldowns,triggerPickerDocsLink:e.docLinks.links.dashboard.drilldownsTriggerPicker},e=>{const t=s.actionFactories.filter((t=>{const i=t.supportedTriggers();for(const t of i)if(e.triggers.includes(t))return!0;return!1}));return(0,m.jsx)(a.Suspense,{fallback:null},(0,m.jsx)(y,(0,v.default)({},s,e,{actionFactories:t})))})}}stop(){this.subs.forEach((e=>e.unsubscribe()))}}var b=i(4712),w=i(4294),A=i(1876),_=i(1713);function E({core:e}){return()=>({kibanaUrl:window.location.origin+e.http.basePath.get()})}function F(e){return new AdvancedUiActionsPublicPlugin(e)}},5647:(e,t,i)=>{i.p=window.__kbnPublicPath__.uiActionsEnhanced},409:(e,t,i)=>{i.r(t);var n=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},1359:(e,t,i)=>{i.r(t);var n=__kbnBundles__.get("plugin/kibanaUtils/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},1215:(e,t,i)=>{i.r(t);var n=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},3721:(e,t,i)=>{e.exports=i(2497)(4971)},3185:(e,t,i)=>{e.exports=i(2497)(51858)},8915:(e,t,i)=>{e.exports=i(2497)(67493)},1319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},6752:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticNumeral},6791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},6494:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnDatemath},5008:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},5995:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnRison},1783:e=>{"use strict";e.exports=__kbnSharedDeps__.Moment},4286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},190:e=>{"use strict";e.exports=__kbnSharedDeps__.Rxjs},1941:e=>{"use strict";e.exports=__kbnSharedDeps__.TsLib},2497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},i={};function n(e){var s=i[e];if(void 0!==s)return s.exports;var r=i[e]={id:e,exports:{}};return t[e](r,r.exports,n),r.exports}n.m=t,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,i)=>(n.f[i](e,t),t)),[])),n.u=e=>"uiActionsEnhanced.chunk."+e+".js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},n.l=(t,i,s,r)=>{if(e[t])e[t].push(i);else{var a,o;if(void 0!==s)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var d=c[l];if(d.getAttribute("src")==t){a=d;break}}a||(o=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.src=t),e[t]=[i];var u=(i,n)=>{a.onerror=a.onload=null,clearTimeout(h);var s=e[t];if(delete e[t],a.parentNode&&a.parentNode.removeChild(a),s&&s.forEach((e=>e(n))),i)return i(n)},h=setTimeout(u.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=u.bind(null,a.onerror),a.onload=u.bind(null,a.onload),o&&document.head.appendChild(a)}},n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var s=i.length-1;s>-1&&(!e||!/^http(s?):/.test(e));)e=i[s--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={164:0};n.f.j=(t,i)=>{var s=n.o(e,t)?e[t]:void 0;if(0!==s)if(s)i.push(s[2]);else{var r=new Promise(((i,n)=>s=e[t]=[i,n]));i.push(s[2]=r);var a=n.p+n.u(t),o=new Error;n.l(a,(i=>{if(n.o(e,t)&&(0!==(s=e[t])&&(e[t]=void 0),s)){var r=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",o.name="ChunkLoadError",o.type=r,o.request=a,s[1](o)}}),"chunk-"+t,t)}};var t=(t,i)=>{var s,r,[a,o,c]=i,l=0;if(a.some((t=>0!==e[t]))){for(s in o)n.o(o,s)&&(n.m[s]=o[s]);c&&c(n)}for(t&&t(i);l<a.length;l++)r=a[l],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0},i=self.uiActionsEnhanced_bundle_jsonpfunction=self.uiActionsEnhanced_bundle_jsonpfunction||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),n.nc=void 0,n(5647),__kbnBundles__.define("plugin/uiActionsEnhanced/public",n,7374)})();