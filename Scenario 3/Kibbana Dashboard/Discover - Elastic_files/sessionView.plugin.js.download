/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e,t,o={2787:(e,t,o)=>{"use strict";o.d(t,{$B:()=>d,AR:()=>h,Af:()=>m,Du:()=>g,Ek:()=>_,FK:()=>S,G5:()=>V,GU:()=>M,GW:()=>I,Lh:()=>w,N4:()=>l,NZ:()=>j,OF:()=>y,OU:()=>E,SW:()=>n,Vr:()=>$,WD:()=>a,Z8:()=>b,ab:()=>s,bC:()=>x,cd:()=>v,eH:()=>p,fU:()=>A,kP:()=>r,nH:()=>u,oO:()=>C,oS:()=>D,os:()=>f,x2:()=>i,yF:()=>k,yw:()=>N,zs:()=>T,zy:()=>c});const i="session_view",s="1",n="/internal/session_view/process_events",r="/internal/session_view/alerts",a="/internal/session_view/alert_status",l="/internal/session_view/io_events",u="/internal/session_view/get_total_io_bytes",d="security",c="/administration/policy",p="process.entry_leader.entity_id",m=500,v=100,x=10,g="sessionViewProcessEvents",j="sessionViewAlerts",h="sessionViewIOEvents",y="sessionViewGetTotalIOBytes",f="sessionView:displayOptions",b={stopPropagation:()=>{}},C=500,w=30,T=200,k=11,_=66,I=280,$=/(\r?\n|\r\n?|\x1b\[\d+;\d*[Hf]?)/gi,S=999,E={process:"gear",file:"document",network:"globe"},N="all",P=["@timestamp","event.id","event.kind","event.type","event.action","event.category","user.id","user.name","group.id","group.name","host.architecture","host.hostname","host.id","host.ip","host.mac","host.name","host.os.family","host.os.full","host.os.kernel","host.os.name","host.platform","host.version","host.boot.id","process.entity_id","process.args","process.command_line","process.executable","process.name","process.interactive","process.working_directory","process.pid","process.start","process.end","process.user.id","process.user.name","process.group.id","process.group.name","process.supplemental_groups","process.exit_code","process.tty.*","process.entry_leader.*","process.session_leader.*","process.group_leader.*","process.parent.*","process.previous","container.id","container.name","container.image.name","container.image.tag","container.image.hash.all","orchestrator.resource.name","orchestrator.resource.type","orchestrator.resource.ip","orchestrator.resource.parent.type","orchestrator.resource.labels","orchestrator.resource.annotations","orchestrator.namespace","orchestrator.cluster.name","orchestrator.cluster.id","cloud.instance.name","cloud.account.id","cloud.project.id","cloud.project.name","cloud.provider","cloud.region"],A=(P.concat(["process.io.*"]),P.concat(["file.extension","file.path","file.name","network.type","network.transport","network.protocol","destination.address","destination.ip","destination.protocol","source.address","source.ip","source.protocol","kibana.alert.uuid","kibana.alert.reason","kibana.alert.workflow_status","kibana.alert.status","kibana.alert.original_time","kibana.alert.original_event.action","kibana.alert.rule.category","kibana.alert.rule.consumer","kibana.alert.rule.description","kibana.alert.rule.enabled","kibana.alert.rule.name","kibana.alert.rule.risk_score","kibana.alert.rule.severity","kibana.alert.rule.uuid","kibana.alert.rule.parameters.query","kibana.alert.rule.query"]),"fork"),M="end",V="exec",D="executed"},1716:(e,t,o)=>{"use strict";o.d(t,{U:()=>a});var i=o(5008);const s=i.i18n.translate("xpack.sessionView.processTooltip",{defaultMessage:"Process alert"}),n=i.i18n.translate("xpack.sessionView.networkTooltip",{defaultMessage:"Network alert"}),r=i.i18n.translate("xpack.sessionView.fileTooltip",{defaultMessage:"File alert"}),a=e=>{let t="";switch(e){case"file":t=r;break;case"network":t=n;break;default:t=s}return t}},9235:(e,t,o)=>{"use strict";o.d(t,{A:()=>a});var i=o(4286),s=o(1319),n=o(4916),r=o(6791);const a=({id:e,listItems:t,title:o,tooltipContent:a,extraActionTitle:l,onExtraActionClick:u,children:d,initialIsOpen:c=!1})=>{const p=(()=>{const{euiTheme:e}=(0,s.useEuiTheme)();return(0,i.useMemo)((()=>{const t={padding:e.size.base};return{accordion:{borderTop:e.border.thin,"&:last-child":{borderBottom:e.border.thin},dl:{paddingTop:"0px"},"&:only-child":{border:e.border.thin,borderRadius:e.border.radius.medium}},accordionButton:{padding:e.size.base,fontWeight:e.font.weight.bold},tabSection:t}}),[e])})();return(0,r.jsx)(s.EuiAccordion,{id:e,arrowDisplay:"right",initialIsOpen:c,buttonContent:(0,r.jsx)(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,css:p.accordionButton},(0,r.jsx)(s.EuiFlexItem,{grow:!1},(0,r.jsx)("span",null,o)),a&&(0,r.jsx)(s.EuiFlexItem,{grow:!1,"data-test-subj":"sessionView:detail-panel-accordion-tooltip"},(0,r.jsx)(s.EuiIconTip,{content:a}))),css:p.accordion,"data-test-subj":"sessionView:detail-panel-accordion"},(0,r.jsx)(n.E,{listItems:t}),d)}},190:(e,t,o)=>{"use strict";o.d(t,{B7:()=>b});var i=o(4286),s=o(1319),n=o(5008),r=o(5879),a=o(770),l=o(1716),u=o(2787),d=o(6791);const c=(e=!1,t=!1)=>{const{euiTheme:o}=(0,s.useEuiTheme)();return(0,i.useMemo)((()=>{const{colors:i,font:n,size:r,border:a}=o,l=(0,s.transparentize)(i.danger,.2),u=(0,s.transparentize)(i.danger,.08),c=a.width.thin,p=r.m;let m=i.text,v=i.lightShade;t&&(m=i.primaryText,v=l);const x=(0,d.css)("border:",c," solid ",v,";padding:",p,";border-radius:",a.radius.medium,";margin:0 ",p," ",p," ",p,";background-color:",i.emptyShade,";& .euiAccordion__buttonContent{width:100%;}& .euiAccordion__button{min-width:0;width:calc(100% - ",r.l,");}& .euiAccordion__childWrapper{overflow:visible;}","");return{alertItem:x,alertGroupItem:(0,d.css)(x," & .euiAccordion__childWrapper{overflow:hidden;}",""),alertTitleContainer:{display:e?"none":"initial",color:m,fontWeight:n.weight.semiBold},alertTitle:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},alertIcon:{marginRight:r.s},alertAccordionButton:{width:`calc(100% - ${r.l})`,minWidth:0},alertCountArrowPad:{marginRight:r.xs},processPanel:{border:`${c} solid ${i.lightShade}`,fontFamily:n.familyCode,marginTop:e?r.s:r.m,padding:`${r.xs} ${r.s}`},investigatedLabel:{position:"relative",zIndex:1,bottom:`-${p}`,left:`-${p}`,width:`calc(100% + ${p} * 2)`,borderTop:`${c} solid ${l}`,borderBottomLeftRadius:a.radius.medium,borderBottomRightRadius:a.radius.medium,backgroundColor:u,textAlign:"center"},minimalContextMenu:{float:"right"},firstAlertPad:{"&:first-child":{paddingTop:r.base}},minimalHR:{marginBottom:0}}}),[o,t,e])},p=({event:e,onShowAlertDetails:t,onJumpToEvent:o})=>{var a,l,u;const[c,p]=(0,i.useState)(!1),m=(0,i.useCallback)((()=>{p(!1)}),[]),v=(0,i.useCallback)((()=>{p(!c)}),[c]),x=(0,i.useCallback)((()=>{o(e),p(!1)}),[e,o]),g=(0,i.useCallback)((()=>{var o,i;null!==(o=e.kibana)&&void 0!==o&&null!==(i=o.alert)&&void 0!==i&&i.uuid&&(t(e.kibana.alert.uuid),p(!1))}),[e,t]);if(!e.kibana)return null;const j=null!==(a=null===(l=e.kibana)||void 0===l||null===(u=l.alert)||void 0===u?void 0:u.uuid)&&void 0!==a?a:"",h=[(0,d.jsx)(s.EuiContextMenuItem,{key:"details","data-test-subj":"sessionView:detailPanelAlertActionShowDetails",onClick:g},(0,d.jsx)(r.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertListItem.showDetailsAction",defaultMessage:"View alert details"})),(0,d.jsx)(s.EuiContextMenuItem,{key:"jumpTo","data-test-subj":"sessionView:detailPanelAlertActionJumpToProcess",onClick:x},(0,d.jsx)(r.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertListItem.jumpToAlert",defaultMessage:"Jump to alerted process"}))];return(0,d.jsx)(s.EuiPopover,{id:j,button:(0,d.jsx)(s.EuiButtonIcon,{display:"empty",size:"s",iconType:"boxesHorizontal","aria-label":n.i18n.translate("xpack.sessionView.detailPanelAlertListItem.moreButton",{defaultMessage:"More"}),"data-test-subj":"sessionView:detailPanelAlertActionsBtn",onClick:v}),isOpen:c,closePopover:m,panelPaddingSize:"none",anchorPosition:"leftCenter"},(0,d.jsx)(s.EuiContextMenuPanel,{size:"s",items:h}))};var m=o(6559),v=o(9678),x=o(8392);const g="sessionView:detailPanelAlertListItem",j="sessionView:detailPanelAlertListItemArgs",h=({event:e,onJumpToEvent:t,onShowAlertDetails:o,isInvestigated:i,minimal:n})=>{var a,h,y,f;const b=c(n,i),C=(0,v.N)();if(!e.kibana)return null;const w=(0,s.formatDate)(e["@timestamp"],C),T=null===(a=e.kibana)||void 0===a||null===(h=a.alert)||void 0===h?void 0:h.rule,k=(null==T?void 0:T.uuid)||"",_=(null==T?void 0:T.name)||"",{args:I,name:$}=null!==(y=e.process)&&void 0!==y?y:{},{event:S}=e,E=i?void 0:"open",N=Array.isArray(null==S?void 0:S.category)?null==S||null===(f=S.category)||void 0===f?void 0:f[0]:null==S?void 0:S.category,P=null!=N?N:"process",A="process"!==N?`${(0,m.I)($)} ${(0,x.c)(e,N)}`:(0,m.I)(null==I?void 0:I.join(" ")),M=(0,l.U)(P);return n?(0,d.jsx)("div",{"data-test-subj":g,css:b.firstAlertPad},(0,d.jsx)(s.EuiSpacer,{size:"xs"}),(0,d.jsx)(s.EuiFlexGroup,{alignItems:"center"},(0,d.jsx)(s.EuiFlexItem,null,(0,d.jsx)(s.EuiText,{color:"subdued",size:"s"},(0,m.I)(w))),(0,d.jsx)(s.EuiFlexItem,{grow:!1},(0,d.jsx)(p,{css:b.minimalContextMenu,event:e,onJumpToEvent:t,onShowAlertDetails:o}))),(0,d.jsx)(s.EuiPanel,{css:b.processPanel,color:"subdued",hasBorder:!0,hasShadow:!1,borderRadius:"m"},(0,d.jsx)(s.EuiText,{"data-test-subj":j,size:"xs"},A)),(0,d.jsx)(s.EuiHorizontalRule,{css:b.minimalHR,margin:"m",size:"full"})):(0,d.jsx)(s.EuiAccordion,{id:k,"data-test-subj":g,arrowDisplay:i?"right":"none",buttonContent:(0,d.jsx)(s.EuiText,{css:b.alertTitleContainer,size:"s"},(0,d.jsx)("p",{css:b.alertTitle},(0,d.jsx)(s.EuiToolTip,{position:"top",content:M},(0,d.jsx)(s.EuiIcon,{color:"danger",type:u.OU[P],css:b.alertIcon})),(0,m.I)(_))),initialIsOpen:!0,forceState:E,css:b.alertItem,extraAction:(0,d.jsx)(p,{event:e,onJumpToEvent:t,onShowAlertDetails:o})},(0,d.jsx)(s.EuiSpacer,{size:"xs"}),(0,d.jsx)(s.EuiText,{"data-test-subj":"sessionView:detailPanelAlertListItemTimestamp",color:"subdued",size:"s"},(0,m.I)(w)),(0,d.jsx)(s.EuiPanel,{css:b.processPanel,color:"subdued",hasBorder:!0,hasShadow:!1,borderRadius:"m"},(0,d.jsx)(s.EuiText,{"data-test-subj":j,size:"xs"},A)),i&&(0,d.jsx)("div",{css:b.investigatedLabel},(0,d.jsx)(s.EuiText,{size:"xs",color:"danger"},(0,d.jsx)(r.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertListItem.investigatedLabel",defaultMessage:"Investigated alert"}))))},y=({alerts:e,onJumpToEvent:t,onShowAlertDetails:o})=>{var i,n,r,a;const l=c(),u=e.length.toLocaleString();if(!e[0].kibana)return null;const{rule:p}=null!==(i=null===(n=e[0])||void 0===n||null===(r=n.kibana)||void 0===r?void 0:r.alert)&&void 0!==i?i:{};return(0,d.jsx)(s.EuiAccordion,{id:null!==(a=null==p?void 0:p.uuid)&&void 0!==a?a:"","data-test-subj":"sessionView:detailPanelAlertGroupItem",arrowDisplay:"right",initialIsOpen:!1,buttonContent:(0,d.jsx)(s.EuiText,{"data-test-subj":"sessionView:detailPanelAlertGroupTitle",css:l.alertTitleContainer,size:"s"},(0,d.jsx)("p",{css:l.alertTitle},(0,d.jsx)(s.EuiIcon,{color:"danger",type:"warning",css:l.alertIcon}),(0,m.I)(null==p?void 0:p.name))),css:l.alertGroupItem,extraAction:(0,d.jsx)(s.EuiNotificationBadge,{"data-test-subj":"sessionView:detailPanelAlertGroupCount",className:"eui-alignCenter",size:"m",css:l.alertCountArrowPad},u)},e.map((e=>{var i,s;const n="minimal_"+(null===(i=e.kibana)||void 0===i||null===(s=i.alert)||void 0===s?void 0:s.uuid);return(0,d.jsx)(h,{key:n,minimal:!0,event:e,onJumpToEvent:t,onShowAlertDetails:o})})))},f="listView",b=({alerts:e,isFetchingAlerts:t,hasNextPageAlerts:o,fetchNextPageAlerts:l,onJumpToEvent:u,onShowAlertDetails:c,investigatedAlertId:p})=>{const m=(()=>{const{euiTheme:e}=(0,s.useEuiTheme)();return(0,i.useMemo)((()=>{const{colors:t,size:o}=e;return{container:{position:"relative"},stickyItem:{position:"sticky",top:0,zIndex:1,backgroundColor:t.emptyShade},viewMode:{margin:o.base},loadMoreBtn:{margin:o.m,width:`calc(100% - ${o.m} * 2)`}}}),[e])})(),[v,x]=(0,i.useState)(f),g=[{id:f,label:n.i18n.translate("xpack.sessionView.alertDetailsTab.listView",{defaultMessage:"List view"})},{id:"groupView",label:n.i18n.translate("xpack.sessionView.alertDetailsTab.groupView",{defaultMessage:"Group view"})}],j=(0,i.useMemo)((()=>p&&e.find((e=>{var t,o;return(null===(t=e.kibana)||void 0===t||null===(o=t.alert)||void 0===o?void 0:o.uuid)===p}))),[p,e]),b=(0,i.useMemo)((()=>(0,a.groupBy)(e,(e=>{var t,o,i;return null===(t=e.kibana)||void 0===t||null===(o=t.alert)||void 0===o||null===(i=o.rule)||void 0===i?void 0:i.uuid}))),[e]);return 0===e.length?(0,d.jsx)(s.EuiEmptyPrompt,{"data-test-subj":"sessionView:detailPanelAlertsEmptyState",title:(0,d.jsx)("h2",null,(0,d.jsx)(r.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertsEmptyTitle",defaultMessage:"No alerts"})),body:(0,d.jsx)("p",null,(0,d.jsx)(r.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertsEmptyMsg",defaultMessage:"No alerts were created for this session."}))}):(0,d.jsx)("div",{css:m.container},(0,d.jsx)(s.EuiButtonGroup,{"data-test-subj":"sessionView:detailPanelAlertsViewMode",css:m.viewMode,legend:n.i18n.translate("xpack.sessionView.alertDetailsTab.toggleViewMode",{defaultMessage:"Toggle view mode"}),options:g,idSelected:v,onChange:x,buttonSize:"compressed",isFullWidth:!0}),j&&(0,d.jsx)("div",{css:m.stickyItem,"data-test-subj":"sessionView:detailPanelInvestigatedAlert"},(0,d.jsx)(h,{event:j,onJumpToEvent:u,onShowAlertDetails:c,isInvestigated:!0}),(0,d.jsx)(s.EuiHorizontalRule,{margin:"m",size:"full"})),v===f?e.map((e=>{var t,o;const i=null===(t=e.kibana)||void 0===t||null===(o=t.alert)||void 0===o?void 0:o.uuid;if(i&&e!==j)return(0,d.jsx)(h,{key:i,event:e,onJumpToEvent:u,onShowAlertDetails:c})})):Object.keys(b).map((e=>{var t,o,i;const s=b[e],n=null===(t=s[0].kibana)||void 0===t||null===(o=t.alert)||void 0===o||null===(i=o.rule)||void 0===i?void 0:i.uuid;if(n)return(0,d.jsx)(y,{key:n,alerts:s,onJumpToEvent:u,onShowAlertDetails:c})})),o&&(0,d.jsx)(s.EuiButton,{color:"primary",isLoading:t,onClick:l,css:m.loadMoreBtn,"data-test-subj":"alerts-details-load-more"},(0,d.jsx)(r.FormattedMessage,{id:"xpack.sessionView.alertsLoadMoreButton",defaultMessage:"Load more alerts"})))}},6330:(e,t,o)=>{"use strict";o.d(t,{f:()=>u});var i=o(4286),s=o.n(i),n=o(1319),r=o(5008),a=o(6275),l=o(6791);const u=({children:e,textToCopy:t,tooltipContent:o,display:u="inlineBlock"})=>{const d=(()=>{const{euiTheme:e}=(0,n.useEuiTheme)();return(0,i.useMemo)((()=>({copyButton:{position:"absolute",right:e.size.s,top:0,bottom:0,margin:"auto"}})),[e])})(),c={copy:(0,l.jsx)(n.EuiCopy,{textToCopy:t,display:u},(e=>(0,l.jsx)(n.EuiButtonIcon,{css:d.copyButton,onClick:e,display:"base",iconType:"copyClipboard",size:"xs","aria-label":r.i18n.translate("xpack.sessionView.detailPanelCopy.copyButton",{defaultMessage:"Copy"})})))};return"block"===u&&(c.display=u),(0,l.jsx)(a.N,c,(0,l.jsx)(n.EuiToolTip,{position:"top",content:o},(0,l.jsx)(s().Fragment,null,e)))}},4916:(e,t,o)=>{"use strict";o.d(t,{E:()=>r});var i=o(4286),s=o(1319),n=o(6791);const r=({listItems:e})=>{const t=(()=>{const{euiTheme:e}=(0,s.useEuiTheme)();return(0,i.useMemo)((()=>({descriptionList:{padding:`${e.size.base} ${e.size.s} `,alignItems:"flex-start",rowGap:0},tabListTitle:{display:"flex"},tabListDescription:{display:"flex"}})),[e])})();return(0,n.jsx)(s.EuiDescriptionList,{type:"column",columnWidths:[2,3],listItems:e,css:t.descriptionList,titleProps:{css:t.tabListTitle},descriptionProps:{css:t.tabListDescription},"data-test-subj":"sessionView:detail-panel-description-list"})}},6275:(e,t,o)=>{"use strict";o.d(t,{N:()=>a});var i=o(3185),s=o(4286),n=o(1319),r=o(6791);const a=({children:e,copy:t,display:o="grid"})=>{const[a,l]=(0,s.useState)(!1),u=(({display:e})=>{const{euiTheme:t}=(0,n.useEuiTheme)();return(0,s.useMemo)((()=>{const o={display:e,alignContent:"center",padding:`${t.size.xs} ${t.size.s} `,width:"100%",fontWeight:"inherit",height:"max-content",minHeight:t.size.l,letterSpacing:"0px",textAlign:"left","& .euiToolTipAnchor":{width:`calc(100% - ${t.size.xl})`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}};return{item:o,copiableItem:{...o,position:"relative",borderRadius:t.border.radius.medium,"&:hover":{background:(0,n.transparentize)(t.colors.primary,.1)},height:"fit-content"}}}),[e,t])})({display:o}),d={size:"s",css:t?u.copiableItem:u.item};return t&&(d.onMouseEnter=()=>l(!0),d.onMouseLeave=()=>l(!1)),(0,r.jsx)(n.EuiText,(0,i.default)({},d,{"data-test-subj":"sessionView:detail-panel-list-item"}),e,a&&t)}},1544:(e,t,o)=>{"use strict";o.d(t,{W:()=>m});var i=o(4286),s=o.n(i),n=o(1319),r=o(5008),a=o(9235),l=o(6330),u=o(6275),d=o(4023),c=o(6559),p=o(6791);const m=({processHost:e,processContainer:t,processOrchestrator:o,processCloud:m})=>{const v=(()=>{const{euiTheme:e}=(0,n.useEuiTheme)();return(0,i.useMemo)((()=>({metadataHostOS:{margin:`${e.size.m} ${e.size.base} ${e.size.base} ${e.size.base}`,paddingBottom:e.size.base}})),[e])})(),x=(0,i.useMemo)((()=>(e=>{var t,o,i,s,n,r,a,l,u,p,m,v;const x={architecture:d.j,hostname:d.j,id:d.j,ip:d.j,mac:d.j,name:d.j,os:{family:d.j,full:d.j,kernel:d.j,name:d.j,platform:d.j,version:d.j}};return e?(x.hostname=(0,c.I)(e.hostname).toString(),x.id=(0,c.I)(e.id).toString(),x.ip=null!==(t=null===(o=e.ip)||void 0===o||null===(i=o.map)||void 0===i?void 0:i.call(o,(e=>(0,c.I)(e))).join(", "))&&void 0!==t?t:d.j,x.mac=null!==(s=null===(n=e.mac)||void 0===n||null===(r=n.map)||void 0===r?void 0:r.call(n,(e=>(0,c.I)(e))).join(", "))&&void 0!==s?s:d.j,x.name=(0,c.I)(e.name).toString(),x.architecture=(0,c.I)(e.architecture).toString(),x.os.family=(0,c.I)(null===(a=e.os)||void 0===a?void 0:a.family).toString(),x.os.full=(0,c.I)(null===(l=e.os)||void 0===l?void 0:l.full).toString(),x.os.kernel=(0,c.I)(null===(u=e.os)||void 0===u?void 0:u.kernel).toString(),x.os.name=(0,c.I)(null===(p=e.os)||void 0===p?void 0:p.name).toString(),x.os.platform=(0,c.I)(null===(m=e.os)||void 0===m?void 0:m.platform).toString(),x.os.version=(0,c.I)(null===(v=e.os)||void 0===v?void 0:v.version).toString(),x):x})(e)),[e]),g=(0,i.useMemo)((()=>(e=>{var t,o,i,s;const n={id:d.j,name:d.j,image:{name:d.j,tag:d.j,hash:{all:d.j}}};return e?(n.id=(0,c.I)(e.id).toString(),n.name=(0,c.I)(e.name).toString(),n.image.name=(0,c.I)(null==e||null===(t=e.image)||void 0===t?void 0:t.name).toString(),n.image.tag=(0,c.I)(null==e||null===(o=e.image)||void 0===o?void 0:o.tag).toString(),n.image.hash.all=(0,c.I)(null==e||null===(i=e.image)||void 0===i||null===(s=i.hash)||void 0===s?void 0:s.all).toString(),n):n})(t)),[t]),j=(0,i.useMemo)((()=>(e=>{var t,o,i,s,n,r,a;const l={resource:{name:d.j,type:d.j,ip:d.j,parent:{type:d.j}},namespace:d.j,cluster:{name:d.j,id:d.j}};return e?(l.resource.name=(0,c.I)(null==e||null===(t=e.resource)||void 0===t?void 0:t.name).toString(),l.resource.type=(0,c.I)(null==e||null===(o=e.resource)||void 0===o?void 0:o.type).toString(),l.resource.ip=(0,c.I)(null==e||null===(i=e.resource)||void 0===i?void 0:i.ip).toString(),l.namespace=(0,c.I)(null==e?void 0:e.namespace).toString(),l.cluster.name=(0,c.I)(null==e||null===(s=e.cluster)||void 0===s?void 0:s.name).toString(),l.cluster.id=(0,c.I)(null==e||null===(n=e.cluster)||void 0===n?void 0:n.id).toString(),l.resource.parent.type=(0,c.I)(null==e||null===(r=e.resource)||void 0===r||null===(a=r.parent)||void 0===a?void 0:a.type).toString(),l):l})(o)),[o]),h=(0,i.useMemo)((()=>(e=>{var t,o,i,s;const n={instance:{name:d.j},account:{id:d.j},project:{id:d.j,name:d.j},provider:d.j,region:d.j};return e?(n.instance.name=(0,c.I)(null==e||null===(t=e.instance)||void 0===t?void 0:t.name).toString(),n.account.id=(0,c.I)(null==e||null===(o=e.account)||void 0===o?void 0:o.id).toString(),n.project.id=(0,c.I)(null==e||null===(i=e.project)||void 0===i?void 0:i.id).toString(),n.project.name=(0,c.I)(null==e||null===(s=e.project)||void 0===s?void 0:s.name).toString(),n.provider=(0,c.I)(null==e?void 0:e.provider).toString(),n.region=(0,c.I)(null==e?void 0:e.region).toString(),n):n})(m)),[m]);return(0,p.jsx)(s().Fragment,null,(0,p.jsx)(a.A,{id:"metadataHost",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.metadataHost",{defaultMessage:"Host"}),initialIsOpen:!0,listItems:[{title:(0,p.jsx)(u.N,null,"id"),description:(0,p.jsx)(l.f,{textToCopy:`host.id: "${x.id}"`,tooltipContent:x.id},x.id)},{title:(0,p.jsx)(u.N,null,"hostname"),description:(0,p.jsx)(l.f,{textToCopy:`host.hostname: "${x.hostname}"`,tooltipContent:x.hostname},x.hostname)},{title:(0,p.jsx)(u.N,null,"ip"),description:(0,p.jsx)(l.f,{textToCopy:`host.ip: "${x.ip}"`,tooltipContent:x.ip},x.ip)},{title:(0,p.jsx)(u.N,null,"mac"),description:(0,p.jsx)(l.f,{textToCopy:`host.mac: "${x.mac}"`,tooltipContent:x.mac},x.mac)},{title:(0,p.jsx)(u.N,null,"name"),description:(0,p.jsx)(l.f,{textToCopy:`host.name: "${x.name}"`,tooltipContent:x.name},x.name)}]},(0,p.jsx)(n.EuiPanel,{hasShadow:!1,color:"plain",hasBorder:!1,borderRadius:"m",paddingSize:"none",css:v.metadataHostOS},(0,p.jsx)(a.A,{id:"hostOS",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.host",{defaultMessage:"OS"}),listItems:[{title:(0,p.jsx)(u.N,null,"architecture"),description:(0,p.jsx)(l.f,{textToCopy:`host.architecture: "${x.architecture}"`,tooltipContent:x.architecture},x.architecture)},{title:(0,p.jsx)(u.N,null,"os.family"),description:(0,p.jsx)(l.f,{textToCopy:`host.os.family: "${x.os.family}"`,tooltipContent:x.os.family},x.os.family)},{title:(0,p.jsx)(u.N,null,"os.full"),description:(0,p.jsx)(l.f,{textToCopy:`host.os.full: "${x.os.full}"`,tooltipContent:x.os.full},x.os.full)},{title:(0,p.jsx)(u.N,null,"os.kernel"),description:(0,p.jsx)(l.f,{textToCopy:`host.os.kernel: "${x.os.kernel}"`,tooltipContent:x.os.kernel},x.os.kernel)},{title:(0,p.jsx)(u.N,null,"os.name"),description:(0,p.jsx)(l.f,{textToCopy:`host.os.name: "${x.os.name}"`,tooltipContent:x.os.name},x.os.name)},{title:(0,p.jsx)(u.N,null,"os.platform"),description:(0,p.jsx)(l.f,{textToCopy:`host.os.platform: "${x.os.platform}"`,tooltipContent:x.os.platform},x.os.platform)},{title:(0,p.jsx)(u.N,null,"os.version"),description:(0,p.jsx)(l.f,{textToCopy:`host.os.version: "${x.os.version}"`,tooltipContent:x.os.version},x.os.version)}]}))),m&&(0,p.jsx)(s().Fragment,null,(0,p.jsx)(a.A,{id:"metadataCloud",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.cloud",{defaultMessage:"Cloud"}),listItems:[{title:(0,p.jsx)(u.N,null,"instance.name"),description:(0,p.jsx)(l.f,{textToCopy:`cloud.provider: "${h.instance.name}"`,tooltipContent:h.instance.name},h.instance.name)},{title:(0,p.jsx)(u.N,null,"provider"),description:(0,p.jsx)(l.f,{textToCopy:`cloud.provider: "${h.provider}"`,tooltipContent:h.provider},h.provider)},{title:(0,p.jsx)(u.N,null,"region"),description:(0,p.jsx)(l.f,{textToCopy:`cloud.region: "${h.region}"`,tooltipContent:h.region},h.region)},{title:(0,p.jsx)(u.N,null,"account.id"),description:(0,p.jsx)(l.f,{textToCopy:`cloud.account.id: "${h.account.id}"`,tooltipContent:h.account.id},h.account.id)},{title:(0,p.jsx)(u.N,null,"project.id"),description:(0,p.jsx)(l.f,{textToCopy:`cloud.project.id: "${h.project.id}"`,tooltipContent:h.project.id},h.project.id)},{title:(0,p.jsx)(u.N,null,"project.name"),description:(0,p.jsx)(l.f,{textToCopy:`cloud.project.name: "${h.project.name}"`,tooltipContent:h.project.name},h.project.name)}]})),t&&(0,p.jsx)(s().Fragment,null,(0,p.jsx)(a.A,{id:"metadataContainer",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.container",{defaultMessage:"Container"}),listItems:[{title:(0,p.jsx)(u.N,null,"id"),description:(0,p.jsx)(l.f,{textToCopy:`container.id: "${g.id}"`,tooltipContent:g.id},g.id)},{title:(0,p.jsx)(u.N,null,"name"),description:(0,p.jsx)(l.f,{textToCopy:`container.name: "${g.name}"`,tooltipContent:g.name},g.name)},{title:(0,p.jsx)(u.N,null,"image.name"),description:(0,p.jsx)(l.f,{textToCopy:`container.image.name: "${g.image.name}"`,tooltipContent:g.image.name},g.image.name)},{title:(0,p.jsx)(u.N,null,"image.tag"),description:(0,p.jsx)(l.f,{textToCopy:`container.image.tag: "${g.image.tag}"`,tooltipContent:g.image.tag},g.image.tag)},{title:(0,p.jsx)(u.N,null,"image.hash.all"),description:(0,p.jsx)(l.f,{textToCopy:`container.image.hash.all: "${g.image.hash.all}"`,tooltipContent:g.image.hash.all},g.image.hash.all)}]})),o&&(0,p.jsx)(s().Fragment,null,(0,p.jsx)(a.A,{id:"metadataOrchestrator",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.orchestrator",{defaultMessage:"Orchestrator"}),listItems:[{title:(0,p.jsx)(u.N,null,"resource.ip"),description:(0,p.jsx)(l.f,{textToCopy:`orchestrator.resource.ip: "${j.resource.ip}"`,tooltipContent:j.resource.ip},j.resource.ip)},{title:(0,p.jsx)(u.N,null,"resource.name"),description:(0,p.jsx)(l.f,{textToCopy:`orchestrator.resource.name: "${j.resource.name}"`,tooltipContent:j.resource.name},j.resource.name)},{title:(0,p.jsx)(u.N,null,"resource.type"),description:(0,p.jsx)(l.f,{textToCopy:`orchestrator.resource.type: "${j.resource.type}"`,tooltipContent:j.resource.type},j.resource.type)},{title:(0,p.jsx)(u.N,null,"resource.parent.type"),description:(0,p.jsx)(l.f,{textToCopy:`orchestrator.resource.parent.type: "${j.resource.parent.type}"`,tooltipContent:j.resource.parent.type},j.resource.parent.type)},{title:(0,p.jsx)(u.N,null,"namespace"),description:(0,p.jsx)(l.f,{textToCopy:`orchestrator.namespace: "${j.namespace}"`,tooltipContent:j.namespace},j.namespace)},{title:(0,p.jsx)(u.N,null,"cluster.id"),description:(0,p.jsx)(l.f,{textToCopy:`orchestrator.cluster.id: "${j.cluster.id}"`,tooltipContent:j.cluster.id},j.cluster.id)},{title:(0,p.jsx)(u.N,null,"cluster.name"),description:(0,p.jsx)(l.f,{textToCopy:`orchestrator.cluster.name: "${j.cluster.name}"`,tooltipContent:j.cluster.name},j.cluster.name)}]})))}},8006:(e,t,o)=>{"use strict";o.d(t,{u:()=>C});var i=o(4286),s=o.n(i),n=o(1319),r=o(5008),a=o(9235),l=o(6330),u=o(4916),d=o(6275),c=o(6559),p=o(4023),m=o(8380);const v={id:p.j,name:p.j,start:p.j,end:p.j,exitCode:p.j,userId:p.j,userName:p.j,groupId:p.j,groupName:p.j,workingDirectory:p.j,interactive:p.j,args:p.j,pid:p.j,entryMetaType:p.j,entryMetaSourceIp:p.j,executable:[[p.j]]},x=e=>{try{return e.map((e=>{const[t,o]=e;if(!t||!o||2!==e.length)throw new Error;return`${t} ${o}`})).join(", ")}catch(e){return""}},g=e=>e&&e.length&&e.map?`[${e.map((e=>`'${e}'`)).join(", ")}]`:p.j,j=e=>{var t,o,i,s,n,r,a,l,u,d,c,p,m,x,j,h,y,f,b,C,w,T,k;return{...e,id:null!==(t=null==e?void 0:e.entity_id)&&void 0!==t?t:v.id,name:null!==(o=null==e?void 0:e.name)&&void 0!==o?o:v.name,start:null!==(i=null==e?void 0:e.start)&&void 0!==i?i:v.start,end:null!==(s=null==e?void 0:e.end)&&void 0!==s?s:v.end,exitCode:null!==(n=null==e||null===(r=e.exit_code)||void 0===r?void 0:r.toString())&&void 0!==n?n:v.exitCode,interactive:null!=e&&e.interactive?"True":"False",userId:null!==(a=null==e||null===(l=e.user)||void 0===l?void 0:l.id)&&void 0!==a?a:v.userId,userName:null!==(u=null==e||null===(d=e.user)||void 0===d?void 0:d.name)&&void 0!==u?u:v.userName,groupId:null!==(c=null==e||null===(p=e.group)||void 0===p?void 0:p.id)&&void 0!==c?c:v.groupId,groupName:null!==(m=null==e||null===(x=e.group)||void 0===x?void 0:x.name)&&void 0!==m?m:v.groupName,workingDirectory:null!==(j=null==e?void 0:e.working_directory)&&void 0!==j?j:v.workingDirectory,args:null!==(h=g(null==e?void 0:e.args))&&void 0!==h?h:v.args,pid:null!==(y=null==e||null===(f=e.pid)||void 0===f?void 0:f.toString())&&void 0!==y?y:v.pid,executable:null!=e&&e.executable?[[null==e?void 0:e.executable]]:v.executable,entryMetaType:null!==(b=null==e||null===(C=e.entry_meta)||void 0===C?void 0:C.type)&&void 0!==b?b:v.entryMetaType,entryMetaSourceIp:null!==(w=null==e||null===(T=e.entry_meta)||void 0===T||null===(k=T.source)||void 0===k?void 0:k.ip)&&void 0!==w?w:v.entryMetaSourceIp}};var h=o(6791);const y=[{id:"processEntryLeader",title:"Entry Leader",tooltipContent:r.i18n.translate("xpack.sessionView.detailPanel.entryLeaderTooltip",{defaultMessage:"Session leader process associated with initial terminal or remote access via SSH, SSM and other remote access protocols. Entry sessions are also used to represent a service directly started by the init process. In many cases this is the same as the session_leader."})},{id:"processSessionLeader",title:"Session Leader",tooltipContent:r.i18n.translate("xpack.sessionView.detailPanel.sessionLeaderTooltip",{defaultMessage:"Often the same as entry_leader. When it differs, this represents a session started within another session. Some tools like tmux and screen will start a new session to obtain a new tty and/or separate their lifecycle from the entry session."})},{id:"processGroupLeader",title:"Group Leader",tooltipContent:r.i18n.translate("xpack.sessionView.detailPanel.processGroupLeaderTooltip",{defaultMessage:"The process group leader to the current process."})},{id:"processParent",title:"Parent",tooltipContent:r.i18n.translate("xpack.sessionView.detailPanel.processParentTooltip",{defaultMessage:"The direct parent to the current process."})}],f="process",b=[`${f}.entry_leader`,`${f}.session_leader`,`${f}.group_leader`,`${f}.parent`],C=({selectedProcess:e,index:t})=>{const o=(()=>{const{euiTheme:e}=(0,n.useEuiTheme)();return(0,i.useMemo)((()=>({descriptionSemibold:{fontWeight:e.font.weight.medium},executableAction:{fontWeight:e.font.weight.bold,paddingLeft:e.size.xs},ellipsis:{overflow:"hidden",textOverflow:"ellipsis"}})),[e])})(),r=(0,i.useMemo)((()=>((e,t)=>{var o,i,s,n,r,a,l,u,d,p,x,h,y,f,b,C,w,T,k,_,I;const $={id:v.id,start:v.start,end:v.end,exitCode:v.exitCode,interactive:v.interactive,userId:v.userId,userName:v.userName,groupName:v.groupName,args:v.args,pid:v.pid,executable:v.executable,workingDirectory:v.workingDirectory,entryLeader:v,sessionLeader:v,groupLeader:v,parent:v};if(!e)return $;const S=e.getDetails();$.id=`${(0,c.I)(e.id)}`,$.start=`${(0,c.I)(null===(o=S.process)||void 0===o?void 0:o.start)}`,$.end=`${(0,c.I)(e.getEndTime())}`,$.exitCode=`${(0,c.I)(null===(i=S.process)||void 0===i?void 0:i.exit_code)}`,$.interactive=null!==(s=S.process)&&void 0!==s&&s.interactive?"True":"False",$.userId=`${(0,c.I)(null===(n=S.process)||void 0===n||null===(r=n.user)||void 0===r?void 0:r.id)}`,$.userName=`${(0,c.I)(null===(a=S.process)||void 0===a||null===(l=a.user)||void 0===l?void 0:l.name)}`,$.groupId=`${(0,c.I)(null===(u=S.process)||void 0===u||null===(d=u.group)||void 0===d?void 0:d.id)}`,$.groupName=`${(0,c.I)(null===(p=S.process)||void 0===p||null===(x=p.group)||void 0===x?void 0:x.name)}`,$.pid=`${(0,c.I)(null===(h=S.process)||void 0===h?void 0:h.pid)}`,$.workingDirectory=`${(0,c.I)(null===(y=S.process)||void 0===y?void 0:y.working_directory)}`,null!==(f=S.process)&&void 0!==f&&f.args&&($.args=g(S.process.args));const E=(null===(b=S.process)||void 0===b||null===(C=b.previous)||void 0===C?void 0:C.map((e=>(null==e?void 0:e.executable)||"")))||[];return null!==(w=S.process)&&void 0!==w&&w.executable&&E.push(S.process.executable),$.executable=E.map(((e,o)=>{const i=t===m.Vn?"executed":"exec";return[e,`(${0===o?"fork":i})`]})),$.entryLeader=j(null==S||null===(T=S.process)||void 0===T?void 0:T.entry_leader),$.sessionLeader=j(null==S||null===(k=S.process)||void 0===k?void 0:k.session_leader),$.groupLeader=j(null==S||null===(_=S.process)||void 0===_?void 0:_.group_leader),$.parent=j(null==S||null===(I=S.process)||void 0===I?void 0:I.parent),$})(e,t)),[e,t]),p=(0,i.useCallback)((e=>e.map(((e,t)=>{const[i,s]=e;return(0,h.jsx)("div",{key:`executable-${t}`,css:o.ellipsis},(0,h.jsx)(n.EuiTextColor,{color:"default",css:o.descriptionSemibold},i),s&&(0,h.jsx)(n.EuiTextColor,{color:"default",css:o.executableAction},s))}))),[o.descriptionSemibold,o.ellipsis,o.executableAction]),C=[r.entryLeader,r.sessionLeader,r.groupLeader,r.parent].map(((e,t)=>{const{id:o,start:i,end:s,exitCode:n,entryMetaType:r,interactive:a,workingDirectory:u,args:m,executable:v,pid:g,userId:j,userName:f,groupId:C,groupName:w,entryMetaSourceIp:T}=e,k=x(v),_=[{title:(0,h.jsx)(d.N,null,"entity_id"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.entity_id: "${o}"`,tooltipContent:o},o)},{title:(0,h.jsx)(d.N,null,"args"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.args: "${m}"`,tooltipContent:m},m)},{title:(0,h.jsx)(d.N,null,"executable"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.executable: "${k}"`,tooltipContent:k},p(v))},{title:(0,h.jsx)(d.N,null,"interactive"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.interactive: "${a}"`,tooltipContent:a},a)},{title:(0,h.jsx)(d.N,null,"working_directory"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.working_directory: "${u}"`,tooltipContent:u},u)},{title:(0,h.jsx)(d.N,null,"pid"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.pid: "${g}"`,tooltipContent:g},g)},{title:(0,h.jsx)(d.N,null,"start"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.start: "${i}"`,tooltipContent:i},i)},{title:(0,h.jsx)(d.N,null,"end"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.end: "${s}"`,tooltipContent:s},s)},{title:(0,h.jsx)(d.N,null,"exit_code"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.exit_code: "${n}"`,tooltipContent:n},n)},{title:(0,h.jsx)(d.N,null,"user.id"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.user.id: "${j}"`,tooltipContent:j},j)},{title:(0,h.jsx)(d.N,null,"user.name"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.user.name: "${f}"`,tooltipContent:f},f)},{title:(0,h.jsx)(d.N,null,"group.id"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.group.id: "${C}"`,tooltipContent:C},C)},{title:(0,h.jsx)(d.N,null,"group.name"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.group.name: "${w}"`,tooltipContent:w},w)}];return 0===t&&_.push({title:(0,h.jsx)(d.N,null,"entry_meta.type"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.entry_meta.type: "${r}"`,tooltipContent:r},r)},{title:(0,h.jsx)(d.N,null,"entry_meta.source.ip"),description:(0,h.jsx)(l.f,{textToCopy:`${b[t]}.entry_meta.source.ip: "${T}"`,tooltipContent:T},(0,c.I)(T))}),{...y[t],name:e.name,listItems:_}})),{id:w,start:T,end:k,executable:_,exitCode:I,pid:$,workingDirectory:S,interactive:E,userId:N,userName:P,groupId:A,groupName:M,args:V}=r,D=x(_);return(0,h.jsx)(s().Fragment,null,(0,h.jsx)(u.E,{listItems:[{title:(0,h.jsx)(d.N,null,"entity_id"),description:(0,h.jsx)(l.f,{textToCopy:`${f}.entity_id: "${w}"`,tooltipContent:w},w)},{title:(0,h.jsx)(d.N,null,"args"),description:(0,h.jsx)(l.f,{textToCopy:`${f}.args: "${V}"`,tooltipContent:V},V)},{title:(0,h.jsx)(d.N,null,"executable"),description:(0,h.jsx)(l.f,{textToCopy:`${f}.executable: "${D}"`,tooltipContent:D,display:"block"},p(_))},{title:(0,h.jsx)(d.N,null,"interactive"),description:(0,h.jsx)(l.f,{textToCopy:`${f}.interactive: "${E}"`,tooltipContent:E},E)},{title:(0,h.jsx)(d.N,null,"working_directory"),description:(0,h.jsx)(l.f,{textToCopy:`${f}.working_directory: "${S}"`,tooltipContent:S},S)},{title:(0,h.jsx)(d.N,null,"pid"),description:(0,h.jsx)(l.f,{textToCopy:`${f}.pid: "${$}"`,tooltipContent:$},$)},{title:(0,h.jsx)(d.N,null,"start"),description:(0,h.jsx)(l.f,{textToCopy:`${f}.start: "${T}"`,tooltipContent:T},T)},{title:(0,h.jsx)(d.N,null,"end"),description:(0,h.jsx)(l.f,{textToCopy:`${f}.end: "${k}"`,tooltipContent:k},k)},{title:(0,h.jsx)(d.N,null,"exit_code"),description:(0,h.jsx)(l.f,{textToCopy:`${f}.exit_code: "${I}"`,tooltipContent:I},I)},{title:(0,h.jsx)(d.N,null,"user.id"),description:(0,h.jsx)(l.f,{textToCopy:`${f}.user.id: "${N}"`,tooltipContent:N},N)},{title:(0,h.jsx)(d.N,null,"user.name"),description:(0,h.jsx)(l.f,{textToCopy:`${f}.user.name: "${P}"`,tooltipContent:P},P)},{title:(0,h.jsx)(d.N,null,"group.id"),description:(0,h.jsx)(l.f,{textToCopy:`${f}.group.id: "${A}"`,tooltipContent:A},A)},{title:(0,h.jsx)(d.N,null,"group.name"),description:(0,h.jsx)(l.f,{textToCopy:`${f}.group.name: "${M}"`,tooltipContent:M},M)}]}),C.map((e=>(0,h.jsx)(a.A,{key:e.id,id:e.id,title:e.title,tooltipContent:e.tooltipContent,listItems:e.listItems,extraActionTitle:e.name}))))}},8616:(e,t,o)=>{"use strict";o.d(t,{MK:()=>u,TQ:()=>l,gj:()=>d,rx:()=>c});var i=o(4286),s=o(3530),n=o(409),r=o(2787);const a=e=>!!e&&[r.fU,r.G5,r.oS,r.GU].includes(e),l=(e,t,o,l)=>{const{http:u}=(0,n.useKibana)().services,[d,c]=(0,i.useState)(""),p=(0,i.useMemo)((()=>[r.Du,e,t,l]),[e,t,l]),m=(0,s.useInfiniteQuery)(p,(async({pageParam:i={}})=>{var s,n;let{cursor:a}=i;const{forward:d}=i;!a&&l&&(a=l);const c=await u.get(r.SW,{version:r.ab,query:{index:e,sessionEntityId:t,sessionStartTime:o,cursor:a,forward:d}});return{events:null!==(s=null===(n=c.events)||void 0===n?void 0:n.map((e=>e._source)))&&void 0!==s?s:[],cursor:a,total:c.total}}),{getNextPageParam:(e,t)=>{if(1===t.length&&l||e.events.length>=r.Af){var o;const t=e.events.filter((e=>{var t;const o=null===(t=e.event)||void 0===t?void 0:t.action;return a(o)})),i=null==t||null===(o=t[t.length-1])||void 0===o?void 0:o["@timestamp"];if(i)return{cursor:i,forward:!0}}},getPreviousPageParam:(e,t)=>{const o=e.events.filter((e=>{var t;const o=null===(t=e.event)||void 0===t?void 0:t.action;return a(o)})),i=t.length>1&&o.length<r.Af;var s;if(l&&!i)return{cursor:(null===(s=o[0])||void 0===s?void 0:s["@timestamp"])||l,forward:!1}},refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1});return(0,i.useEffect)((()=>{var e;l&&1===(null===(e=m.data)||void 0===e?void 0:e.pages.length)&&l!==d&&(m.fetchPreviousPage({cancelRefetch:!0}),c(l))}),[l,m,d]),m},u=(e,t,o)=>{const{http:i}=(0,n.useKibana)().services,a=[r.NZ,e,o];return(0,s.useInfiniteQuery)(a,(async({pageParam:s={}})=>{var n,a;const{cursor:l}=s,u=await i.get(r.kP,{version:r.ab,query:{sessionEntityId:e,sessionStartTime:t,investigatedAlertId:o,cursor:l}});return{events:null!==(n=null===(a=u.events)||void 0===a?void 0:a.map((e=>e._source)))&&void 0!==n?n:[],cursor:l,total:u.total}}),{getNextPageParam:e=>{if(e.events.length>=r.cd)return{cursor:e.events[e.events.length-1]["@timestamp"]}},refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})},d=(e,t)=>{const{http:o}=(0,n.useKibana)().services,i=[r.NZ,t];return(0,s.useQuery)(i,(async()=>{var i,s,n,a,l,u,d,c,p;if(!t)return e;const m=null!==(i=null===(s=(await o.get(r.WD,{version:r.ab,query:{alertUuid:t}})).events)||void 0===s?void 0:s.map((e=>e._source)))&&void 0!==i?i:[];return{...e,[t]:{status:null!==(n=null===(a=m[0])||void 0===a||null===(l=a.kibana)||void 0===l||null===(u=l.alert)||void 0===u?void 0:u.workflow_status)&&void 0!==n?n:"",processEntityId:null!==(d=null===(c=m[0])||void 0===c||null===(p=c.process)||void 0===p?void 0:p.entity_id)&&void 0!==d?d:""}}}),{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,cacheTime:0})},c=(e,t,o)=>{const{http:i}=(0,n.useKibana)().services,a=[r.OF,e,t];return(0,s.useQuery)(a,(async()=>i.get(r.nH,{version:r.ab,query:{index:e,sessionEntityId:t,sessionStartTime:o}})),{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,cacheTime:0})}},4023:(e,t,o)=>{"use strict";o.d(t,{j:()=>i});const i="-"},9678:(e,t,o)=>{"use strict";o.d(t,{N:()=>l,g:()=>r});var i=o(4286),s=o(1319),n=o(3803);const r=(...e)=>({...(0,s.useEuiTheme)(...e),euiVars:(0,i.useMemo)((()=>({terminalOutputBackground:"#1d1e23",terminalOutputMarkerAccent:n.euiLightVars.euiColorAccent,terminalOutputMarkerWarning:n.euiDarkVars.euiColorWarning,terminalOutputSliderBackground:n.euiLightVars.euiColorDarkestShade})),[])});var a=o(409);const l=()=>(0,a.useUiSetting)("dateFormat")},6858:(e,t,o)=>{"use strict";o.r(t),o.d(t,{DetailPanelAlertTab:()=>a.B7,DetailPanelMetadataTab:()=>r.W,DetailPanelProcessTab:()=>n.u,ENTRY_SESSION_ENTITY_ID_PROPERTY:()=>s.eH,plugin:()=>u,useFetchSessionViewAlerts:()=>l.MK});var i=o(8380);class SessionViewPlugin{setup(e){return{}}start(e,t){return{getSessionView:e=>(0,i.q7)({...e,usageCollection:null==t?void 0:t.usageCollection})}}stop(){}}var s=o(2787),n=o(8006),r=o(1544),a=o(190),l=o(8616);function u(){return new SessionViewPlugin}},8380:(e,t,o)=>{"use strict";o.d(t,{fK:()=>v,Vn:()=>y,IH:()=>m,kF:()=>j,EG:()=>p,fS:()=>h,q7:()=>b});var i=o(3185),s=o(4286),n=o(1319),r=o(3530);const a=__kbnSharedDeps__.KbnAnalytics;var l=o(2787),u=o(6791);const d=new r.QueryClient,c=(0,s.lazy)((()=>o.e(741).then(o.bind(o,6741)))),p="endpoint",m="cloud_defend",v="auditbeat",x=new RegExp(`([a-z0-9_-]+:)?[a-z0-9-.]*(${[p,m,v].join("|")})`,"i"),g="logs-*",j="logs-cloud_defend.*",h="logs-endpoint.events.process*",y="auditbeat-*",f={endpoint:h,cloud_defend:j,auditbeat:y},b=e=>{const t=(e=>{if(!e)return g;const t=e.match(x),o=null==t?void 0:t[1],i=o?`${o}`:"",s=null==t?void 0:t[2];return i+(s?f[s]:g)})(e.index);return(0,u.jsx)(r.QueryClientProvider,{client:d},(0,u.jsx)(s.Suspense,{fallback:(0,u.jsx)(n.EuiLoadingSpinner,null)},(0,u.jsx)(c,(0,i.default)({},e,{index:t,trackEvent:t=>{e.usageCollection&&e.usageCollection.reportUiCounter(l.x2,a.METRIC_TYPE.CLICK,t)}}))))}},8392:(e,t,o)=>{"use strict";o.d(t,{c:()=>s});var i=o(6559);const s=(e,t)=>{var o;const s=null==e?void 0:e.destination,r=null==e||null===(o=e.file)||void 0===o?void 0:o.path;return r&&"file"===t?(0,i.I)(r):null!=s&&s.address&&"network"===t?(0,i.I)(n(s)):""},n=e=>{const t=!(null==e||!e.address||null==e||!e.port),o=`${null==e?void 0:e.address}:${null==e?void 0:e.port}`;return`${t?o:null==e?void 0:e.address}`}},6559:(e,t,o)=>{"use strict";o.d(t,{I:()=>s});var i=o(4023);const s=e=>void 0===e||""===e||"number"==typeof e&&isNaN(e)?i.j:e},8326:(e,t,o)=>{o.p=window.__kbnPublicPath__.sessionView},8744:(e,t,o)=>{o.r(t);var i=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},409:(e,t,o)=>{o.r(t);var i=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},3185:(e,t,o)=>{e.exports=o(2497)(51858)},1319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},6791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},5008:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},5879:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18nReact},3803:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnUiTheme},770:e=>{"use strict";e.exports=__kbnSharedDeps__.Lodash},4286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},3530:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactQuery},1941:e=>{"use strict";e.exports=__kbnSharedDeps__.TsLib},9472:e=>{"use strict";e.exports=__kbnSharedDeps__.Uuid},2497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={id:e,exports:{}};return o[e](n,n.exports,s),n.exports}s.m=o,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,o)=>(s.f[o](e,t),t)),[])),s.u=e=>"sessionView.chunk."+e+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="@kbn/session-view-plugin:",s.l=(o,i,n,r)=>{if(e[o])e[o].push(i);else{var a,l;if(void 0!==n)for(var u=document.getElementsByTagName("script"),d=0;d<u.length;d++){var c=u[d];if(c.getAttribute("src")==o||c.getAttribute("data-webpack")==t+n){a=c;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",t+n),a.src=o),e[o]=[i];var p=(t,i)=>{a.onerror=a.onload=null,clearTimeout(m);var s=e[o];if(delete e[o],a.parentNode&&a.parentNode.removeChild(a),s&&s.forEach((e=>e(i))),t)return t(i)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),l&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var i=o.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=o[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={86:0};s.f.j=(t,o)=>{var i=s.o(e,t)?e[t]:void 0;if(0!==i)if(i)o.push(i[2]);else{var n=new Promise(((o,s)=>i=e[t]=[o,s]));o.push(i[2]=n);var r=s.p+s.u(t),a=new Error;s.l(r,(o=>{if(s.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var n=o&&("load"===o.type?"missing":o.type),r=o&&o.target&&o.target.src;a.message="Loading chunk "+t+" failed.\n("+n+": "+r+")",a.name="ChunkLoadError",a.type=n,a.request=r,i[1](a)}}),"chunk-"+t,t)}};var t=(t,o)=>{var i,n,[r,a,l]=o,u=0;if(r.some((t=>0!==e[t]))){for(i in a)s.o(a,i)&&(s.m[i]=a[i]);l&&l(s)}for(t&&t(o);u<r.length;u++)n=r[u],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0},o=self.sessionView_bundle_jsonpfunction=self.sessionView_bundle_jsonpfunction||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})(),s.nc=void 0,s(8326),__kbnBundles__.define("plugin/sessionView/public",s,6858)})();