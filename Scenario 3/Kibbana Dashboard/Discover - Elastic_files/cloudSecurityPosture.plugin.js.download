/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e,t={6836:(e,t,r)=>{"use strict";r.d(t,{$J:()=>f,DT:()=>d,DV:()=>o,Du:()=>h,IM:()=>b,Ie:()=>i,a:()=>u,ff:()=>m,hq:()=>_,kh:()=>p,le:()=>v,nR:()=>g,nW:()=>a,nx:()=>l,rp:()=>n,s0:()=>c,uf:()=>s});const s="kspm",i="cspm",n="logs-cloud_security_posture.findings_latest-default,security_solution-*.misconfiguration_latest",a="26h",o=500,u="/internal/cloud_security_posture/rules/_get_states",c="1",l="/internal/cloud_security_posture/status",d="1",p="/cloud_security_posture",_="security_solution_cdr_latest_misconfigurations",b="security-solution-default",h="security_solution-*.vulnerability_latest,logs-cloud_security_posture.vulnerabilities_latest-default",g="3d",f="90d",v={LOW:"LOW",MEDIUM:"MEDIUM",HIGH:"HIGH",CRITICAL:"CRITICAL",UNKNOWN:"UNKNOWN"},m={PASSED:"passed",FAILED:"failed",UNKNOWN:"unknown"}},6479:(e,t,r)=>{"use strict";r.d(t,{UM:()=>o,Vi:()=>i,eH:()=>a,j9:()=>n,nW:()=>u,sQ:()=>l,yZ:()=>c});var s=r(8915);const i="create-detection-rule-from-flyout",n="create-detection-from-table-row-action",a="vulnerabilities-flyout-visits",o="open-findings-flyout",u="group-by-click",c="change-rule-state",l=new class UiMetricService{constructor(){(0,s.default)(this,"usageCollection",void 0)}setup(e){this.usageCollection=e}track(e,t){if(this.usageCollection)return this.usageCollection.reportUiCounter("cloud-security",e,t)}trackUiMetric(e,t){return this.track(e,t)}}},6454:(e,t,r)=>{"use strict";r.d(t,{O:()=>n,t:()=>a});var s=r(6836),i=r(5008);const n={DASHBOARD:i.i18n.translate("securitySolutionPackages.csp.navigation.dashboardNavItemLabel",{defaultMessage:"Cloud Security Posture"}),VULNERABILITY_DASHBOARD:i.i18n.translate("securitySolutionPackages.csp.navigation.vulnerabilityDashboardNavItemLabel",{defaultMessage:"Cloud Native Vulnerability Management"}),FINDINGS:i.i18n.translate("securitySolutionPackages.csp.navigation.findingsNavItemLabel",{defaultMessage:"Findings"}),BENCHMARKS:i.i18n.translate("securitySolutionPackages.csp.navigation.findingsNavItemLabel",{defaultMessage:"Benchmarks"}),RULES:i.i18n.translate("securitySolutionPackages.csp.navigation.rulesNavItemLabel",{defaultMessage:"Rules"})},a={findings_default:{name:n.FINDINGS,path:`${s.kh}/findings/configurations`,id:"cloud_security_posture-findings-default"},findings_by_resource:{name:n.FINDINGS,path:`${s.kh}/findings/resource`,id:"cloud_security_posture-findings-resource"},resource_findings:{name:n.FINDINGS,path:`${s.kh}/findings/resource/:resourceId`,id:"cloud_security_posture-findings-resourceId"},vulnerabilities:{name:n.FINDINGS,path:`${s.kh}/findings/vulnerabilities`,id:"cloud_security_posture-findings-vulnerabilities"},vulnerabilities_by_resource:{name:n.FINDINGS,path:`${s.kh}/findings/vulnerabilities/resource`,id:"cloud_security_posture-findings-vulnerabilities-resource"},resource_vulnerabilities:{name:n.FINDINGS,path:`${s.kh}/findings/vulnerabilities/resource/:resourceId`,id:"cloud_security_posture-findings-vulnerabilities-resourceId"}}},2787:(e,t,r)=>{"use strict";r.d(t,{As:()=>S,Bj:()=>K,CW:()=>v,Ej:()=>g,Gn:()=>T,Gv:()=>P,HN:()=>$,HZ:()=>d,I1:()=>x,J$:()=>R,JW:()=>O,Kn:()=>n,Kv:()=>u,LK:()=>c,Nj:()=>C,OB:()=>o,P2:()=>k,Qn:()=>j,S0:()=>L,Um:()=>_,Ur:()=>U,_M:()=>i,bc:()=>h,c3:()=>A,cs:()=>N,hq:()=>F,iW:()=>w,jd:()=>y,nG:()=>D,ot:()=>E,rc:()=>f,tC:()=>p,tc:()=>b,vO:()=>a,wb:()=>l,yL:()=>I,zl:()=>m});var s=r(6836);const i="/internal/cloud_security_posture/stats/{policy_template}",n="/internal/cloud_security_posture/vulnerabilities_dashboard",a="/internal/cloud_security_posture/benchmarks",o="/internal/cloud_security_posture/rules/_find",u="/internal/cloud_security_posture/rules/_bulk_action",c="/internal/cloud_security_posture/detection_engine_rules/alerts/_status",l="1",d="2023-10-31",p="cloud_security_posture",_="logs-cloud_security_posture.findings",b="logs-cloud_security_posture.findings-default*",h="security_solution_cdr_latest_vulnerabilities",g="logs-cloud_security_posture.vulnerabilities",f="logs-cloud_security_posture.vulnerabilities-default*",v="passed",m="failed",y={showManageRulesMock:!1,showFindingFlyoutEvidence:!0},k="csp-rule-template",S="cloudbeat/cis_k8s",x="cloudbeat/cis_eks",w="cloudbeat/cis_aws",D="cloudbeat/cis_gcp",P="cloudbeat/cis_azure",I="cloudbeat/vuln_mgmt_aws",j="cis_aws",C="cis_gcp",O="cis_k8s",E="cis_eks",N="cis_azure",A="vuln_mgmt",R="cnvm",U=[s.uf,s.Ie,A],$=[S,x,w,D,P,I,"cloudbeat/vuln_mgmt_gcp","cloudbeat/vuln_mgmt_azure"],L=(s.uf,s.uf,s.Ie,s.Ie,"ACCOUNT_TYPE"),T="organization-account",F="single-account",K="1.11.0-preview13"},6522:(e,t,r)=>{"use strict";r.d(t,{P:()=>s});const s=(0,r(4286).createContext)({})},9824:(e,t,r)=>{"use strict";r.d(t,{Fl:()=>o,i5:()=>a,qc:()=>c});var s=r(6836),i=r(6454),n=r(2787);const a={dashboard:{name:i.O.DASHBOARD,path:`${s.kh}/dashboard`,id:"cloud_security_posture-dashboard"},cspm_dashboard:{name:"Cloud",path:`${s.kh}/dashboard/${s.Ie}`,id:"cloud_security_posture-cspm-dashboard"},kspm_dashboard:{name:"Kubernetes",path:`${s.kh}/dashboard/${s.uf}`,id:"cloud_security_posture-kspm-dashboard"},vulnerability_dashboard:{name:i.O.VULNERABILITY_DASHBOARD,path:`${s.kh}/vulnerability_dashboard`,id:"cloud_security_posture-vulnerability_dashboard"},findings:{name:i.O.FINDINGS,path:`${s.kh}/findings`,id:"cloud_security_posture-findings"},benchmarks:{name:i.O.BENCHMARKS,path:`${s.kh}/benchmarks`,id:"cloud_security_posture-benchmarks"}},o={rules:{name:i.O.RULES,path:`${s.kh}/benchmarks/:benchmarkId/:benchmarkVersion/rules/:ruleId?`,id:"cloud_security_posture-benchmarks-rules"}},u="https://ela.st",c={kspm:{overviewPath:`${u}/${s.uf}`,getStartedPath:`${u}/${s.uf}-get-started`},cspm:{overviewPath:`${u}/${s.Ie}`,getStartedPath:`${u}/${s.Ie}-get-started`,awsGetStartedPath:"https://www.elastic.co/guide/en/security/current/cspm-get-started.html",gcpGetStartedPath:"https://www.elastic.co/guide/en/security/current/cspm-get-started-gcp.html",azureGetStartedPath:"https://www.elastic.co/guide/en/security/current/cspm-get-started-azure.html"},cnvm:{overviewPath:`${u}/${n.J$}`}}},5040:(e,t,r)=>{"use strict";r.d(t,{S:()=>a});var s=r(1319),i=(r(4286),r(8371)),n=r(6791);const a=({children:e,...t})=>(0,n.jsx)(i.o,{"data-test-subj":t["data-test-subj"]},(0,n.jsx)(s.EuiLoadingSpinner,{size:"xl"}),(0,n.jsx)(s.EuiSpacer,null),e)},8371:(e,t,r)=>{"use strict";r.d(t,{o:()=>o});var s=r(3185),i=r(1319),n=r(6791);r(4286);var a={name:"1oqx798",styles:"min-height:calc(100vh - 250px)"};const o=({children:e,...t})=>(0,n.jsx)(i.EuiFlexGroup,(0,s.default)({css:a,justifyContent:"center",alignItems:"center",direction:"column"},t),e)},9536:(e,t,r)=>{"use strict";r.r(t),r.d(t,{getSecuritySolutionLink:()=>C,plugin:()=>O});var s=r(8915),i=r(4286),n=r.n(i),a=r(409),o=r(1215),u=r(3185),c=r(7880),l=r(6791);const d=n().createContext(null),p=({children:e,...t})=>{const{navigateToUrl:r,currentAppId:s}=t;return(0,l.jsx)(d.Provider,{value:{navigateToUrl:r,currentAppId:s}},e)},_=({children:e,coreStart:t})=>{const{navigateToUrl:r,currentAppId$:s}=t.application,i=(0,c.A)(s,void 0);return(0,l.jsx)(d.Provider,{value:{navigateToUrl:r,currentAppId:i}},e)},b={name:"h42ud6",styles:"display:inherit;height:inherit;width:inherit;flex:1;flex-flow:column nowrap"},h=({children:e,navigateToUrl:t,currentAppId:r,...s})=>{const n=(0,i.useRef)(null),a=(0,i.useCallback)((e=>(({event:e,container:t,navigateToUrl:r,currentAppId:s})=>{if(!t||!s)return;const i=((e,t)=>{let r=e;do{var s,i;if("a"===(null===(s=r)||void 0===s?void 0:s.tagName.toLowerCase()))return r;const e=null===(i=r)||void 0===i?void 0:i.parentElement;if(!e||e===document.body||e===t)break;r=e}while(parent||parent!==document.body||parent!==t)})(e.target,t);if(!i)return;const n=i.href,a=""===i.target||"_self"===i.target,o=0===e.button;n&&a&&o&&!e.defaultPrevented&&!(e=>e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)(e)&&(e.preventDefault(),r(i.href))})({event:e,currentAppId:r,navigateToUrl:t,container:n.current})),[r,t]);return(0,l.jsx)("div",(0,u.default)({onClick:a,ref:n,css:b,"data-test-subj":"kbnRedirectAppLink"},s),e)},g=({children:e,...t})=>(0,l.jsx)(h,(0,u.default)({},function(){const e=(0,i.useContext)(d);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}(),t),e),f=({children:e,...t})=>{if(void 0!==t.coreStart){const{coreStart:r,...s}=t,i=(0,l.jsx)(g,s,e);return(0,l.jsx)(_,{coreStart:r},i)}const{navigateToUrl:r,currentAppId:s,...i}=t,n=(0,l.jsx)(g,i,e);return(0,l.jsx)(p,{currentAppId:s,navigateToUrl:r},n)};var v=r(6479),m=r(5040),y=r(2787),k=r(6522);const S=Object.freeze({cloudConnectorsEnabled:!1}),x=Object.keys(S);class ExperimentalFeaturesService{static init({experimentalFeatures:e}){this.experimentalFeatures=e}static get(){return this.experimentalFeatures||this.throwUninitializedError(),this.experimentalFeatures}static throwUninitializedError(){throw new Error("Technical preview features services not initialized - are you trying to import this module from outside of the Security Solution app?")}}(0,s.default)(ExperimentalFeaturesService,"experimentalFeatures",void 0);const w=(0,i.lazy)((()=>Promise.all([r.e(806),r.e(412)]).then(r.bind(r,6412)))),D=(0,i.lazy)((()=>r.e(460).then(r.bind(r,7460)))),P=(0,i.lazy)((()=>Promise.all([r.e(806),r.e(990)]).then(r.bind(r,2599)))),I=e=>(0,l.jsx)(i.Suspense,{fallback:(0,l.jsx)(m.S,null)},(0,l.jsx)(P,e));class CspPlugin{constructor(e){var t;(0,s.default)(this,"isCloudEnabled",void 0),(0,s.default)(this,"config",void 0),(0,s.default)(this,"experimentalFeatures",void 0),this.initializerContext=e,this.config=this.initializerContext.config.get(),this.experimentalFeatures=null===(t=(e=>{const t={},r=[];for(const s of e)x.includes(s)?t[s]=!0:r.push(s);return{features:{...S,...t},invalid:r}})(this.config.enableExperimental||[]))||void 0===t?void 0:t.features}setup(e,t){return this.isCloudEnabled=t.cloud.isCloudEnabled,t.usageCollection&&v.sQ.setup(t.usageCollection),{}}start(e,t){ExperimentalFeaturesService.init({experimentalFeatures:this.experimentalFeatures}),t.fleet.registerExtension({package:y.tC,view:"package-policy-replace-define-step",Component:w}),t.fleet.registerExtension({package:y.tC,view:"package-detail-assets",Component:D});const r=new o.Storage(localStorage),s=s=>(0,l.jsx)(a.KibanaContextProvider,{services:{...e,...t,storage:r}},(0,l.jsx)(f,{coreStart:e},(0,l.jsx)("div",{style:{width:"100%",height:"100%"}},(0,l.jsx)(k.P.Provider,{value:{isCloudEnabled:this.isCloudEnabled}},(0,l.jsx)(I,s)))));return{getCloudSecurityPostureRouter:()=>s}}stop(){}}var j=r(9824);const C=e=>({id:j.i5[e].id,title:j.i5[e].name,path:j.i5[e].path}),O=e=>new CspPlugin(e)},6943:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r(4286),i="undefined"!=typeof window?s.useLayoutEffect:s.useEffect;t.default=i},7880:(e,t,r)=>{"use strict";var s=r(1941),i=r(4286),n=s.__importDefault(r(6943));t.A=function(e,t){var r=i.useState(t),s=r[0],a=r[1];return n.default((function(){var t=e.subscribe(a);return function(){return t.unsubscribe()}}),[e]),s}},5742:(e,t,r)=>{r.p=window.__kbnPublicPath__.cloudSecurityPosture},7195:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},4627:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},5245:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/fleet/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},9589:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/fleet/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},2137:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/kibanaReact/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},409:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},1215:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},1254:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/spaces/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},4205:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/usageCollection/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},3185:(e,t,r)=>{e.exports=r(2497)(51858)},8915:(e,t,r)=>{e.exports=r(2497)(67493)},5927:e=>{"use strict";e.exports=__kbnSharedDeps__.Classnames},3059:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticCharts},1319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},6752:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticNumeral},6791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},3782:e=>{"use strict";e.exports=__kbnSharedDeps__.IoTs},6744:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnAnalytics},9424:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnCodeEditor},5964:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnEsQuery},5008:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},5879:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18nReact},911:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnMonaco},482:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnReactKibanaContextRender},8376:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnRison},1728:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnSharedUxErrorBoundary},193:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnSharedUxRouter},9433:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnStd},3803:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnUiTheme},770:e=>{"use strict";e.exports=__kbnSharedDeps__.Lodash},1060:e=>{"use strict";e.exports=__kbnSharedDeps__.LodashFp},1783:e=>{"use strict";e.exports=__kbnSharedDeps__.Moment},4286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},2874:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactDom},3530:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactQuery},1493:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactRouterDom},190:e=>{"use strict";e.exports=__kbnSharedDeps__.Rxjs},1941:e=>{"use strict";e.exports=__kbnSharedDeps__.TsLib},9472:e=>{"use strict";e.exports=__kbnSharedDeps__.Uuid},2497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},r={};function s(e){var i=r[e];if(void 0!==i)return i.exports;var n=r[e]={id:e,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.exports}s.m=t,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,r)=>(s.f[r](e,t),t)),[])),s.u=e=>"cloudSecurityPosture.chunk."+e+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},s.l=(t,r,i,n)=>{if(e[t])e[t].push(r);else{var a,o;if(void 0!==i)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var l=u[c];if(l.getAttribute("src")==t){a=l;break}}a||(o=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.src=t),e[t]=[r];var d=(r,s)=>{a.onerror=a.onload=null,clearTimeout(p);var i=e[t];if(delete e[t],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(s))),r)return r(s)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),o&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=r[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={568:0};s.f.j=(t,r)=>{var i=s.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var n=new Promise(((r,s)=>i=e[t]=[r,s]));r.push(i[2]=n);var a=s.p+s.u(t),o=new Error;s.l(a,(r=>{if(s.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var n=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+n+": "+a+")",o.name="ChunkLoadError",o.type=n,o.request=a,i[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,n,[a,o,u]=r,c=0;if(a.some((t=>0!==e[t]))){for(i in o)s.o(o,i)&&(s.m[i]=o[i]);u&&u(s)}for(t&&t(r);c<a.length;c++)n=a[c],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0},r=self.cloudSecurityPosture_bundle_jsonpfunction=self.cloudSecurityPosture_bundle_jsonpfunction||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),s.nc=void 0,s(5742),__kbnBundles__.define("plugin/cloudSecurityPosture/public",s,9536)})();