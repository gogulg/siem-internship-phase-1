/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var t={464:(t,n,e)=>{"use strict";e.r(n),e.d(n,{ACTIONS_FEATURE_ID:()=>Q,ALERT_HISTORY_PREFIX:()=>u,AlertHistoryDefaultIndexName:()=>l,AlertHistoryDocumentTemplate:()=>d,AlertHistoryEsIndexConnectorId:()=>s,AlertingConnectorFeature:()=>D,AlertingConnectorFeatureId:()=>S,BASE_ACTION_API_PATH:()=>Z,CasesConnectorFeature:()=>G,CasesConnectorFeatureId:()=>_,DEFAULT_MICROSOFT_EXCHANGE_URL:()=>tt,DEFAULT_MICROSOFT_GRAPH_API_SCOPE:()=>et,DEFAULT_MICROSOFT_GRAPH_API_URL:()=>nt,EMPTY_EXECUTION_KPI_RESULT:()=>K,EndpointSecurityConnectorFeature:()=>q,EndpointSecurityConnectorFeatureId:()=>w,GenerativeAIForObservabilityConnectorFeatureId:()=>C,GenerativeAIForObservabilityFeature:()=>H,GenerativeAIForSearchPlaygroundConnectorFeatureId:()=>E,GenerativeAIForSearchPlaygroundFeature:()=>$,GenerativeAIForSecurityConnectorFeatureId:()=>x,GenerativeAIForSecurityFeature:()=>U,INTERNAL_BASE_ACTION_API_PATH:()=>J,InvalidEmailReason:()=>r,MustacheInEmailRegExp:()=>f,SecurityConnectorFeatureId:()=>F,SecuritySolutionFeature:()=>j,UptimeConnectorFeature:()=>L,UptimeConnectorFeatureId:()=>I,areValidFeatures:()=>V,buildAlertHistoryDocument:()=>c,executionLogSortableColumns:()=>W,getConnectorCompatibility:()=>z,getConnectorFeatureName:()=>X,hasMustacheTemplate:()=>p,invalidEmailsAsMessage:()=>y,isActionTypeExecutorResult:()=>a,validateEmailAddresses:()=>h,validateEmailAddressesAsAlwaysValid:()=>v,validateEmptyStrings:()=>Y,withoutMustacheTemplate:()=>m});let r=function(t){return t.invalid="invalid",t.notAllowed="notAllowed",t}({});const i=["ok","error"];function a(t){const n=t;return n&&"string"==typeof(null==n?void 0:n.actionId)&&i.includes(null==n?void 0:n.status)}const o=__kbnSharedDeps__.Lodash,u="kibana-alert-history-",l=`${u}default`,s="preconfigured-alert-history-es-index",c=t=>{const{date:n,alert:e,context:r,params:i,tags:a,rule:u}=t;if(!e||!u)return null;const{actionGroup:l,actionGroupName:s,id:c}=e,{id:d,name:f,spaceId:p,type:m}=u;if(!m)return null;const g=m.replace(/\./g,"__"),v={...d?{id:d}:{},...f?{name:f}:{},...(0,o.isEmpty)(i)?{}:{params:{[g]:i}},...p?{space:p}:{},...m?{type:m}:{}},h={...c?{id:c}:{},...(0,o.isEmpty)(r)?{}:{context:{[g]:r}},...l?{actionGroup:l}:{},...s?{actionGroupName:s}:{}},y={"@timestamp":n||(new Date).toISOString(),...a&&a.length>0?{tags:a}:{},...null!=r&&r.message?{message:r.message}:{},...(0,o.isEmpty)(v)?{}:{rule:v},...(0,o.isEmpty)(h)?{}:{kibana:{alert:h}}};return(0,o.isEmpty)(y)?null:{...y,event:{kind:"alert"}}},d=Object.freeze(c({rule:{id:"{{rule.id}}",name:"{{rule.name}}",type:"{{rule.type}}",spaceId:"{{rule.spaceId}}"},context:"{{context}}",params:"{{rule.params}}",tags:"{{rule.tags}}",alert:{id:"{{alert.id}}",actionGroup:"{{alert.actionGroup}}",actionGroupName:"{{alert.actionGroupName}}"}})),f=/\{\{((.|\n)*)\}\}/;function p(t){return!!t.match(f)}function m(t){return t.filter((t=>!p(t)))}var g=e(443);function v(t){return t.map((t=>({address:t,valid:!0})))}function h(t,n,e={}){return n.map((n=>function(t,n,e){if(e.treatMustacheTemplatesAsValid&&p(n))return{address:n,valid:!0};try{return function(t,n){const e=(0,g.parseAddressList)(n);if(null==e)return{address:n,valid:!1,reason:r.invalid};if(null!==t){const i=new Set(t);for(const t of e){let e=[];if("group"===t.type)e=t.addresses.map((t=>t.domain));else{if("mailbox"!==t.type)return{address:n,valid:!1,reason:r.invalid};e=[t.domain]}for(const t of e)if(!i.has(t))return{address:n,valid:!1,reason:r.notAllowed}}}return{address:n,valid:!0}}(t,n)}catch(t){return{address:n,valid:!1,reason:r.invalid}}}(t,n,e)))}function y(t){const n=t.filter((t=>!t.valid&&t.reason===r.invalid)),e=t.filter((t=>!t.valid&&t.reason===r.notAllowed)),i=[];if(0!==n.length&&i.push(`not valid emails: ${b(n).join(", ")}`),0!==e.length&&i.push(`not allowed emails: ${b(e).join(", ")}`),0!==i.length)return i.join("; ")}function b(t){return t.map((t=>t.address))}const A=__kbnSharedDeps__.KbnI18n,S="alerting",_="cases",I="uptime",F="siem",x="generativeAIForSecurity",C="generativeAIForObservability",E="generativeAIForSearchPlayground",w="endpointSecurity",T=A.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.endpointSecurity",{defaultMessage:"Endpoint Security"}),O=A.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.generativeAIForSecurity",{defaultMessage:"Generative AI for Security"}),k=A.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.generativeAIForObservability",{defaultMessage:"Generative AI for Observability"}),P=A.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.generativeAIForSearchPlayground",{defaultMessage:"Generative AI for Search"}),R=A.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.alertingRules",{defaultMessage:"Alerting Rules"}),M=A.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.securitySolution",{defaultMessage:"Security Solution"}),N=A.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.cases",{defaultMessage:"Cases"}),D={id:S,name:A.i18n.translate("xpack.actions.availableConnectorFeatures.alerting",{defaultMessage:"Alerting"}),compatibility:R},G={id:_,name:A.i18n.translate("xpack.actions.availableConnectorFeatures.cases",{defaultMessage:"Cases"}),compatibility:N},L={id:I,name:A.i18n.translate("xpack.actions.availableConnectorFeatures.uptime",{defaultMessage:"Uptime"}),compatibility:R},j={id:F,name:A.i18n.translate("xpack.actions.availableConnectorFeatures.securitySolution",{defaultMessage:"Security Solution"}),compatibility:M},U={id:x,name:O,compatibility:O},H={id:C,name:k,compatibility:k},$={id:E,name:P,compatibility:P},q={id:w,name:T,compatibility:T},B={[D.id]:D,[G.id]:G,[L.id]:L,[j.id]:j,[U.id]:U,[H.id]:H,[$.id]:$,[q.id]:q};function V(t){return t.every((t=>!!B[t]))}function X(t){const n=B[t];return n?n.name:t}function z(t){const n=new Set;if(t&&t.length>0)for(const e of t)B[e]&&n.add(B[e].compatibility);return Array.from(n)}const K={success:0,unknown:0,failure:0,warning:0},W=["timestamp","execution_duration","schedule_delay"];function Y(t){if((0,o.isString)(t)){if(""===t.trim())throw new Error("value '' is not valid")}else Array.isArray(t)?t.forEach((t=>{Y(t)})):(0,o.isObject)(t)&&(0,o.keys)(t).forEach((n=>{Y((0,o.get)(t,n))}))}const Z="/api/actions",J="/internal/actions",Q="actions",tt="https://login.microsoftonline.com",nt="https://graph.microsoft.com/v1.0",et="https://graph.microsoft.com/.default"},11:(t,n,e)=>{"use strict";e.r(n),e.d(n,{Plugin:()=>Plugin,plugin:()=>a});var r=e(915),i=e(464);class Plugin{constructor(t){var n;(0,r.default)(this,"allowedEmailDomains",null);const e=t.config.get();this.allowedEmailDomains=(null===(n=e.email)||void 0===n?void 0:n.domain_allowlist)||null}setup(){return{validateEmailAddresses:(t,n)=>(0,i.validateEmailAddresses)(this.allowedEmailDomains,t,n)}}start(){}}function a(t){return new Plugin(t)}},443:function(t){!function(n){"use strict";function e(t){function n(){return Ft<xt}function e(){return Ft}function i(t){Ft=t}function a(){Ft=0,xt=It.length}function o(t,n){return{name:t,tokens:n||"",semantic:n||"",children:[]}}function u(t,n){var e;return null===n?null:((e=o(t)).tokens=n.tokens,e.semantic=n.semantic,e.children.push(n),e)}function l(t,n){return null!==n&&(t.tokens+=n.tokens,t.semantic+=n.semantic),t.children.push(n),t}function s(t){var e;return n()&&t(e=It[Ft])?(Ft+=1,o("token",e)):null}function c(){return null}function d(t){return function(){return u("literal",s((function(n){return n===t})))}}function f(){var t=arguments;return function(){var n,r,a,u;for(u=e(),r=o("and"),n=0;n<t.length;n+=1){if(null===(a=t[n]()))return i(u),null;l(r,a)}return r}}function p(){var t=arguments;return function(){var n,r,a;for(a=e(),n=0;n<t.length;n+=1){if(null!==(r=t[n]()))return r;i(a)}return null}}function m(t){return function(){var n,r;return r=e(),null!==(n=t())?n:(i(r),o("opt"))}}function g(t){return function(){var n=t();return null!==n&&(n.semantic=""),n}}function v(t){return function(){var n=t();return null!==n&&n.semantic.length>0&&(n.semantic=" "),n}}function h(t,n){return function(){var r,a,u,s,c;for(s=e(),r=o("star"),u=0,c=void 0===n?0:n;null!==(a=t());)u+=1,l(r,a);return u>=c?r:(i(s),null)}}function y(t){return t.charCodeAt(0)>=128}function b(){return u("cr",d("\r")())}function A(){return u("crlf",f(b,I)())}function S(){return u("dquote",d('"')())}function _(){return u("htab",d("\t")())}function I(){return u("lf",d("\n")())}function F(){return u("sp",d(" ")())}function x(){return u("vchar",s((function(n){var e=n.charCodeAt(0),r=33<=e&&e<=126;return t.rfc6532&&(r=r||y(n)),r})))}function C(){return u("wsp",p(F,_)())}function E(){var t=u("quoted-pair",p(f(d("\\"),p(x,C)),it)());return null===t?null:(t.semantic=t.semantic[1],t)}function w(){return u("fws",p(ot,f(m(f(h(C),g(A))),h(C,1)))())}function T(){return u("ctext",p((function(){return s((function(n){var e=n.charCodeAt(0),r=33<=e&&e<=39||42<=e&&e<=91||93<=e&&e<=126;return t.rfc6532&&(r=r||y(n)),r}))}),et)())}function O(){return u("ccontent",p(T,E,k)())}function k(){return u("comment",f(d("("),h(f(m(w),O)),m(w),d(")"))())}function P(){return u("cfws",p(f(h(f(m(w),k),1),m(w)),w)())}function R(){return u("atext",s((function(n){var e="a"<=n&&n<="z"||"A"<=n&&n<="Z"||"0"<=n&&n<="9"||["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(n)>=0;return t.rfc6532&&(e=e||y(n)),e})))}function M(){return u("atom",f(v(m(P)),h(R,1),v(m(P)))())}function N(){var t,n;return null===(t=u("dot-atom-text",h(R,1)()))||null!==(n=h(f(d("."),h(R,1)))())&&l(t,n),t}function D(){return u("dot-atom",f(g(m(P)),N,g(m(P)))())}function G(){return u("qtext",p((function(){return s((function(n){var e=n.charCodeAt(0),r=33===e||35<=e&&e<=91||93<=e&&e<=126;return t.rfc6532&&(r=r||y(n)),r}))}),rt)())}function L(){return u("qcontent",p(G,E)())}function j(){return u("quoted-string",f(g(m(P)),g(S),h(f(m(v(w)),L)),m(g(w)),g(S),g(m(P)))())}function U(){return u("word",p(M,j)())}function H(){return u("address",p($,V)())}function $(){return u("mailbox",p(q,tt)())}function q(){return u("name-addr",f(m(X),B)())}function B(){return u("angle-addr",p(f(g(m(P)),d("<"),tt,d(">"),g(m(P))),ut)())}function V(){return u("group",f(X,d(":"),m(W),d(";"),g(m(P)))())}function X(){return u("display-name",(null!==(t=u("phrase",p(at,h(U,1))()))&&(t.semantic=t.semantic.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")),t));var t}function z(){return u("mailbox-list",p(f($,h(f(d(","),$))),ct)())}function K(){return u("address-list",p(f(H,h(f(d(t.addressListSeparator),H))),dt)())}function W(){return u("group-list",p(z,g(P),ft)())}function Y(){return u("local-part",p(pt,D,j)())}function Z(){return u("dtext",p((function(){return s((function(n){var e=n.charCodeAt(0),r=33<=e&&e<=90||94<=e&&e<=126;return t.rfc6532&&(r=r||y(n)),r}))}),gt)())}function J(){return u("domain-literal",f(g(m(P)),d("["),h(f(m(w),Z)),m(w),d("]"),g(m(P)))())}function Q(){return u("domain",(n=p(mt,D,J)(),t.rejectTLD&&n&&n.semantic&&n.semantic.indexOf(".")<0?null:(n&&(n.semantic=n.semantic.replace(/\s+/g,"")),n)));var n}function tt(){return u("addr-spec",f(Y,d("@"),Q)())}function nt(){return t.strict?null:u("obs-NO-WS-CTL",s((function(t){var n=t.charCodeAt(0);return 1<=n&&n<=8||11===n||12===n||14<=n&&n<=31||127===n})))}function et(){return t.strict?null:u("obs-ctext",nt())}function rt(){return t.strict?null:u("obs-qtext",nt())}function it(){return t.strict?null:u("obs-qp",f(d("\\"),p(d("\0"),nt,I,b))())}function at(){return t.strict?null:u("obs-phrase",f(U,h(p(U,d("."),t.atInDisplayName?d("@"):c,t.commaInDisplayName?d(","):c,v(P))))())}function ot(){return t.strict?null:u("obs-FWS",h(f(g(m(A)),C),1)())}function ut(){return t.strict?null:u("obs-angle-addr",f(g(m(P)),d("<"),lt,tt,d(">"),g(m(P)))())}function lt(){return t.strict?null:u("obs-route",f(st,d(":"))())}function st(){return t.strict?null:u("obs-domain-list",f(h(p(g(P),d(","))),d("@"),Q,h(f(d(","),g(m(P)),m(f(d("@"),Q)))))())}function ct(){return t.strict?null:u("obs-mbox-list",f(h(f(g(m(P)),d(","))),$,h(f(d(","),m(f($,g(P))))))())}function dt(){return t.strict?null:u("obs-addr-list",f(h(f(g(m(P)),d(","))),H,h(f(d(","),m(f(H,g(P))))))())}function ft(){return t.strict?null:u("obs-group-list",f(h(f(g(m(P)),d(",")),1),g(m(P)))())}function pt(){return t.strict?null:u("obs-local-part",f(U,h(f(d("."),U)))())}function mt(){return t.strict?null:u("obs-domain",f(M,h(f(d("."),M)))())}function gt(){return t.strict?null:u("obs-dtext",p(nt,E)())}function vt(t,n){var e,r,i;if(null==n)return null;for(r=[n];r.length>0;){if((i=r.pop()).name===t)return i;for(e=i.children.length-1;e>=0;e-=1)r.push(i.children[e])}return null}function ht(t,n){var e,r,i,a,o;if(null==n)return null;for(r=[n],a=[],o={},e=0;e<t.length;e+=1)o[t[e]]=!0;for(;r.length>0;)if((i=r.pop()).name in o)a.push(i);else for(e=i.children.length-1;e>=0;e-=1)r.push(i.children[e]);return a}function yt(n){var e,r,i,a,o;if(null===n)return null;for(e=[],r=ht(["group","mailbox"],n),i=0;i<r.length;i+=1)"group"===(a=r[i]).name?e.push(bt(a)):"mailbox"===a.name&&e.push(At(a));return o={ast:n,addresses:e},t.simple&&(o=function(t){var n;if(t&&t.addresses)for(n=0;n<t.addresses.length;n+=1)delete t.addresses[n].node;return t}(o)),t.oneResult?function(n){return n?!t.partial&&n.addresses.length>1?null:n.addresses&&n.addresses[0]:null}(o):t.simple?o&&o.addresses:o}function bt(t){var n,e=vt("display-name",t),r=[],i=ht(["mailbox"],t);for(n=0;n<i.length;n+=1)r.push(At(i[n]));return{node:t,parts:{name:e},type:t.name,name:St(e),addresses:r}}function At(t){var n=vt("display-name",t),e=vt("addr-spec",t),r=function(t,n){var e,r,i,a;if(null==n)return null;for(r=[n],a=[];r.length>0;)for("cfws"===(i=r.pop()).name&&a.push(i),e=i.children.length-1;e>=0;e-=1)r.push(i.children[e]);return a}(0,t),i=ht(["comment"],t),a=vt("local-part",e),o=vt("domain",e);return{node:t,parts:{name:n,address:e,local:a,domain:o,comments:r},type:t.name,name:St(n),address:St(e),local:St(a),domain:St(o),comments:_t(i),groupName:St(t.groupName)}}function St(t){return null!=t?t.semantic:null}function _t(t){var n="";if(t)for(var e=0;e<t.length;e+=1)n+=St(t[e]);return n}var It,Ft,xt,Ct,Et;if(null===(t=r(t,{})))return null;if(It=t.input,Et={address:H,"address-list":K,"angle-addr":B,from:function(){return u("from",p(z,K)())},group:V,mailbox:$,"mailbox-list":z,"reply-to":function(){return u("reply-to",K())},sender:function(){return u("sender",p($,H)())}}[t.startAt]||K,!t.strict){if(a(),t.strict=!0,Ct=Et(It),t.partial||!n())return yt(Ct);t.strict=!1}return a(),Ct=Et(It),!t.partial&&n()?null:yt(Ct)}function r(t,n){function e(t){return"[object String]"===Object.prototype.toString.call(t)}function r(t){return null==t}var i,a;if(e(t))t={input:t};else if(!function(t){return t===Object(t)}(t))return null;if(!e(t.input))return null;if(!n)return null;for(a in i={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1,atInDisplayName:!1,commaInDisplayName:!1,addressListSeparator:","})r(t[a])&&(t[a]=r(n[a])?i[a]:n[a]);return t}e.parseOneAddress=function(t){return e(r(t,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))},e.parseAddressList=function(t){return e(r(t,{rfc6532:!0,simple:!0,startAt:"address-list"}))},e.parseFrom=function(t){return e(r(t,{rfc6532:!0,simple:!0,startAt:"from"}))},e.parseSender=function(t){return e(r(t,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))},e.parseReplyTo=function(t){return e(r(t,{rfc6532:!0,simple:!0,startAt:"reply-to"}))},void 0!==t.exports?t.exports=e:n.emailAddresses=e}(this)},244:(t,n,e)=>{e.p=window.__kbnPublicPath__.actions},915:(t,n,e)=>{t.exports=e(497)(67493)},497:t=>{"use strict";t.exports=__kbnSharedDeps_npm__}},n={};function e(r){var i=n[r];if(void 0!==i)return i.exports;var a=n[r]={exports:{}};return t[r].call(a.exports,a,a.exports,e),a.exports}e.d=(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),e.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(t=n.currentScript.src),!t)){var r=n.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=r[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})(),e(244),__kbnBundles__.define("plugin/actions/public",e,11),__kbnBundles__.define("plugin/actions/common",e,464)})();